// @observablehq/plot v0.6.5 Copyright 2020-2023 Observable, Inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3@7.8.4/dist/d3.min.js")):"function"==typeof define&&define.amd?define(["exports","d3@7.8.4/dist/d3.min.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Plot=t.Plot||{},t.d3)}(this,(function(t,e){"use strict";function n(t){return null!=t&&!Number.isNaN(t)}function r(t,r){return+n(r)-+n(t)||e.ascending(t,r)}function o(t,r){return+n(r)-+n(t)||e.descending(t,r)}function i(t){return null!=t&&""!=`${t}`}function a(t){return isFinite(t)?t:NaN}function l(t){return t>0&&isFinite(t)?t:NaN}function s(t){return t<0&&isFinite(t)?t:NaN}function c(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof e?e(t):e;const n=t.getUTCHours(),r=t.getUTCMinutes(),o=t.getUTCSeconds(),i=t.getUTCMilliseconds();return`${a=t.getUTCFullYear(),a<0?`-${u(-a,6)}`:a>9999?`+${u(a,6)}`:u(a,4)}-${u(t.getUTCMonth()+1,2)}-${u(t.getUTCDate(),2)}${n||r||o||i?`T${u(n,2)}:${u(r,2)}${o||i?`:${u(o,2)}${i?`.${u(i,3)}`:""}`:""}Z`:""}`;var a}function u(t,e){return`${t}`.padStart(e,"0")}const f=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function h(t,e){return f.test(t+="")?new Date(t):"function"==typeof e?e(t):e}const d=new Map([["second",e.timeSecond],["minute",e.timeMinute],["hour",e.timeHour],["day",e.timeDay],["week",e.timeWeek],["month",e.timeMonth],["quarter",e.timeMonth.every(3)],["half",e.timeMonth.every(6)],["year",e.timeYear],["monday",e.timeMonday],["tuesday",e.timeTuesday],["wednesday",e.timeWednesday],["thursday",e.timeThursday],["friday",e.timeFriday],["saturday",e.timeSaturday],["sunday",e.timeSunday]]),p=new Map([["second",e.utcSecond],["minute",e.utcMinute],["hour",e.utcHour],["day",e.utcDay],["week",e.utcWeek],["month",e.utcMonth],["quarter",e.utcMonth.every(3)],["half",e.utcMonth.every(6)],["year",e.utcYear],["monday",e.utcMonday],["tuesday",e.utcTuesday],["wednesday",e.utcWednesday],["thursday",e.utcThursday],["friday",e.utcFriday],["saturday",e.utcSaturday],["sunday",e.utcSunday]]);function m(t){const e=d.get(`${t}`.toLowerCase());if(!e)throw new Error(`unknown interval: ${t}`);return e}function g(t){const e=p.get(`${t}`.toLowerCase());if(!e)throw new Error(`unknown interval: ${t}`);return e}const y=Object.getPrototypeOf(Uint8Array),v=Object.prototype.toString;function x(t,e,n){const r=typeof e;return"string"===r?w(t,k(e),n):"function"===r?w(t,e,n):"number"===r||e instanceof Date||"boolean"===r?Y(t,C(e),n):b("function"==typeof e?.transform?e.transform(t):e,n)}function w(t,e,n){return Y(t,n?.prototype instanceof y?function(t){return(e,n)=>N(t(e,n))}(e):e,n)}function b(t,e){return void 0===e?F(t):t instanceof e?t:e.prototype instanceof y&&!(t instanceof y)?e.from(t,N):e.from(t)}const k=t=>e=>e[t],$=(t,e)=>e,M={transform:t=>t},L=()=>1,A=()=>!0,R=t=>null==t?t:`${t}`,z=t=>null==t?t:+t,O=t=>t?t[0]:void 0,E=t=>t?t[1]:void 0,S=t=>t?t[2]:void 0,C=t=>()=>t;function B(t){const n=+`${t}`.slice(1)/100;return(t,r)=>e.quantile(t,n,r)}function T(t){return t instanceof y?t:Y(t,N,Float64Array)}function N(t){return null==t?NaN:Number(t)}function I(t){return Y(t,P)}function P(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?h(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function W(t,e){return void 0===t&&(t=e),null===t?[void 0,"none"]:yt(t)?[void 0,t]:[t,void 0]}function j(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function D(t,e,n){if(null!=t)return q(t,e,n)}function q(t,e,n){const r=`${t}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${e}: ${t}`);return r}function F(t){return null==t||t instanceof Array||t instanceof y?t:Array.from(t)}function Y(t,e,n=Array){return null==t?t:t instanceof n?t.map(e):n.from(t,e)}function _(t,e=Array){return t instanceof e?t.slice():e.from(t)}function G(t){return t?.toString===v}function X(t){return G(t)&&(void 0!==t.type||void 0!==t.domain)}function U(t){return G(t)&&"function"!=typeof t.transform}function H(t){return U(t)&&void 0===t.value&&void 0===t.channel}function V(t,e,n,r=M){return void 0===e&&void 0===n?(e=0,n=void 0===t?r:t):void 0===e?e=void 0===t?0:t:void 0===n&&(n=void 0===t?0:t),[e,n]}function Z(t,e){return void 0===t&&void 0===e?[O,E]:[t,e]}function Q({z:t,fill:e,stroke:n}={}){return void 0===t&&([t]=W(e)),void 0===t&&([t]=W(n)),t}function J(t){const e=t.length,n=new Uint32Array(e);for(let t=0;t<e;++t)n[t]=t;return n}function K(t,e){return Y(e,(e=>t[e]))}function tt(t){return null!==t&&"object"==typeof t?t.valueOf():t}function et(t,e){if(void 0!==e[t])return e[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y"}return e[t]}function nt(t){let e;return[{transform:()=>e,label:ot(t)},t=>e=t]}function rt(t){return null==t?[t]:nt(t)}function ot(t,e){return"string"==typeof t?t:t&&void 0!==t.label?t.label:e}function it(t,e){return{transform(n){const r=t.transform(n),o=e.transform(n);return ht(r)||ht(o)?Y(r,((t,e)=>new Date((+r[e]+ +o[e])/2))):Y(r,((t,e)=>(+r[e]+ +o[e])/2),Float64Array)},label:t.label}}function at(t,n){if(null!=t){if("number"==typeof t){const n=t;return{floor:t=>n*Math.floor(t/n),offset:t=>t+n,range:(t,r)=>e.range(Math.ceil(t/n),r/n).map((t=>n*t))}}if("string"==typeof t)return("time"===n?m:g)(t);if("function"!=typeof t.floor)throw new Error("invalid interval; missing floor method");if("function"!=typeof t.offset)throw new Error("invalid interval; missing offset method");return t}}function lt(t,e){if((t=at(t,e))&&"function"!=typeof t.range)throw new Error("invalid interval: missing range method");return t}function st(t){return void 0===t||U(t)?t:{value:t}}function ct(t){return t&&"function"==typeof t[Symbol.iterator]}function ut(t){for(const e of t)if(null!=e)return"object"!=typeof e||e instanceof Date}function ft(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function ht(t){for(const e of t)if(null!=e)return e instanceof Date}function dt(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&h(e)}function pt(t){for(const e of t)if(null!=e){if("string"!=typeof e)return!1;if(e.trim())return!isNaN(e)}}function mt(t){for(const e of t)if(null!=e)return"number"==typeof e}function gt(t,e){let n;for(const r of t)if(null!=r){if(!e(r))return!1;n=!0}return n}function yt(t){return"string"==typeof t&&("none"===(t=t.toLowerCase().trim())||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==e.color(t))}function vt(t){return"number"==typeof t&&(0<=t&&t<=1||isNaN(t))}function xt(t){return null==t||wt(t)}function wt(t){return/^\s*none\s*$/i.test(t)}function bt(t="middle"){return q(t,"frameAnchor",["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function kt(t){if(null==t)return;const n=t[0],r=t[t.length-1];return e.descending(n,r)}function $t(t){return ct(t)?function(t){console.warn("named iterables are deprecated; please use an object instead");const e=new Set;return Object.fromEntries(Array.from(t,(t=>{const{name:n}=t;if(null==n)throw new Error("missing name");const r=`${n}`;if("__proto__"===r)throw new Error(`illegal name: ${r}`);if(e.has(r))throw new Error(`duplicate name: ${r}`);return e.add(r),[n,t]})))}(t):t}const Mt=Symbol("position"),Lt=Symbol("color"),At=Symbol("radius"),Rt=Symbol("length"),zt=Symbol("opacity"),Ot=Symbol("symbol"),Et=new Map([["x",Mt],["y",Mt],["fx",Mt],["fy",Mt],["r",At],["color",Lt],["opacity",zt],["symbol",Ot],["length",Rt]]),St=Math.sqrt(3),Ct=2/St,Bt={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*Ct,o=r/2;t.moveTo(0,r),t.lineTo(n,o),t.lineTo(n,-o),t.lineTo(0,-r),t.lineTo(-n,-o),t.lineTo(-n,o),t.closePath()}},Tt=new Map([["asterisk",e.symbolAsterisk],["circle",e.symbolCircle],["cross",e.symbolCross],["diamond",e.symbolDiamond],["diamond2",e.symbolDiamond2],["hexagon",Bt],["plus",e.symbolPlus],["square",e.symbolSquare],["square2",e.symbolSquare2],["star",e.symbolStar],["times",e.symbolTimes],["triangle",e.symbolTriangle],["triangle2",e.symbolTriangle2],["wye",e.symbolWye]]);function Nt(t){return t&&"function"==typeof t.draw}function It(t){return!!Nt(t)||"string"==typeof t&&Tt.has(t.toLowerCase())}function Pt(t){if(null==t||Nt(t))return t;const e=Tt.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}function Wt({filter:t,sort:e,reverse:n,transform:r,initializer:o,...i}={},a){if(void 0===r&&(null!=t&&(r=Yt(t)),null==e||H(e)||(r=Dt(r,Xt(e))),n&&(r=Dt(r,_t))),null!=a&&null!=o)throw new Error("transforms cannot be applied after initializers");return{...i,...(null===e||H(e))&&{sort:e},transform:Dt(r,a)}}function jt({filter:t,sort:e,reverse:n,initializer:r,...o}={},i){return void 0===r&&(null!=t&&(r=Yt(t)),null==e||H(e)||(r=qt(r,Xt(e))),n&&(r=qt(r,_t))),{...o,...(null===e||H(e))&&{sort:e},initializer:qt(r,i)}}function Dt(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r){return({data:n,facets:r}=t.call(this,n,r)),e.call(this,F(n),r)}}function qt(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,o,...i){let a,l,s,c,u,f;return({data:l=n,facets:s=r,channels:a}=t.call(this,n,r,o,...i)),({data:u=l,facets:f=s,channels:c}=e.call(this,l,s,{...o,...a},...i)),{data:u,facets:f,channels:{...a,...c}}}}function Ft(t,e){return(null!=t.initializer?jt:Wt)(t,e)}function Yt(t){return(e,n)=>{const r=x(e,t);return{data:e,facets:n.map((t=>t.filter((t=>r[t]))))}}}function _t(t,e){return{data:t,facets:e.map((t=>t.slice().reverse()))}}function Gt(t,{sort:e,...n}={}){return{...(U(t)&&void 0!==t.channel?jt:Ft)(n,Xt(t)),sort:H(e)?e:null}}function Xt(t){return("function"==typeof t&&1!==t.length?Ut:Ht)(t)}function Ut(t){return(e,n)=>{const r=(n,r)=>t(e[n],e[r]);return{data:e,facets:n.map((t=>t.slice().sort(r)))}}}function Ht(t){let e,n;if(({channel:e,value:t,order:n=r}={...st(t)}),"function"!=typeof n)switch(`${n}`.toLowerCase()){case"ascending":n=r;break;case"descending":n=o;break;default:throw new Error(`invalid order: ${n}`)}return(r,o,i)=>{let a;if(void 0===e)a=x(r,t);else{if(void 0===i)throw new Error("channel sort requires an initializer");if(a=i[e],!a)return{};a=a.value}const l=(t,e)=>n(a[t],a[e]);return{data:r,facets:o.map((t=>t.slice().sort(l)))}}}function Vt(t,e){return Kt(null,null,t,e)}function Zt(t={y:"count"},e={}){const{x:n=M}=e;if(null==n)throw new Error("missing channel: x");return Kt(n,null,t,e)}function Qt(t={x:"count"},e={}){const{y:n=M}=e;if(null==n)throw new Error("missing channel: y");return Kt(null,n,t,e)}function Jt(t={fill:"count"},e={}){let{x:n,y:r}=e;if([n,r]=Z(n,r),null==n)throw new Error("missing channel: x");if(null==r)throw new Error("missing channel: y");return Kt(n,r,t,e)}function Kt(t,e,{data:n=fe,filter:r,sort:o,reverse:i,...a}={},l={}){a=ee(a,l),n=ie(n,M),o=null==o?void 0:ne("sort",o,l),r=null==r?void 0:re("filter",r,l);const[s,c]=rt(t),[u,f]=rt(e),{z:h,fill:d,stroke:p,x1:m,x2:g,y1:y,y2:v,...w}=l,[b,k]=rt(h),[$]=W(d),[L]=W(p),[A,R]=rt($),[z,O]=rt(L);return{..."z"in l&&{z:b||h},..."fill"in l&&{fill:A||d},..."stroke"in l&&{stroke:z||p},...Wt(w,((l,s)=>{const u=x(l,t),d=x(l,e),p=x(l,h),m=x(l,$),g=x(l,L),y=le(a,{z:p,fill:m,stroke:g}),v=[],w=[],b=u&&c([]),M=d&&f([]),A=p&&k([]),z=m&&R([]),E=g&&O([]);let S=0;for(const t of a)t.initialize(l);o&&o.initialize(l),r&&r.initialize(l);for(const t of s){const e=[];for(const e of a)e.scope("facet",t);o&&o.scope("facet",t),r&&r.scope("facet",t);for(const[i,s]of oe(t,y))for(const[t,c]of oe(s,d))for(const[s,f]of oe(c,u))if(!r||r.reduce(f)){e.push(S++),w.push(n.reduceIndex(f,l)),u&&b.push(s),d&&M.push(t),p&&A.push(y===p?i:p[f[0]]),m&&z.push(y===m?i:m[f[0]]),g&&E.push(y===g?i:g[f[0]]);for(const t of a)t.reduce(f);o&&o.reduce(f)}v.push(e)}return se(v,o,i),{data:w,facets:v}})),...!te(a,"x")&&(s?{x:s}:{x1:m,x2:g}),...!te(a,"y")&&(u?{y:u}:{y1:y,y2:v}),...Object.fromEntries(a.map((({name:t,output:e})=>[t,e])))}}function te(t,...e){for(const{name:n}of t)if(e.includes(n))return!0;return!1}function ee(t,e,n=ne){const r=Object.entries(t);return null!=e.title&&void 0===t.title&&r.push(["title",de]),null!=e.href&&void 0===t.href&&r.push(["href",he]),r.filter((([,t])=>void 0!==t)).map((([t,r])=>null===r?function(t){return{name:t,initialize(){},scope(){},reduce(){}}}(t):n(t,r,e)))}function ne(t,e,n,r=re){let o;G(e)&&"reduce"in e&&(o=e.scale,e=e.reduce);const i=r(t,e,n),[a,l]=nt(i.label);let s;return{name:t,output:void 0===o?a:{value:a,scale:o},initialize(t){i.initialize(t),s=l([])},scope(t,e){i.scope(t,e)},reduce(t,e){s.push(i.reduce(t,e))}}}function re(t,e,n,r=ie){const o=et(t,n),i=r(e,o);let a,l;return{label:ot(i===me?null:o,i.label),initialize(t){a=void 0===o?t:x(t,o),"data"===i.scope&&(l=i.reduceIndex(J(t),a))},scope(t,e){i.scope===t&&(l=i.reduceIndex(e,a))},reduce:(t,e)=>null==i.scope?i.reduceIndex(t,a,e):i.reduceIndex(t,a,l,e)}}function oe(t,n){return n?e.sort(e.group(t,(t=>n[t])),O):[[,t]]}function ie(t,n,r=ae){if(null==t)return r(t);if("function"==typeof t.reduceIndex)return t;if("function"==typeof t.reduce&&G(t))return function(t){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...t,reduceIndex:t.reduce.bind(t)}}(t);if("function"==typeof t)return o=t,{reduceIndex:(t,e,n)=>o(K(e,t),n)};var o;if(/^p\d{2}$/i.test(t))return ce(B(t));switch(`${t}`.toLowerCase()){case"first":return he;case"last":return pe;case"identity":return fe;case"count":return me;case"distinct":return ge;case"sum":return null==n?me:ye;case"proportion":return ve(n,"data");case"proportion-facet":return ve(n,"facet");case"deviation":return ce(e.deviation);case"min":return ce(e.min);case"min-index":return ce(e.minIndex);case"max":return ce(e.max);case"max-index":return ce(e.maxIndex);case"mean":return ue(e.mean);case"median":return ue(e.median);case"variance":return ce(e.variance);case"mode":return ce(e.mode)}return r(t)}function ae(t){throw new Error(`invalid reduce: ${t}`)}function le(t,e){for(const n in e){const r=e[n];if(void 0!==r&&!t.some((t=>t.name===n)))return r}}function se(t,e,n){if(e){const n=e.output.transform(),o=(t,e)=>r(n[t],n[e]);t.forEach((t=>t.sort(o)))}n&&t.forEach((t=>t.reverse()))}function ce(t){return{reduceIndex:(e,n)=>t(e,(t=>n[t]))}}function ue(t){return{reduceIndex(e,n){const r=t(e,(t=>n[t]));return ht(n)?new Date(r):r}}}const fe={reduceIndex:(t,e)=>K(e,t)},he={reduceIndex:(t,e)=>e[t[0]]},de={reduceIndex(t,n){const r=e.sort(e.rollup(t,(t=>t.length),(t=>n[t])),E),o=r.slice(-5).reverse();if(o.length<r.length){const t=r.slice(0,-4);o[4]=[`… ${t.length.toLocaleString("en-US")} more`,e.sum(t,E)]}return o.map((([t,e])=>`${t} (${e.toLocaleString("en-US")})`)).join("\n")}},pe={reduceIndex:(t,e)=>e[t[t.length-1]]},me={label:"Frequency",reduceIndex:t=>t.length},ge={label:"Distinct",reduceIndex(t,n){const r=new e.InternSet;for(const e of t)r.add(n[e]);return r.size}},ye=ce(e.sum);function ve(t,n){return null==t?{scope:n,label:"Frequency",reduceIndex:(t,e,n=1)=>t.length/n}:{scope:n,reduceIndex:(t,n,r=1)=>e.sum(t,(t=>n[t]))/r}}function xe(t,{scale:e,type:n,value:r,filter:o,hint:i},a){return ke(a,{scale:e,type:n,value:x(t,r),label:ot(r),filter:o,hint:i})}function we(t,e){return Object.fromEntries(Object.entries(t).map((([t,n])=>[t,xe(e,n,t)])))}function be(t,e){const n=Object.fromEntries(Object.entries(t).map((([t,{scale:n,value:r}])=>{const o=null==n?null:e[n];return[t,null==o?r:Y(r,o)]})));return n.channels=t,n}function ke(t,e){const{scale:n,value:r}=e;if(!0===n||"auto"===n)switch(t){case"fill":case"stroke":case"color":e.scale=!0!==n&&gt(r,yt)?null:"color";break;case"fillOpacity":case"strokeOpacity":e.scale=!0!==n&&gt(r,vt)?null:"opacity";break;case"symbol":!0!==n&&gt(r,It)?(e.scale=null,e.value=Y(r,Pt)):e.scale="symbol";break;default:e.scale=Et.has(t)?t:null}else if(!1===n)e.scale=null;else if(null!=n&&!Et.has(n))throw new Error(`unknown scale: ${n}`);return e}function $e(t,e){for(const n in t){const r=t[n];if(r.scale===e)return r}}function Me(t,e){const n=t.original;if(n===t)return e;const r=e.value,o=e.value=[];for(let e=0;e<n.length;++e){const i=r[n[e][0]];for(const n of t[e])o[n]=i}return e}function Le(t,e,n){const r=Ae(t,e);return Y(Ae(t,n),((t,e)=>Math.abs(t-r[e])),Float64Array)}function Ae(t,e,n){let r=t[e];if(r||void 0===n||(r=t[n]),r)return r.value;throw new Error(`missing channel: ${e}`)}function Re([t,e],[n,o]){return r(e,o)||r(t,n)}function ze([t,e],[n,i]){return o(e,i)||r(t,n)}let Oe=0;function Ee(t){console.warn(t),++Oe}const Se=Math.PI,Ce=2*Se,Be=.618;function Te({projection:t,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n}={},l){if(null==t)return;if("function"==typeof t.stream)return t;let s,c,u="frame";if(G(t)){let e;if(({type:t,domain:c,inset:e,insetTop:r=(void 0!==e?e:r),insetRight:o=(void 0!==e?e:o),insetBottom:i=(void 0!==e?e:i),insetLeft:a=(void 0!==e?e:a),clip:u=u,...s}=t),null==t)return}"function"!=typeof t&&({type:t}=Ne(t));const{width:f,height:h,marginLeft:d,marginRight:p,marginTop:m,marginBottom:g}=l,y=f-d-p-a-o,v=h-m-g-r-i;if(t=t?.({width:y,height:v,clip:u,...s}),null==t)return;u=function(t,n,r,o,i){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return e.geoClipRectangle(n,r,o,i);throw new Error(`unknown projection clip type: ${t}`)}(u,d,m,f-p,h-g);let x,w=d+a,b=m+r;if(null!=c){const[[n,r],[o,i]]=e.geoPath(t).bounds(c),a=Math.min(y/(o-n),v/(i-r));a>0?(w-=(a*(n+o)-y)/2,b-=(a*(r+i)-v)/2,x=e.geoTransform({point(t,e){this.stream.point(t*a+w,e*a+b)}})):Ee("Warning: the projection could not be fit to the specified domain; using the default scale.")}return x??=0===w&&0===b?We():e.geoTransform({point(t,e){this.stream.point(t+w,e+b)}}),{stream:e=>t.stream(x.stream(u(e)))}}function Ne(t){switch(`${t}`.toLowerCase()){case"albers-usa":return Ie(e.geoAlbersUsa,.7463,.4673);case"albers":return Pe(e.geoAlbers,.7463,.4673);case"azimuthal-equal-area":return Ie(e.geoAzimuthalEqualArea,4,4);case"azimuthal-equidistant":return Ie(e.geoAzimuthalEquidistant,Ce,Ce);case"conic-conformal":return Pe(e.geoConicConformal,Ce,Ce);case"conic-equal-area":return Pe(e.geoConicEqualArea,6.1702,2.9781);case"conic-equidistant":return Pe(e.geoConicEquidistant,7.312,3.6282);case"equal-earth":return Ie(e.geoEqualEarth,5.4133,2.6347);case"equirectangular":return Ie(e.geoEquirectangular,Ce,Se);case"gnomonic":return Ie(e.geoGnomonic,3.4641,3.4641);case"identity":return{type:We};case"reflect-y":return{type:je};case"mercator":return Ie(e.geoMercator,Ce,Ce);case"orthographic":return Ie(e.geoOrthographic,2,2);case"stereographic":return Ie(e.geoStereographic,2,2);case"transverse-mercator":return Ie(e.geoTransverseMercator,Ce,Ce);default:throw new Error(`unknown projection type: ${t}`)}}function Ie(t,e,n){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:l})=>{const s=t();return null!=a&&s.precision?.(a),null!=i&&s.rotate?.(i),"number"==typeof l&&s.clipAngle?.(l),s.scale(Math.min(r/e,o/n)),s.translate([r/2,o/2]),s},aspectRatio:n/e}}function Pe(t,e,n){const{type:r,aspectRatio:o}=Ie(t,e,n);return{type:t=>{const{parallels:e,domain:n,width:o,height:i}=t,a=r(t);return null!=e&&(a.parallels(e),void 0===n&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const We=C({stream:t=>t}),je=C(e.geoTransform({point(t,e){this.stream.point(t,-e)}}));function De(t,e,n,r,o){const i=n[t]&&"x"===n[t].scale,a=n[e]&&"y"===n[e].scale;if(i&&a)!function(t,e,n,r){const o=n[t],i=n[e],a=o.length,l=n[t]=new Float64Array(a).fill(NaN),s=n[e]=new Float64Array(a).fill(NaN);let c;const u=r.stream({point(t,e){l[c]=t,s[c]=e}});for(c=0;c<a;++c)u.point(o[c],i[c])}(t,e,r,o.projection);else{if(i)throw new Error(`projection requires paired x and y channels; ${t} is missing ${e}`);if(a)throw new Error(`projection requires paired x and y channels; ${e} is missing ${t}`)}}function qe(t,e,n){const{x:r,y:o}=t;let i={};return r&&(i.x=r),o&&(i.y=o),i=be(i,e),n.projection&&De("x","y",t,i,n),r&&(i.x=T(i.x)),o&&(i.y=T(i.y)),i}function Fe(t={},e){const{document:n=("undefined"!=typeof window?window.document:void 0)}=t;return{document:n,projection:Te(t,e)}}function Ye(t,{document:n}){return e.select(e.creator(t).call(n.documentElement))}const _e=new Map([["accent",e.schemeAccent],["category10",e.schemeCategory10],["dark2",e.schemeDark2],["paired",e.schemePaired],["pastel1",e.schemePastel1],["pastel2",e.schemePastel2],["set1",e.schemeSet1],["set2",e.schemeSet2],["set3",e.schemeSet3],["tableau10",e.schemeTableau10],["brbg",Xe(e.schemeBrBG,e.interpolateBrBG)],["prgn",Xe(e.schemePRGn,e.interpolatePRGn)],["piyg",Xe(e.schemePiYG,e.interpolatePiYG)],["puor",Xe(e.schemePuOr,e.interpolatePuOr)],["rdbu",Xe(e.schemeRdBu,e.interpolateRdBu)],["rdgy",Xe(e.schemeRdGy,e.interpolateRdGy)],["rdylbu",Xe(e.schemeRdYlBu,e.interpolateRdYlBu)],["rdylgn",Xe(e.schemeRdYlGn,e.interpolateRdYlGn)],["spectral",Xe(e.schemeSpectral,e.interpolateSpectral)],["burd",Ue(e.schemeRdBu,e.interpolateRdBu)],["buylrd",Ue(e.schemeRdYlBu,e.interpolateRdYlBu)],["blues",Ge(e.schemeBlues,e.interpolateBlues)],["greens",Ge(e.schemeGreens,e.interpolateGreens)],["greys",Ge(e.schemeGreys,e.interpolateGreys)],["oranges",Ge(e.schemeOranges,e.interpolateOranges)],["purples",Ge(e.schemePurples,e.interpolatePurples)],["reds",Ge(e.schemeReds,e.interpolateReds)],["turbo",He(e.interpolateTurbo)],["viridis",He(e.interpolateViridis)],["magma",He(e.interpolateMagma)],["inferno",He(e.interpolateInferno)],["plasma",He(e.interpolatePlasma)],["cividis",He(e.interpolateCividis)],["cubehelix",He(e.interpolateCubehelixDefault)],["warm",He(e.interpolateWarm)],["cool",He(e.interpolateCool)],["bugn",Ge(e.schemeBuGn,e.interpolateBuGn)],["bupu",Ge(e.schemeBuPu,e.interpolateBuPu)],["gnbu",Ge(e.schemeGnBu,e.interpolateGnBu)],["orrd",Ge(e.schemeOrRd,e.interpolateOrRd)],["pubu",Ge(e.schemePuBu,e.interpolatePuBu)],["pubugn",Ge(e.schemePuBuGn,e.interpolatePuBuGn)],["purd",Ge(e.schemePuRd,e.interpolatePuRd)],["rdpu",Ge(e.schemeRdPu,e.interpolateRdPu)],["ylgn",Ge(e.schemeYlGn,e.interpolateYlGn)],["ylgnbu",Ge(e.schemeYlGnBu,e.interpolateYlGnBu)],["ylorbr",Ge(e.schemeYlOrBr,e.interpolateYlOrBr)],["ylorrd",Ge(e.schemeYlOrRd,e.interpolateYlOrRd)],["rainbow",Ve(e.interpolateRainbow)],["sinebow",Ve(e.interpolateSinebow)]]);function Ge(t,n){return({length:r})=>1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?e.quantize(n,r):t[r]}function Xe(t,n){return({length:r})=>2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize(n,r):t[r]}function Ue(t,n){return({length:r})=>2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize((t=>n(1-t)),r):t[r].slice().reverse()}function He(t){return({length:n})=>e.quantize(t,Math.max(2,Math.floor(n)))}function Ve(t){return({length:n})=>e.quantize(t,Math.floor(n)+1).slice(0,-1)}function Ze(t){const e=`${t}`.toLowerCase();if(!_e.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return _e.get(e)}function Qe(t,e){const n=Ze(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const Je=new Map([["brbg",e.interpolateBrBG],["prgn",e.interpolatePRGn],["piyg",e.interpolatePiYG],["puor",e.interpolatePuOr],["rdbu",e.interpolateRdBu],["rdgy",e.interpolateRdGy],["rdylbu",e.interpolateRdYlBu],["rdylgn",e.interpolateRdYlGn],["spectral",e.interpolateSpectral],["burd",t=>e.interpolateRdBu(1-t)],["buylrd",t=>e.interpolateRdYlBu(1-t)],["blues",e.interpolateBlues],["greens",e.interpolateGreens],["greys",e.interpolateGreys],["purples",e.interpolatePurples],["reds",e.interpolateReds],["oranges",e.interpolateOranges],["turbo",e.interpolateTurbo],["viridis",e.interpolateViridis],["magma",e.interpolateMagma],["inferno",e.interpolateInferno],["plasma",e.interpolatePlasma],["cividis",e.interpolateCividis],["cubehelix",e.interpolateCubehelixDefault],["warm",e.interpolateWarm],["cool",e.interpolateCool],["bugn",e.interpolateBuGn],["bupu",e.interpolateBuPu],["gnbu",e.interpolateGnBu],["orrd",e.interpolateOrRd],["pubugn",e.interpolatePuBuGn],["pubu",e.interpolatePuBu],["purd",e.interpolatePuRd],["rdpu",e.interpolateRdPu],["ylgnbu",e.interpolateYlGnBu],["ylgn",e.interpolateYlGn],["ylorbr",e.interpolateYlOrBr],["ylorrd",e.interpolateYlOrRd],["rainbow",e.interpolateRainbow],["sinebow",e.interpolateSinebow]]);function Ke(t){const e=`${t}`.toLowerCase();if(!Je.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return Je.get(e)}const tn=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function en(t){return null!=t&&tn.has(`${t}`.toLowerCase())}const nn=t=>e=>t(1-e),rn=[0,1],on=new Map([["number",e.interpolateNumber],["rgb",e.interpolateRgb],["hsl",e.interpolateHsl],["hcl",e.interpolateHcl],["lab",e.interpolateLab]]);function an(t){const e=`${t}`.toLowerCase();if(!on.has(e))throw new Error(`unknown interpolator: ${e}`);return on.get(e)}function ln(t,n,r,{type:o,nice:i,clamp:a,zero:l,domain:s=fn(t,r),unknown:c,round:u,scheme:f,interval:h,range:d=(Et.get(t)===At?dn(r,s):Et.get(t)===Rt?pn(r,s):Et.get(t)===zt?rn:void 0),interpolate:p=(Et.get(t)===Lt?null==f&&void 0!==d?e.interpolateRgb:Ke(void 0!==f?f:"cyclical"===o?"rainbow":"turbo"):u?e.interpolateRound:e.interpolateNumber),reverse:m}){if(h=lt(h,o),"cyclical"!==o&&"sequential"!==o||(o="linear"),m=!!m,"function"!=typeof p&&(p=an(p)),1===p.length?(m&&(p=nn(p),m=!1),void 0===d&&2===(d=Float64Array.from(s,((t,e)=>e/(s.length-1)))).length&&(d=rn),n.interpolate((d===rn?C:yn)(p))):n.interpolate(p),l){const[t,n]=e.extent(s);(t>0||n<0)&&(kt(s=_(s))!==Math.sign(t)?s[s.length-1]=0:s[0]=0)}return m&&(s=e.reverse(s)),n.domain(s).unknown(c),i&&(n.nice(function(t,e){return!0===t?void 0:"number"==typeof t?t:function(t,e){if((t=lt(t,e))&&"function"!=typeof t.ceil)throw new Error("invalid interval: missing ceil method");return t}(t,e)}(i,o)),s=n.domain()),void 0!==d&&n.range(d),a&&n.clamp(a),{type:o,domain:s,range:d,scale:n,interpolate:p,interval:h}}function sn(t,n,{exponent:r=1,...o}){return ln(t,e.scalePow().exponent(r),n,{...o,type:"pow"})}function cn(t,n,{domain:r=[0],unknown:o,scheme:i="rdylbu",interpolate:a,range:l=(void 0!==a?e.quantize(a,r.length+1):Et.get(t)===Lt?Qe(i,r.length+1):void 0),reverse:s}){const c=kt(r=F(r));if(!isNaN(c)&&!function(t,n){for(let r=1,o=t.length,i=t[0];r<o;++r){const o=e.descending(i,i=t[r]);if(0!==o&&o!==n)return!1}return!0}(r,c))throw new Error(`the ${t} scale has a non-monotonic domain`);return s&&(l=e.reverse(l)),{type:"threshold",scale:e.scaleThreshold(c<0?e.reverse(r):r,void 0===l?[]:l).unknown(o),domain:r,range:l}}function un(t,n=a){return t.length?[e.min(t,(({value:t})=>void 0===t?t:e.min(t,n))),e.max(t,(({value:t})=>void 0===t?t:e.max(t,n)))]:[0,1]}function fn(t,e){const n=Et.get(t);return(n===At||n===zt||n===Rt?hn:un)(e)}function hn(t){return[0,t.length?e.max(t,(({value:t})=>void 0===t?t:e.max(t,a))):1]}function dn(t,n){const r=t.find((({radius:t})=>void 0!==t));if(void 0!==r)return[0,r.radius];const o=e.quantile(t,.5,(({value:t})=>void 0===t?NaN:e.quantile(t,.25,l))),i=n.map((t=>3*Math.sqrt(t/o))),a=30/e.max(i);return a<1?i.map((t=>t*a)):i}function pn(t,n){const r=e.median(t,(({value:t})=>void 0===t?NaN:e.median(t,Math.abs))),o=n.map((t=>12*t/r)),i=60/e.max(o);return i<1?o.map((t=>t*i)):o}function mn(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n>0)return un(t,l);if(n<0)return un(t,s)}return[1,10]}function gn(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function yn(t){return(e,n)=>r=>t(e+r*(n-e))}function vn(t,n,r,o,{type:i,nice:a,clamp:l,domain:s=un(o),unknown:c,pivot:u=0,scheme:f,range:h,symmetric:d=!0,interpolate:p=(Et.get(t)===Lt?null==f&&void 0!==h?e.interpolateRgb:Ke(void 0!==f?f:"rdbu"):e.interpolateNumber),reverse:m}){u=+u;let[g,y]=s;if(e.descending(g,y)<0&&([g,y]=[y,g],m=!m),g=Math.min(g,u),y=Math.max(y,u),"function"!=typeof p&&(p=an(p)),void 0!==h&&(p=1===p.length?yn(p)(...h):e.piecewise(p,h)),m&&(p=nn(p)),d){const t=r.apply(u),e=t-r.apply(g),n=r.apply(y)-t;e<n?g=r.invert(t-n):e>n&&(y=r.invert(t+e))}return n.domain([g,u,y]).unknown(c).interpolator(p),l&&n.clamp(l),a&&n.nice(a),{type:i,domain:[g,y],pivot:u,interpolate:p,scale:n}}function xn(t,n,{exponent:r=1,...o}){return vn(t,e.scaleDivergingPow().exponent(r=+r),function(t){return.5===t?$n:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),n,{...o,type:"diverging-pow"})}function wn(t,n,{constant:r=1,...o}){return vn(t,e.scaleDivergingSymlog().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),n,o)}const bn={apply:t=>t,invert:t=>t},kn={apply:Math.log,invert:Math.exp},$n={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function Mn(t,e,n,r){return ln(t,e,n,r)}const Ln=Symbol("ordinal");function An(t,n,r,{type:o,interval:i,domain:a,range:l,reverse:s,hint:c}){return i=lt(i,o),void 0===a&&(a=On(r,i,t)),"categorical"!==o&&o!==Ln||(o="ordinal"),s&&(a=e.reverse(a)),n.domain(a),void 0!==l&&("function"==typeof l&&(l=l(a)),n.range(l)),{type:o,domain:a,range:l,scale:n,hint:c,interval:i}}function Rn(t,n,{type:r,interval:o,domain:i,range:a,scheme:l,unknown:s,...c}){let u;if(o=lt(o,r),void 0===i&&(i=On(n,o,t)),Et.get(t)===Ot)u=function(t){return{fill:En(t,"fill"),stroke:En(t,"stroke")}}(n),a=void 0===a?function(t){return xt(t.fill)?e.symbolsStroke:e.symbolsFill}(u):Y(a,Pt);else if(Et.get(t)===Lt&&(void 0!==a||"ordinal"!==r&&r!==Ln||(a=function(t,e="greys"){const n=new Set,[r,o]=Qe(e,2);for(const e of t)if(null!=e)if(!0===e)n.add(o);else{if(!1!==e)return;n.add(r)}return[...n]}(i,l),void 0!==a&&(l=void 0)),void 0===l&&void 0===a&&(l="ordinal"===r?"turbo":"tableau10"),void 0!==l))if(void 0!==a){const t=Ke(l),n=a[0],r=a[1]-a[0];a=({length:o})=>e.quantize((e=>t(n+r*e)),o)}else a=Ze(l);if(s===e.scaleImplicit)throw new Error(`implicit unknown on ${t} scale is not supported`);return An(t,e.scaleOrdinal().unknown(s),n,{...c,type:r,domain:i,range:a,hint:u})}function zn(t,e,n,r){let{round:o}=n;return void 0!==o&&t.round(o=!!o),(t=An(r,t,e,n)).round=o,t}function On(t,n,o){const i=new e.InternSet;for(const{value:e,domain:n}of t){if(void 0!==n)return n();if(void 0!==e)for(const t of e)i.add(t)}if(void 0!==n){const[t,r]=e.extent(i).map(n.floor,n);return n.range(t,n.offset(r))}if(i.size>1e4&&Et.get(o)===Mt)throw new Error(`implicit ordinal domain of ${o} scale has more than 10,000 values`);return e.sort(i,r)}function En(t,e){let n;for(const{hint:r}of t){const t=r?.[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}function Sn(t,{label:e,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n,round:l,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,facet:{label:p=e}={},...m}={}){const g={};for(const[n,y]of t){const t=m[n],v=qn(n,y,{round:Et.get(n)===Mt?l:void 0,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,...t});if(v){let{label:l=("fx"===n||"fy"===n?p:e),percent:s,transform:c,inset:u,insetTop:f=(void 0!==u?u:"y"===n?r:0),insetRight:h=(void 0!==u?u:"x"===n?o:0),insetBottom:d=(void 0!==u?u:"y"===n?i:0),insetLeft:m=(void 0!==u?u:"x"===n?a:0)}=t||{};if(null==c)c=void 0;else if("function"!=typeof c)throw new Error("invalid scale transform; not a function");v.percent=!!s,v.label=void 0===l?Bn(y,v):l,v.transform=c,"x"===n||"fx"===n?(v.insetLeft=+m,v.insetRight=+h):"y"!==n&&"fy"!==n||(v.insetTop=+f,v.insetBottom=+d),g[n]=v}}return g}function Cn(t){return Object.fromEntries(Object.entries(t).filter((([,{scale:t}])=>t)).map((([t,{scale:e,type:n,interval:r,label:o}])=>(e.type=n,null!=r&&(e.interval=r),null!=o&&(e.label=o),[t,e]))))}function Bn(t=[],e){let n;for(const{label:e}of t)if(void 0!==e)if(void 0===n)n=e;else if(n!==e)return;if(!(void 0===n||Gn(e)&&/^(date|time|year)$/i.test(n)))return!Xn(e)&&e.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function Tn(t){const{marginTop:e,marginRight:n,marginBottom:r,marginLeft:o,width:i,height:a,facet:{marginTop:l,marginRight:s,marginBottom:c,marginLeft:u}}=t;return{marginTop:Math.max(e,l),marginRight:Math.max(n,s),marginBottom:Math.max(r,c),marginLeft:Math.max(o,u),width:i,height:a}}function Nn({fx:t,fy:e},n){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=Tn(n);return{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:t?t.scale.bandwidth()+a+o:l,height:e?e.scale.bandwidth()+r+i:s}}function In(t,e){if(void 0===t.range){const{insetLeft:n,insetRight:r}=t,{width:o,marginLeft:i=0,marginRight:a=0}=e,l=i+n,s=o-a-r;t.range=[l,Math.max(l,s)],Xn(t)||(t.range=jn(t)),t.scale.range(t.range)}Wn(t)}function Pn(t,e){if(void 0===t.range){const{insetTop:n,insetBottom:r}=t,{height:o,marginTop:i=0,marginBottom:a=0}=e,l=i+n,s=o-a-r;t.range=[Math.max(l,s),l],Xn(t)?t.range.reverse():t.range=jn(t),t.scale.range(t.range)}Wn(t)}function Wn(t){void 0===t.round&&function({type:t}){return"point"===t||"band"===t}(t)&&function({scale:t}){const e=t.domain().length,[n,r]=t.range(),o=t.paddingInner?t.paddingInner():1,i=t.paddingOuter?t.paddingOuter():t.padding(),a=e-o,l=Math.abs(r-n)/Math.max(1,a+2*i);return(l-Math.floor(l))*a}(t)<=30&&t.scale.round(!0)}function jn(t){const e=t.scale.domain().length+Un(t);if(!(e>2))return t.range;const[n,r]=t.range;return Array.from({length:e},((t,o)=>n+o/(e-1)*(r-n)))}function Dn(t,e,n){return qn(t,void 0===n?void 0:[{hint:n}],{...e})}function qn(t,n=[],r={}){const o=function(t,e,{type:n,domain:r,range:o,scheme:i,pivot:a,projection:l}){if("fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==l||(n=Yn);for(const{type:t}of e)if(void 0!==t)if(void 0===n)n=t;else if(n!==t)throw new Error(`scale incompatible with channel: ${n} !== ${t}`);if(n===Yn)return;if(void 0!==n)return n;if(void 0===r&&!e.some((({value:t})=>void 0!==t)))return;const s=Et.get(t);if(s===At)return"sqrt";if(s===zt||s===Rt)return"linear";if(s===Ot)return"ordinal";if((r||o||[]).length>2)return _n(s);if(void 0!==r)return ft(r)?_n(s):ht(r)?"utc":s!==Lt||null==a&&!en(i)?"linear":"diverging";const c=e.map((({value:t})=>t)).filter((t=>void 0!==t));return c.some(ft)?_n(s):c.some(ht)?"utc":s!==Lt||null==a&&!en(i)?"linear":"diverging"}(t,n,r);if(void 0===r.type&&void 0===r.domain&&void 0===r.range&&null==r.interval&&"fx"!==t&&"fy"!==t&&Xn({type:o})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(ht)?Ee(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${Fn(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${Fn(o)}".`):e.some(dt)?Ee(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${Fn(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${Fn(o)}".`):e.some(pt)&&Ee(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${Fn(o)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${Fn(o)}".`)}switch(r.type=o,o){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=Vn(n,r,T);break;case"identity":switch(Et.get(t)){case Mt:r=Vn(n,r,T);break;case Ot:r=Vn(n,r,Zn)}break;case"utc":case"time":r=Vn(n,r,I)}switch(o){case"diverging":return function(t,n,r){return vn(t,e.scaleDiverging(),bn,n,r)}(t,n,r);case"diverging-sqrt":return function(t,e,n){return xn(t,e,{...n,exponent:.5})}(t,n,r);case"diverging-pow":return xn(t,n,r);case"diverging-log":return function(t,n,{base:r=10,pivot:o=1,domain:i=un(n,o<0?s:l),...a}){return vn(t,e.scaleDivergingLog().base(r=+r),kn,n,{domain:i,pivot:o,...a})}(t,n,r);case"diverging-symlog":return wn(t,n,r);case"categorical":case"ordinal":case Ln:return Rn(t,n,r);case"cyclical":case"sequential":case"linear":return function(t,n,r){return ln(t,e.scaleLinear(),n,r)}(t,n,r);case"sqrt":return function(t,e,n){return sn(t,e,{...n,exponent:.5})}(t,n,r);case"threshold":return cn(t,0,r);case"quantile":return function(t,n,{range:r,quantiles:o=(void 0===r?5:(r=[...r]).length),n:i=o,scheme:a="rdylbu",domain:l=gn(n),unknown:s,interpolate:c,reverse:u}){return void 0===r&&(r=void 0!==c?e.quantize(c,i):Et.get(t)===Lt?Qe(a,i):void 0),l.length>0&&(l=e.scaleQuantile(l,void 0===r?{length:i}:r).quantiles()),cn(t,0,{domain:l,range:r,reverse:u,unknown:s})}(t,n,r);case"quantize":return function(t,n,{range:r,n:o=(void 0===r?5:(r=[...r]).length),scheme:i="rdylbu",domain:a=fn(t,n),unknown:l,interpolate:s,reverse:c}){const[u,f]=e.extent(a);let h;return void 0===r?(h=e.ticks(u,f,o),h[0]<=u&&h.splice(0,1),h[h.length-1]>=f&&h.pop(),o=h.length+1,r=void 0!==s?e.quantize(s,o):Et.get(t)===Lt?Qe(i,o):void 0):(h=e.quantize(e.interpolateNumber(u,f),o+1).slice(1,-1),u instanceof Date&&(h=h.map((t=>new Date(t))))),kt(F(a))<0&&h.reverse(),cn(t,0,{domain:h,range:r,reverse:c,unknown:l})}(t,n,r);case"pow":return sn(t,n,r);case"log":return function(t,n,{base:r=10,domain:o=mn(n),...i}){return ln(t,e.scaleLog().base(r),n,{...i,domain:o})}(t,n,r);case"symlog":return function(t,n,{constant:r=1,...o}){return ln(t,e.scaleSymlog().constant(r),n,o)}(t,n,r);case"utc":return function(t,n,r){return Mn(t,e.scaleUtc(),n,r)}(t,n,r);case"time":return function(t,n,r){return Mn(t,e.scaleTime(),n,r)}(t,n,r);case"point":return function(t,n,{align:r=.5,padding:o=.5,...i}){return zn(e.scalePoint().align(r).padding(o),n,i,t)}(t,n,r);case"band":return function(t,n,{align:r=.5,padding:o=.1,paddingInner:i=o,paddingOuter:a=("fx"===t||"fy"===t?0:o),...l}){return zn(e.scaleBand().align(r).paddingInner(i).paddingOuter(a),n,l,t)}(t,n,r);case"identity":return Et.get(t)===Mt?{type:"identity",scale:e.scaleIdentity()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${o}`)}}function Fn(t){return"symbol"==typeof t?t.description:t}const Yn={toString:()=>"projection"};function _n(t){switch(t){case Mt:return"point";case Lt:return Ln;default:return"ordinal"}}function Gn({type:t}){return"time"===t||"utc"===t}function Xn({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===Ln}function Un({type:t}){return"threshold"===t}function Hn(t){if(void 0===t)return!0;const e=t.domain(),n=t(e[0]);for(let r=1,o=e.length;r<o;++r)if(t(e[r])-n)return!1;return!0}function Vn(t,{domain:e,...n},r){for(const e of t)void 0!==e.value&&(e.value=r(e.value));return{domain:void 0===e?e:r(e),...n}}function Zn(t){return Y(t,Pt)}function Qn({scale:t,type:e,domain:n,range:r,interpolate:o,interval:i,transform:a,percent:l,pivot:s}){if("identity"===e)return{type:"identity",apply:t=>t,invert:t=>t};const c=t.unknown?t.unknown():void 0;return{type:e,domain:_(n),...void 0!==r&&{range:_(r)},...void 0!==a&&{transform:a},...l&&{percent:l},...void 0!==c&&{unknown:c},...void 0!==i&&{interval:i},...void 0!==o&&{interpolate:o},...t.clamp&&{clamp:t.clamp()},...void 0!==s&&{pivot:s,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:e=>t(e),...t.invert&&{invert:e=>t.invert(e)}}}function Jn(t){let e,n;return(...r)=>((n?.length!==r.length||n.some(((t,e)=>t!==r[e])))&&(n=r,e=t(...r)),e)}const Kn=Jn((t=>new Intl.NumberFormat(t))),tr=Jn(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{month:e}}))),er=Jn(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{weekday:e}})));function nr(t){return c(t,"Invalid Date")}const rr=function(t="en-US"){const e=function(t="en-US"){const e=Kn(t);return t=>null==t||isNaN(t)?void 0:e.format(t)}(t);return t=>(t instanceof Date?nr:"number"==typeof t?e:R)(t)}(),or="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5;let ir=0;function ar(){return"plot-clip-"+ ++ir}function lr(t,{title:e,href:n,ariaLabel:r,ariaDescription:o,ariaHidden:i,target:a,fill:l,fillOpacity:s,stroke:c,strokeWidth:u,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:g,opacity:y,mixBlendMode:v,paintOrder:x,pointerEvents:w,shapeRendering:b},{ariaLabel:k,fill:$="currentColor",fillOpacity:M,stroke:L="none",strokeOpacity:A,strokeWidth:z,strokeLinecap:O,strokeLinejoin:E,strokeMiterlimit:S,paintOrder:C}){null===$&&(l=null,s=null),null===L&&(c=null,f=null),xt($)?xt(L)||xt(l)||(L="none"):xt(L)&&!xt(c)&&($="none");const[B,T]=W(l,$),[N,I]=j(s,M),[P,D]=W(c,L),[q,F]=j(f,A),[Y,_]=j(y);wt(D)||(void 0===u&&(u=z),void 0===d&&(d=O),void 0===h&&(h=E),void 0!==p||/^\s*round\s*$/i.test(h)||(p=S),wt(T)||void 0!==x||(x=C));const[G,X]=j(u);return null!==$&&(t.fill=xr(T,"currentColor"),t.fillOpacity=wr(I,1)),null!==L&&(t.stroke=xr(D,"none"),t.strokeWidth=wr(X,1),t.strokeOpacity=wr(F,1),t.strokeLinejoin=xr(h,"miter"),t.strokeLinecap=xr(d,"butt"),t.strokeMiterlimit=wr(p,4),t.strokeDasharray=xr(m,"none"),t.strokeDashoffset=xr(g,"0")),t.target=R(a),t.ariaLabel=R(k),t.ariaDescription=R(o),t.ariaHidden=R(i),t.opacity=wr(_,1),t.mixBlendMode=xr(v,"normal"),t.paintOrder=xr(x,"normal"),t.pointerEvents=xr(w,"auto"),t.shapeRendering=xr(b,"auto"),{title:{value:e,optional:!0},href:{value:n,optional:!0},ariaLabel:{value:r,optional:!0},fill:{value:B,scale:"auto",optional:!0},fillOpacity:{value:N,scale:"auto",optional:!0},stroke:{value:P,scale:"auto",optional:!0},strokeOpacity:{value:q,scale:"auto",optional:!0},strokeWidth:{value:G,optional:!0},opacity:{value:Y,scale:"auto",optional:!0}}}function sr(t,e){e&&t.text((t=>rr(e[t])))}function cr(t,e){e&&t.text((([t])=>rr(e[t])))}function ur(t,{target:e},{ariaLabel:n,title:r,fill:o,fillOpacity:a,stroke:l,strokeOpacity:s,strokeWidth:c,opacity:u,href:f}){n&&yr(t,"aria-label",(t=>n[t])),o&&yr(t,"fill",(t=>o[t])),a&&yr(t,"fill-opacity",(t=>a[t])),l&&yr(t,"stroke",(t=>l[t])),s&&yr(t,"stroke-opacity",(t=>s[t])),c&&yr(t,"stroke-width",(t=>c[t])),u&&yr(t,"opacity",(t=>u[t])),f&&gr(t,(t=>f[t]),e),function(t,e){e&&t.filter((t=>i(e[t]))).append("title").call(sr,e)}(t,r)}function fr(t,{target:e},{ariaLabel:n,title:r,fill:o,fillOpacity:a,stroke:l,strokeOpacity:s,strokeWidth:c,opacity:u,href:f}){n&&yr(t,"aria-label",(([t])=>n[t])),o&&yr(t,"fill",(([t])=>o[t])),a&&yr(t,"fill-opacity",(([t])=>a[t])),l&&yr(t,"stroke",(([t])=>l[t])),s&&yr(t,"stroke-opacity",(([t])=>s[t])),c&&yr(t,"stroke-width",(([t])=>c[t])),u&&yr(t,"opacity",(([t])=>u[t])),f&&gr(t,(([t])=>f[t]),e),function(t,e){e&&t.filter((([t])=>i(e[t]))).append("title").call(cr,e)}(t,r)}function hr(t,n,r){const o=e.group(t,(t=>n[t]));return void 0===r&&o.size>t.length>>1&&Ee("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),o.values()}function*dr(t,e,{z:r},o){const{z:i}=o,a=function({ariaLabel:t,title:e,fill:n,fillOpacity:r,stroke:o,strokeOpacity:i,strokeWidth:a,opacity:l,href:s}){return[t,e,n,r,o,i,a,l,s].filter((t=>void 0!==t))}(o),l=[...e,...a];for(const e of i?hr(t,i,r):[t]){let t,r;t:for(const o of e){for(const t of l)if(!n(t[o])){r&&r.push(-1);continue t}if(void 0!==t){r.push(o);for(let e=0;e<a.length;++e){if(tt(a[e][o])!==t[e]){yield r,t=a.map((t=>tt(t[o]))),r=[o];continue t}}}else r&&(yield r),t=a.map((t=>tt(t[o]))),r=[o]}r&&(yield r)}}function pr(t,n,r,o){!function(t,n,r,o){let i;switch(n.clip){case"frame":{const{width:e,height:n,marginLeft:a,marginRight:l,marginTop:s,marginBottom:c}=r,u=ar();i=`url(#${u})`,t=Ye("svg:g",o).call((t=>t.append("svg:clipPath").attr("id",u).append("rect").attr("x",a).attr("y",s).attr("width",e-l-a).attr("height",n-s-c))).each((function(){this.appendChild(t.node()),t.node=()=>this}));break}case"sphere":{const{projection:n}=o;if(!n)throw new Error('the "sphere" clip option requires a projection');const r=ar();i=`url(#${r})`,t.append("clipPath").attr("id",r).append("path").attr("d",e.geoPath(n)({type:"Sphere"}));break}}yr(t,"aria-label",n.ariaLabel),yr(t,"aria-description",n.ariaDescription),yr(t,"aria-hidden",n.ariaHidden),yr(t,"clip-path",i)}(t,n,r,o),yr(t,"fill",n.fill),yr(t,"fill-opacity",n.fillOpacity),yr(t,"stroke",n.stroke),yr(t,"stroke-width",n.strokeWidth),yr(t,"stroke-opacity",n.strokeOpacity),yr(t,"stroke-linejoin",n.strokeLinejoin),yr(t,"stroke-linecap",n.strokeLinecap),yr(t,"stroke-miterlimit",n.strokeMiterlimit),yr(t,"stroke-dasharray",n.strokeDasharray),yr(t,"stroke-dashoffset",n.strokeDashoffset),yr(t,"shape-rendering",n.shapeRendering),yr(t,"paint-order",n.paintOrder),yr(t,"pointer-events",n.pointerEvents)}function mr(t,e){!function(t,e,n){null!=n&&t.style(e,n)}(t,"mix-blend-mode",e.mixBlendMode),yr(t,"opacity",e.opacity)}function gr(t,n,r){t.each((function(t){const o=n(t);if(null!=o){const t=this.ownerDocument.createElementNS(e.namespaces.svg,"a");t.setAttribute("fill","inherit"),t.setAttributeNS(e.namespaces.xlink,"href",o),null!=r&&t.setAttribute("target",r),this.parentNode.insertBefore(t,this).appendChild(this)}}))}function yr(t,e,n){null!=n&&t.attr(e,n)}function vr(t,e,{x:n,y:r},o=or,i=or){o+=e.dx,i+=e.dy,n?.bandwidth&&(o+=n.bandwidth()/2),r?.bandwidth&&(i+=r.bandwidth()/2),(o||i)&&t.attr("transform",`translate(${o},${i})`)}function xr(t,e){if((t=R(t))!==e)return t}function wr(t,e){if((t=z(t))!==e)return t}const br=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function kr(t){if(void 0===t)return`plot-${Math.random().toString(16).slice(2)}`;if(t=`${t}`,!br.test(t))throw new Error(`invalid class name: ${t}`);return t}function $r(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function Mr({frameAnchor:t},{width:e,height:n,marginTop:r,marginRight:o,marginBottom:i,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?e-o:(a+e-o)/2,/^top/.test(t)?r:/^bottom/.test(t)?n-i:(r+n-i)/2]}function Lr({x:t,y:e,fy:n,fx:r},o,{projection:i,aspectRatio:a},{width:l,marginTopDefault:s,marginRightDefault:c,marginBottomDefault:u,marginLeftDefault:f}){const h=n?n.scale.domain().length:1,d=function(t,e){if("function"==typeof t?.stream)return Be;if(G(t)&&(t=t.type),null==t)return function(t){for(const e of t)if(e.channels.geometry)return!0;return!1}(e)?Be:void 0;if("function"!=typeof t){const{aspectRatio:e}=Ne(t);if(e)return e}return Be}(i,o);if(d){const t=(1.1*h-.1)/(1.1*(r?r.scale.domain().length:1)-.1)*d,e=Math.max(.1,Math.min(10,t));return Math.round((l-f-c)*e+s+u)}const p=e?Xn(e)?e.scale.domain().length:Math.max(7,17/h):1;if(null!=a){if(a=+a,!(isFinite(a)&&a>0))throw new Error(`invalid aspectRatio: ${a}`);const o=Ar("y",e)/(Ar("x",t)*a),i=r?r.scale.bandwidth():1,h=n?n.scale.bandwidth():1;return(o*(i*(l-f-c)-t.insetLeft-t.insetRight)+e.insetTop+e.insetBottom)/h+s+u}return!(!e&&!n)*Math.max(1,Math.min(60,p*h))*20+30*!!r+60}function Ar(t,n){if(!n)throw new Error(`aspectRatio requires ${t} scale`);const{type:r,domain:o}=n;let i;switch(r){case"linear":case"utc":case"time":i=Number;break;case"pow":{const t=n.scale.exponent();i=e=>Math.pow(e,t);break}case"log":i=Math.log;break;case"point":case"band":return o.length;default:throw new Error(`unsupported ${t} scale for aspectRatio: ${r}`)}const[a,l]=e.extent(o);return Math.abs(i(l)-i(a))}function Rr(t,{fx:n,fy:r}){const o=J(t),i=n?.value,a=r?.value;return n&&r?e.rollup(o,(t=>(t.fx=i[t[0]],t.fy=a[t[0]],t)),(t=>i[t]),(t=>a[t])):n?e.rollup(o,(t=>(t.fx=i[t[0]],t)),(t=>i[t])):e.rollup(o,(t=>(t.fy=a[t[0]],t)),(t=>a[t]))}function zr(t){const n=[],r=new Uint32Array(e.sum(t,(t=>t.length)));for(const e of t){let o=0;for(const n of t)e!==n&&(r.set(n,o),o+=n.length);n.push(r.slice(0,o))}return n}const Or=new Map([["top",Er],["right",Br],["bottom",Sr],["left",Cr],["top-left",Tr(Er,Cr)],["top-right",Tr(Er,Br)],["bottom-left",Tr(Sr,Cr)],["bottom-right",Tr(Sr,Br)],["top-empty",function(t,{y:e},{x:n,y:r,empty:o}){if(o)return!1;const i=e?.indexOf(r);if(i>0){const r=e[i-1];return t.find((t=>t.x===n&&t.y===r))?.empty}}],["right-empty",function(t,{x:e},{x:n,y:r,empty:o}){if(o)return!1;const i=e?.indexOf(n);if(i<e?.length-1){const n=e[i+1];return t.find((t=>t.x===n&&t.y===r))?.empty}}],["bottom-empty",function(t,{y:e},{x:n,y:r,empty:o}){if(o)return!1;const i=e?.indexOf(r);if(i<e?.length-1){const r=e[i+1];return t.find((t=>t.x===n&&t.y===r))?.empty}}],["left-empty",function(t,{x:e},{x:n,y:r,empty:o}){if(o)return!1;const i=e?.indexOf(n);if(i>0){const n=e[i-1];return t.find((t=>t.x===n&&t.y===r))?.empty}}],["empty",function(t,e,{empty:n}){return n}]]);function Er(t,{y:e},{y:n}){return!e||0===e.indexOf(n)}function Sr(t,{y:e},{y:n}){return!e||e.indexOf(n)===e.length-1}function Cr(t,{x:e},{x:n}){return!e||0===e.indexOf(n)}function Br(t,{x:e},{x:n}){return!e||e.indexOf(n)===e.length-1}function Tr(t,e){return function(){return t.apply(null,arguments)&&e.apply(null,arguments)}}function Nr(t,{channels:{fx:e,fy:n},groups:r}){return e&&n?t.map((({x:t,y:e})=>r.get(t)?.get(e)??[])):e?t.map((({x:t})=>r.get(t)??[])):t.map((({y:t})=>r.get(t)??[]))}function Ir(t){return Xn(t)&&void 0===t.interval?void 0:"tabular-nums"}function Pr(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function Wr(t,n={},r,o){let{columns:i,tickFormat:a,fontVariant:l=Ir(t),swatchSize:s=15,swatchWidth:c=s,swatchHeight:u=s,marginLeft:f=0,className:h,style:d,width:p}=n;const m=Fe(n);h=kr(h),a=function(t,n){return void 0===t?ht(n)?nr:R:"function"==typeof t?t:("string"==typeof t?ht(n)?e.utcFormat:e.format:C)(t)}(a,t.domain);const g=Ye("div",m).attr("class",h).attr("style",`\n        --swatchWidth: ${+c}px;\n        --swatchHeight: ${+u}px;\n      `);let y;return null!=i?(y=`\n      .${h}-swatch {\n        display: flex;\n        align-items: center;\n        break-inside: avoid;\n        padding-bottom: 1px;\n      }\n      .${h}-swatch::before {\n        flex-shrink: 0;\n      }\n      .${h}-label {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n    `,g.style("columns",i).selectAll().data(t.domain).enter().append("div").attr("class",`${h}-swatch`).call(r,t).call((t=>t.append("div").attr("class",`${h}-label`).attr("title",a).text(a)))):(y=`\n      .${h} {\n        display: flex;\n        align-items: center;\n        min-height: 33px;\n        flex-wrap: wrap;\n      }\n      .${h}-swatch {\n        display: inline-flex;\n        align-items: center;\n        margin-right: 1em;\n      }\n    `,g.selectAll().data(t.domain).enter().append("span").attr("class",`${h}-swatch`).call(r,t).append((function(){return this.ownerDocument.createTextNode(a.apply(this,arguments))}))),g.call((t=>t.insert("style","*").text(`\n        .${h} {\n          font-family: system-ui, sans-serif;\n          font-size: 10px;\n          margin-bottom: 0.5em;${void 0===f?"":`\n          margin-left: ${+f}px;`}${void 0===p?"":`\n          width: ${p}px;`}\n        }\n        ${o(h)}\n        ${y}\n      `))).style("font-variant",xr(l,"normal")).call($r,d).node()}const jr=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:r=1,stroke:o=(void 0!==t.hint?.stroke?t.hint.stroke:xt(n)?"currentColor":"none"),strokeOpacity:i=1,strokeWidth:a=1.5,r:l=4.5,...s}={},c){const[u,f]=W(n),[h,d]=W(o),p=Pr(c,u),m=Pr(c,h),g=l*l*Math.PI;return r=j(r)[1],i=j(i)[1],a=j(a)[1],Wr(t,s,(n=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("fill","color"===u?t=>p.scale(t):null).attr("stroke","color"===h?t=>m.scale(t):null).append("path").attr("d",(n=>{const r=e.pathRound();return t.scale(n).draw(r,g),r}))),(t=>`.${t}-swatch > svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n        overflow: visible;\n        fill: ${f};\n        fill-opacity: ${r};\n        stroke: ${d};\n        stroke-width: ${a}px;\n        stroke-opacity: ${i};\n      }`))}],["color",qr],["opacity",function({type:t,interpolate:n,...r},{legend:o=!0,color:i=e.rgb(0,0,0),...a}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===o&&(o="ramp");if("ramp"!==`${o}`.toLowerCase())throw new Error(`${o} opacity legends are not supported`);return qr({type:t,...r,interpolate:Fr(i)},{legend:o,...a})}]]);function Dr(t,{label:e,ticks:n,tickFormat:r}={},o){return function(t={},...e){let n=t;for(const r of e)for(const e in r)if(void 0===n[e]){const o=r[e];n===t?n={...n,[e]:o}:n[e]=o}return n}(o,t,{label:e,ticks:n,tickFormat:r})}function qr(t,{legend:n=!0,...r}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,{opacity:e,...n}={}){if(!Xn(t)&&!Un(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return Wr(t,n,((t,n)=>t.append("svg").attr("fill",n.scale).attr("fill-opacity",j(e)[1]).append("rect").attr("width","100%").attr("height","100%")),(t=>`.${t}-swatch svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n      }`))}(t,r);case"ramp":return function(t,n){let{label:r=t.label,tickSize:o=6,width:i=240,height:a=44+o,marginTop:l=18,marginRight:s=0,marginBottom:c=16+o,marginLeft:u=0,style:f,ticks:h=(i-u-s)/64,tickFormat:d,fontVariant:p=Ir(t),round:m=!0,opacity:g,className:y}=n;const v=Fe(n);y=kr(y),g=j(g)[1],null===d&&(d=()=>null);const x=Ye("svg",v).attr("class",y).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",a).attr("viewBox",`0 0 ${i} ${a}`).call((t=>t.append("style").text(`\n        .${y} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n          overflow: visible;\n        }\n        .${y} text {\n          white-space: pre;\n        }\n      `))).call($r,f);let w,b=t=>t.selectAll(".tick line").attr("y1",l+c-a);const k=m?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:$,domain:M,range:L,interpolate:A,scale:R,pivot:z}=t;if(A){const t=void 0===L?A:e.piecewise(1===A.length?yn(A):A,L);w=k(R.copy(),e.quantize(e.interpolateNumber(u,i-s),Math.min(M.length+(void 0!==z),void 0===L?1/0:L.length)));const n=256,r=v.document.createElement("canvas");r.width=n,r.height=1;const o=r.getContext("2d");for(let e=0,r=n-1;e<n;++e)o.fillStyle=t(e/r),o.fillRect(e,0,1,1);x.append("image").attr("opacity",g).attr("x",u).attr("y",l).attr("width",i-u-s).attr("height",a-l-c).attr("preserveAspectRatio","none").attr("xlink:href",r.toDataURL())}else if("threshold"===$){const t=M,n=void 0===d?t=>t:"string"==typeof d?e.format(d):d;w=k(e.scaleLinear().domain([-1,L.length-1]),[u,i-s]),x.append("g").attr("fill-opacity",g).selectAll().data(L).enter().append("rect").attr("x",((t,e)=>w(e-1))).attr("y",l).attr("width",((t,e)=>w(e)-w(e-1))).attr("height",a-l-c).attr("fill",(t=>t)),h=Y(t,((t,e)=>e)),d=e=>n(t[e],e)}else w=k(e.scaleBand().domain(M),[u,i-s]),x.append("g").attr("fill-opacity",g).selectAll().data(M).enter().append("rect").attr("x",w).attr("y",l).attr("width",Math.max(0,w.bandwidth()-1)).attr("height",a-l-c).attr("fill",R),b=()=>{};return x.append("g").attr("transform",`translate(0,${a-c})`).call(e.axisBottom(w).ticks(Array.isArray(h)?null:h,"string"==typeof d?d:void 0).tickFormat("function"==typeof d?d:void 0).tickSize(o).tickValues(Array.isArray(h)?h:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",xr(p,"normal")).call(b).call((t=>t.select(".domain").remove())),void 0!==r&&x.append("text").attr("x",u).attr("y",l-6).attr("fill","currentColor").attr("font-weight","bold").text(r),x.node()}(t,r);default:throw new Error(`unknown legend type: ${n}`)}}function Fr(t){const{r:n,g:r,b:o}=e.rgb(t)||e.rgb(0,0,0);return t=>`rgba(${n},${r},${o},${t})`}class Yr{constructor(t,e={},n={},r){const{facet:o="auto",facetAnchor:i,fx:a,fy:l,sort:s,dx:c=0,dy:u=0,margin:f=0,marginTop:h=f,marginRight:d=f,marginBottom:p=f,marginLeft:m=f,clip:g,channels:y}=n;if(this.data=t,this.sort=H(s)?s:null,this.initializer=jt(n).initializer,this.transform=this.initializer?n.transform:Wt(n).transform,null===o||!1===o?this.facet=null:(this.facet=q(!0===o?"include":o,"facet",["auto","include","exclude","super"]),this.fx=a,this.fy=l),this.facetAnchor=function(t){if(null==t)return null;const e=Or.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid facet anchor: ${t}`)}(i),e=$t(e),void 0!==y&&(e={...$t(y),...e}),void 0!==r&&(e={...lr(this,n,r),...e}),this.channels=Object.fromEntries(Object.entries(e).map((([t,e])=>{const{value:n}=e;return U(n)&&(e={...e,value:n.value},void 0!==n.scale&&(e.scale=n.scale)),[t,e]})).filter((([t,{value:e,optional:n}])=>{if(null!=e)return!0;if(n)return!1;throw new Error(`missing channel value: ${t}`)}))),this.dx=+c,this.dy=+u,this.marginTop=+h,this.marginRight=+d,this.marginBottom=+p,this.marginLeft=+m,this.clip=function(t){return!0===t?t="frame":!1===t&&(t=null),D(t,"clip",["frame","sphere"])}(g),"super"===this.facet){if(a||l)throw new Error("super-faceting cannot use fx or fy");for(const t in this.channels){const{scale:n}=e[t];if("x"===n||"y"===n)throw new Error("super-faceting cannot use x or y")}}}initialize(t,n){let r=F(this.data);void 0===t&&null!=r&&(t=[J(r)]);const o=t;null!=this.transform&&(({facets:t,data:r}=this.transform(r,t)),r=F(r)),void 0!==t&&(t.original=o);const i=we(this.channels,r);return null!=this.sort&&function(t,n,r,o,i){const{reverse:a,reduce:l=!0,limit:s}=i;for(const c in i){if(!Et.has(c))continue;let{value:u,reverse:f=a,reduce:h=l,limit:d=s}=st(i[c]);if(void 0===f&&(f="width"===u||"height"===u),null==h||!1===h)continue;const p="fx"===c||"fy"===c?Me(n,o[c]):$e(r,c);if(!p)throw new Error(`missing channel for scale: ${c}`);const m=p.value,[g=0,y=1/0]=ct(d)?d:d<0?[d]:[0,d];if(null==u)p.domain=()=>{let t=Array.from(new e.InternSet(m));return f&&(t=t.reverse()),0===g&&y===1/0||(t=t.slice(g,y)),t};else{const n="data"===u?t:"height"===u?Le(r,"y1","y2"):"width"===u?Le(r,"x1","x2"):Ae(r,u,"y"===u?"y2":"x"===u?"x2":void 0),o=ie(!0===h?"max":h,n);p.domain=()=>{let t=e.rollup(J(m),(t=>o.reduceIndex(t,n)),(t=>m[t]));return t=e.sort(t,f?ze:Re),0===g&&y===1/0||(t=t.slice(g,y)),t.map(O)}}}}(r,t,i,n,this.sort),{data:r,facets:t,channels:i}}filter(t,e,r){for(const o in e){const{filter:i=n}=e[o];if(null!==i){const e=r[o];t=t.filter((t=>i(e[t])))}}return t}project(t,e,n){De("x","y",t,e,n),De("x1","y1",t,e,n),De("x2","y2",t,e,n)}scale(t,e,n){const r=be(t,e);return n.projection&&this.project(t,r,n),r}}function _r(...t){return t.plot=Yr.prototype.plot,t}const Gr=Math.PI/180;function Xr({inset:t,insetLeft:e,insetRight:n,...r}={}){return[e,n]=Hr(t,e,n),{inset:t,insetLeft:e,insetRight:n,...r}}function Ur({inset:t,insetTop:e,insetBottom:n,...r}={}){return[e,n]=Hr(t,e,n),{inset:t,insetTop:e,insetBottom:n,...r}}function Hr(t,e,n){return void 0===t&&void 0===e&&void 0===n?or?[1,0]:[.5,.5]:[e,n]}function Vr(t,{interval:e}){return(t={...st(t)}).interval=at(void 0===t.interval?e:t.interval),t}function Zr(t,e,n,r){const{[t]:o,[`${t}1`]:i,[`${t}2`]:a}=n,{value:l,interval:s}=Vr(o,n);if(null==l||null==s&&!r)return n;const c=ot(o);if(null==s){let e;const r={transform:t=>e||(e=x(t,l)),label:c};return{...n,[t]:void 0,[`${t}1`]:void 0===i?r:i,[`${t}2`]:void 0===a?r:a}}let u,f;function h(t){return void 0!==f&&t===u?f:f=Y(x(u=t,l),(t=>s.floor(t)))}return e({...n,[t]:void 0,[`${t}1`]:void 0===i?{transform:h,label:c}:i,[`${t}2`]:void 0===a?{transform:t=>h(t).map((t=>s.offset(t))),label:c}:a})}function Qr(t,e,n){const{[t]:r}=n,{value:o,interval:i}=Vr(r,n);return null==o||null==i?n:e({...n,[t]:{label:ot(r),transform:t=>{const e=Y(x(t,o),(t=>i.floor(t))),n=e.map((t=>i.offset(t)));return e.map(ht(e)?(t,e)=>null==t||isNaN(t=+t)||null==(e=n[e])||isNaN(e=+e)?void 0:new Date((t+e)/2):(t,e)=>null==t||null==(e=n[e])?NaN:(+t+ +e)/2)}}})}function Jr(t={}){return Zr("x",Xr,t,!0)}function Kr(t={}){return Zr("y",Ur,t,!0)}function to(t={}){return Zr("x",Xr,t)}function eo(t={}){return Zr("y",Ur,t)}function no(t={}){return Qr("x",Xr,t)}function ro(t={}){return Qr("y",Ur,t)}const oo={ariaLabel:"rule",fill:null,stroke:"currentColor"};class io extends Yr{constructor(t,e={}){const{x:n,y1:r,y2:o,inset:i=0,insetTop:a=i,insetBottom:l=i}=e;super(t,{x:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},e,oo),this.insetTop=z(a),this.insetBottom=z(l)}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y1:s,y2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetTop:g,insetBottom:y}=this;return Ye("svg:g",o).call(pr,this,r).call(vr,this,{x:l&&i},or,0).call((e=>e.selectAll().data(t).enter().append("line").call(mr,this).attr("x1",l?t=>l[t]:(p+u-d)/2).attr("x2",l?t=>l[t]:(p+u-d)/2).attr("y1",s&&!Hn(a)?t=>s[t]+g:h+g).attr("y2",c&&!Hn(a)?a.bandwidth?t=>c[t]+a.bandwidth()-y:t=>c[t]-y:f-m-y).call(ur,this,n))).node()}}class ao extends Yr{constructor(t,e={}){const{x1:n,x2:r,y:o,inset:i=0,insetRight:a=i,insetLeft:l=i}=e;super(t,{y:{value:o,scale:"y",optional:!0},x1:{value:n,scale:"x",optional:!0},x2:{value:r,scale:"x",optional:!0}},e,oo),this.insetRight=z(a),this.insetLeft=z(l)}render(t,e,n,r,o){const{x:i,y:a}=e,{y:l,x1:s,x2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetLeft:g,insetRight:y}=this;return Ye("svg:g",o).call(pr,this,r,o).call(vr,this,{y:l&&a},0,or).call((e=>e.selectAll().data(t).enter().append("line").call(mr,this).attr("x1",s&&!Hn(i)?t=>s[t]+g:p+g).attr("x2",c&&!Hn(i)?i.bandwidth?t=>c[t]+i.bandwidth()-y:t=>c[t]-y:u-d-y).attr("y1",l?t=>l[t]:(h+f-m)/2).attr("y2",l?t=>l[t]:(h+f-m)/2).call(ur,this,n))).node()}}function lo(t,e){let{x:n=M,y:r,y1:o,y2:i,...a}=eo(e);return[o,i]=co(r,o,i),new io(t,{...a,x:n,y1:o,y2:i})}function so(t,e){let{y:n=M,x:r,x1:o,x2:i,...a}=to(e);return[o,i]=co(r,o,i),new ao(t,{...a,y:n,x1:o,x2:i})}function co(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[0,n]}else if(void 0===n)return[0,e]}else{if(void 0===e)return void 0===n?[0,t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}function uo(t,...e){let n=e.length;for(let r=0,o=!0;r<n;++r)"function"!=typeof e[r]&&(o&&(t=t.slice(),o=!1),t.splice(r,2,t[r]+e[r]+t[r+1]),e.splice(r,1),--r,--n);return r=>{let o=t[0];for(let i=0;i<n;++i)o+=e[i](r)+t[i+1];return o}}const fo={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},ho="­";class po extends Yr{constructor(t,e={}){const{x:n,y:r,text:o=(ct(t)&&ut(t)?M:$),frameAnchor:a,textAnchor:l=(/right$/i.test(a)?"end":/left$/i.test(a)?"start":"middle"),lineAnchor:s=(/^top/i.test(a)?"top":/^bottom/i.test(a)?"bottom":"middle"),lineHeight:c=1,lineWidth:u=1/0,textOverflow:f,monospace:h,fontFamily:d=(h?"ui-monospace, monospace":void 0),fontSize:p,fontStyle:m,fontVariant:g,fontWeight:y,rotate:v}=e,[w,b]=j(v,0),[k,L]=function(t){return null==t||"number"==typeof t?[void 0,t]:"string"!=typeof t?[t,void 0]:(t=t.trim().toLowerCase(),wo.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}(p);var A;if(super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},fontSize:{value:k,optional:!0},rotate:{value:(A=w,null==A?null:{transform:t=>x(t,A,Float64Array),label:ot(A)}),optional:!0},text:{value:o,filter:i,optional:!0}},e,fo),this.rotate=b,this.textAnchor=xr(l,"middle"),this.lineAnchor=q(s,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+c,this.lineWidth=+u,this.textOverflow=function(t){return null==t?null:q(t,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}(f),this.monospace=!!h,this.fontFamily=R(d),this.fontSize=L,this.fontStyle=R(m),this.fontVariant=R(g),this.fontWeight=R(y),this.frameAnchor=bt(a),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${u}`);this.splitLines=function({monospace:t,lineWidth:e,textOverflow:n}){if(null!=n||e==1/0)return t=>t.split(/\r\n?|\n/g);const r=t?$o:ko,o=100*e;return t=>function(t,e,n){const r=[];let o,i=0;for(const[a,l,s]of function*(t){let e=0,n=0;const r=t.length;for(;n<r;){let r=1;switch(t[n]){case ho:case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];" "===t[++n];);e=n;break;case"\r":"\n"===t[n+1]&&++r;case"\n":yield[e,n,!0],n+=r,e=n;break;default:++n}}yield[e,n,!0]}(t))void 0===o&&(o=a),i>o&&n(t,o,l)>e&&(r.push(t.slice(o,i)+(t[i-1]===ho?"-":"")),o=a),s?(r.push(t.slice(o,l)),o=void 0):i=l;return r}(t,o,r)}(this),this.clipLine=function({monospace:t,lineWidth:e,textOverflow:n}){if(null==n||e==1/0)return t=>t;const r=t?$o:ko,o=100*e;switch(n){case"clip-start":return t=>Ao(t,o,r,"");case"clip-end":return t=>Lo(t,o,r,"");case"ellipsis-start":return t=>Ao(t,o,r,"…");case"ellipsis-middle":return t=>function(t,e,n,r){t=t.trim();const o=n(t);if(o<=e)return t;const i=n(r)/2,[a,l]=Mo(t,e/2,n,i),[s]=Mo(t,o-e/2-l+i,n,-i);return s<0?r:t.slice(0,a).trimEnd()+r+t.slice(Oo(t,s)).trimStart()}(t,o,r,"…");case"ellipsis-end":return t=>Lo(t,o,r,"…")}}(this)}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y:s,rotate:c,text:u,title:f,fontSize:h}=n,{rotate:d}=this,[p,m]=Mr(this,r);return Ye("svg:g",o).call(pr,this,r,o).call(xo,this,u,r).call(vr,this,{x:l&&i,y:s&&a}).call((e=>e.selectAll().data(t).enter().append("text").call(mr,this).call(mo,this,u,f).attr("transform",uo`translate(${l?t=>l[t]:p},${s?t=>s[t]:m})${c?t=>` rotate(${c[t]})`:d?` rotate(${d})`:""}`).call(yr,"font-size",h&&(t=>h[t])).call(ur,this,n))).node()}}function mo(t,n,r,o){if(!r)return;const{lineAnchor:i,lineHeight:a,textOverflow:l,splitLines:s,clipLine:c}=n;t.each((function(t){const n=s(rr(r[t])??"").map(c),u=n.length,f="top"===i?.71:"bottom"===i?1-u:(164-100*u)/200;if(u>1)for(let t=0;t<u;++t){if(!n[t])continue;const r=this.ownerDocument.createElementNS(e.namespaces.svg,"tspan");r.setAttribute("x",0),r.setAttribute("y",(f+t)*a+"em"),r.textContent=n[t],this.appendChild(r)}else f&&this.setAttribute("y",f*a+"em"),this.textContent=n[0];if(l&&!o&&n[0]!==r[t]){const n=this.ownerDocument.createElementNS(e.namespaces.svg,"title");n.textContent=r[t],this.appendChild(n)}}))}function go(t,e={}){let{x:n,y:r,...o}=e;return void 0===e.frameAnchor&&([n,r]=Z(n,r)),new po(t,{...o,x:n,y:r})}function yo(t,e={}){const{x:n=M,...r}=e;return new po(t,ro({...r,x:n}))}function vo(t,e={}){const{y:n=M,...r}=e;return new po(t,no({...r,y:n}))}function xo(t,e,n){yr(t,"text-anchor",e.textAnchor),yr(t,"font-family",e.fontFamily),yr(t,"font-size",e.fontSize),yr(t,"font-style",e.fontStyle),yr(t,"font-variant",void 0===e.fontVariant?function(t){return mt(t)||ht(t)?"tabular-nums":void 0}(n):e.fontVariant),yr(t,"font-weight",e.fontWeight)}const wo=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);const bo={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47,"…":82};function ko(t,e=0,n=t.length){let r=0;for(let o=e;o<n;o=Oo(t,o))r+=bo[t[o]]??(So(t,o)?120:bo.e);return r}function $o(t,e=0,n=t.length){let r=0;for(let o=e;o<n;o=Oo(t,o))r+=So(t,o)?200:100;return r}function Mo(t,e,n,r){const o=[];let i=0;for(let a=0,l=0,s=t.length;a<s;a=l){l=Oo(t,a);const s=n(t,a,l);if(i+s>e){for(i+=r;i>e&&a>0;)l=a,a=o.pop(),i-=n(t,a,l);return[a,e-i]}i+=s,o.push(a)}return[-1,0]}function Lo(t,e,n,r){t=t.trim();const o=n(r),[i]=Mo(t,e,n,o);return i<0?t:t.slice(0,i).trimEnd()+r}function Ao(t,e,n,r){const o=n(t=t.trim());if(o<=e)return t;const i=n(r),[a]=Mo(t,o-e+i,n,-i);return a<0?r:r+t.slice(Oo(t,a)).trimStart()}const Ro=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,zo=/\p{Extended_Pictographic}/uy;function Oo(t,e){return e+=function(t,e){const n=t.charCodeAt(e);if(n>=55296&&n<56320){const n=t.charCodeAt(e+1);return n>=56320&&n<57344}return!1}(t,e)?2:1,function(t,e){return!Eo(t,e)&&(Ro.lastIndex=e,Ro.test(t))}(t,e)&&(e=Ro.lastIndex),function(t,e){return 8205===t.charCodeAt(e)}(t,e)?Oo(t,e+1):e}function Eo(t,e){return t.charCodeAt(e)<128}function So(t,e){return!Eo(t,e)&&(zo.lastIndex=e,zo.test(t))}const Co={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},Bo=3.5,To=5*Bo,No={draw(t,e,n){const r=e*n/To;t.moveTo(0,0),t.lineTo(0,-e),t.moveTo(-r,r-e),t.lineTo(0,-e),t.lineTo(r,r-e)}},Io={draw(t,e,n){t.moveTo(-n,0),t.lineTo(0,-e),t.lineTo(n,0)}},Po=new Map([["arrow",No],["spike",Io]]);class Wo extends Yr{constructor(t,e={}){const{x:n,y:r,r:o=Bo,length:i,rotate:a,shape:l=No,anchor:s="middle",frameAnchor:c}=e,[u,f]=j(i,12),[h,d]=j(a,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},length:{value:u,scale:"length",optional:!0},rotate:{value:h,optional:!0}},e,Co),this.r=+o,this.length=f,this.rotate=d,this.shape=function(t){if(function(t){return t&&"function"==typeof t.draw}(t))return t;const e=Po.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid shape: ${t}`)}(l),this.anchor=q(s,"anchor",["start","middle","end"]),this.frameAnchor=bt(c)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,length:u,rotate:f}=r,{length:h,rotate:d,anchor:p,shape:m,r:g}=this,[y,v]=Mr(this,o);return Ye("svg:g",i).call(pr,this,o,i).call(vr,this,{x:s&&a,y:c&&l}).call((n=>n.selectAll().data(t).enter().append("path").call(mr,this).attr("transform",uo`translate(${s?t=>s[t]:y},${c?t=>c[t]:v})${f?t=>` rotate(${f[t]})`:d?` rotate(${d})`:""}${"start"===p?"":"end"===p?u?t=>` translate(0,${u[t]})`:` translate(0,${h})`:u?t=>` translate(0,${u[t]/2})`:` translate(0,${h/2})`}`).attr("d",u?t=>{const n=e.pathRound();return m.draw(n,u[t],g),n}:(()=>{const t=e.pathRound();return m.draw(t,h,g),t})()).call(ur,this,r))).node()}}function jo(t,e={}){let{x:n,y:r,...o}=e;return void 0===e.frameAnchor&&([n,r]=Z(n,r)),new Wo(t,{...o,x:n,y:r})}function Do(t,e={}){const{x:n=M,...r}=e;return new Wo(t,{...r,x:n})}function qo(t,e={}){const{y:n=M,...r}=e;return new Wo(t,{...r,y:n})}function Fo(t,e){return arguments.length<2&&!ct(t)&&(e=t,t=null),void 0===e&&(e={}),[t,e]}function Yo({anchor:t}={},e){return void 0===t?e[0]:q(t,"anchor",e)}function _o(t){return Yo(t,["left","right"])}function Go(t){return Yo(t,["right","left"])}function Xo(t){return Yo(t,["bottom","top"])}function Uo(t){return Yo(t,["top","bottom"])}function Ho(){const[t,e]=Fo(...arguments);return Jo("y",_o(e),t,e)}function Vo(){const[t,e]=Fo(...arguments);return Jo("fy",Go(e),t,e)}function Zo(){const[t,e]=Fo(...arguments);return Ko("x",Xo(e),t,e)}function Qo(){const[t,e]=Fo(...arguments);return Ko("fx",Uo(e),t,e)}function Jo(t,e,n,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("y"===t?6:0),tickPadding:m,tickRotate:g,x:y,marginTop:v=20,marginRight:x=("right"===e?40:0),marginBottom:w=20,marginLeft:b=("left"===e?40:0),label:k,labelOffset:$,labelAnchor:M,...L}){return p=z(p),m=z(m),g=z(g),void 0!==M&&(M=q(M,"labelAnchor",["center","top","bottom"])),_r(p&&!xt(i)?function(t,e,n,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=e+("y"===t?"-empty":""),frameAnchor:l=e,tickSize:s,inset:c=0,insetLeft:u=c,insetRight:f=c,dx:h=0,y:d=("y"===t?void 0:null),...p}){return li(qo,t,`${t}-axis tick`,n,{strokeWidth:r,strokeLinecap:o,strokeLinejoin:i,facetAnchor:a,frameAnchor:l,y:d,...p,dx:"left"===e?+h-or+ +u:+h+or-f,anchor:"start",length:s,shape:"left"===e?hi:di})}(t,e,n,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:g,x:y,...L}):null,xt(s)?null:function(t,e,n,{facetAnchor:r=e+("y"===t?"-empty":""),frameAnchor:o=e,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>60?4*Math.cos(a*Gr):0),tickFormat:s,text:c=("function"==typeof s?s:void 0),textAnchor:u=(Math.abs(a)>60?"middle":"left"===e?"end":"start"),lineAnchor:f=(a>60?"top":a<-60?"bottom":"middle"),fontVariant:h,inset:d=0,insetLeft:p=d,insetRight:m=d,dx:g=0,y:y=("y"===t?void 0:null),...v}){return li(vo,t,`${t}-axis tick label`,n,{facetAnchor:r,frameAnchor:o,text:void 0===c?null:c,textAnchor:u,lineAnchor:f,fontVariant:h,rotate:a,y:y,...v,dx:"left"===e?+g-i-l+ +p:+g+ +i+ +l-m},(function(t,e,n){void 0===h&&(this.fontVariant=pi(t)),void 0===c&&(n.text=si(t,e,s))}))}(t,e,n,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:g,x:y,marginTop:v,marginRight:x,marginBottom:w,marginLeft:b,...L}),xt(s)||null===k?null:go([],{fill:s,fillOpacity:c,...L,lineWidth:void 0,textOverflow:void 0,facet:"super",x:null,y:null,initializer:function(n,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="y"===t&&a.inset||a,h=M??(l.bandwidth?"center":"top"),d=$??("right"===e?c:f)-3;return"center"===h?(this.textAnchor=void 0,this.lineAnchor="right"===e?"bottom":"top",this.frameAnchor=e,this.rotate=-90):(this.textAnchor="right"===e?"end":"start",this.lineAnchor=h,this.frameAnchor=`${h}-${e}`,this.rotate=0),this.dy="top"===h?3-s:"bottom"===h?u-3:0,this.dx="right"===e?d:-d,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[void 0===k?mi(t,l,h):k]}}}}}))}function Ko(t,e,n,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("x"===t?6:0),tickPadding:m,tickRotate:g,y:y,marginTop:v=("top"===e?30:0),marginRight:x=20,marginBottom:w=("bottom"===e?30:0),marginLeft:b=20,label:k,labelAnchor:$,labelOffset:M,...L}){return p=z(p),m=z(m),g=z(g),void 0!==$&&($=q($,"labelAnchor",["center","left","right"])),_r(p&&!xt(i)?function(t,e,n,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=e+("x"===t?"-empty":""),frameAnchor:l=e,tickSize:s,inset:c=0,insetTop:u=c,insetBottom:f=c,dy:h=0,x:d=("x"===t?void 0:null),...p}){return li(Do,t,`${t}-axis tick`,n,{strokeWidth:r,strokeLinejoin:i,strokeLinecap:o,facetAnchor:a,frameAnchor:l,x:d,...p,dy:"bottom"===e?+h-or-f:+h+or+ +u,anchor:"start",length:s,shape:"bottom"===e?ui:fi})}(t,e,n,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:g,y:y,...L}):null,xt(s)?null:function(t,e,n,{facetAnchor:r=e+("x"===t?"-empty":""),frameAnchor:o=e,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>=10?4*Math.cos(a*Gr):0),tickFormat:s,text:c=("function"==typeof s?s:void 0),textAnchor:u=(Math.abs(a)>=10?a<0^"bottom"===e?"start":"end":"middle"),lineAnchor:f=(Math.abs(a)>=10?"middle":"bottom"===e?"top":"bottom"),fontVariant:h,inset:d=0,insetTop:p=d,insetBottom:m=d,dy:g=0,x:y=("x"===t?void 0:null),...v}){return li(yo,t,`${t}-axis tick label`,n,{facetAnchor:r,frameAnchor:o,text:void 0===c?null:c,textAnchor:u,lineAnchor:f,fontVariant:h,rotate:a,x:y,...v,dy:"bottom"===e?+g+ +i+ +l-m:+g-i-l+ +p},(function(t,e,n){void 0===h&&(this.fontVariant=pi(t)),void 0===c&&(n.text=si(t,e,s))}))}(t,e,n,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:g,y:y,marginTop:v,marginRight:x,marginBottom:w,marginLeft:b,...L}),xt(s)||null===k?null:go([],{fill:s,fillOpacity:c,...L,lineWidth:void 0,textOverflow:void 0,facet:"super",x:null,y:null,initializer:function(n,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="x"===t&&a.inset||a,h=$??(l.bandwidth?"center":"right"),d=M??("top"===e?s:u)-3;return"center"===h?(this.frameAnchor=e,this.textAnchor=void 0):(this.frameAnchor=`${e}-${h}`,this.textAnchor="right"===h?"end":"start"),this.lineAnchor=e,this.dy="top"===e?-d:d,this.dx="right"===h?c-3:"left"===h?3-f:0,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[void 0===k?mi(t,l,h):k]}}}}}))}function ti(){const[t,e]=Fo(...arguments);return oi("y",_o(e),t,e)}function ei(){const[t,e]=Fo(...arguments);return oi("fy",Go(e),t,e)}function ni(){const[t,e]=Fo(...arguments);return ii("x",Xo(e),t,e)}function ri(){const[t,e]=Fo(...arguments);return ii("fx",Uo(e),t,e)}function oi(t,e,n,{y:r=("y"===t?void 0:null),x:o=null,x1:i=("left"===e?o:null),x2:a=("right"===e?o:null),...l}){return li(so,t,`${t}-grid`,n,{y:r,x1:i,x2:a,...ai(l)})}function ii(t,e,n,{x:r=("x"===t?void 0:null),y:o=null,y1:i=("top"===e?o:null),y2:a=("bottom"===e?o:null),...l}){return li(lo,t,`${t}-grid`,n,{x:r,y1:i,y2:a,...ai(l)})}function ai({color:t="currentColor",opacity:e=.1,stroke:n=t,strokeOpacity:r=e,strokeWidth:o=1,...i}){return{stroke:n,strokeOpacity:r,strokeWidth:o,...i}}function li(t,n,r,o,i,a){let l;const s=t(o,jt(i,(function(t,r,o,s){const{[n]:c}=s;if(!c)throw new Error(`missing scale: ${n}`);let{ticks:u,tickSpacing:f,interval:h}=i;if(Gn(c)&&"string"==typeof u&&(h=u,u=void 0),null==t){if(ct(u))t=F(u);else if(c.ticks)if(void 0!==u)t=c.ticks(u);else if(h=lt(void 0===h?c.interval:h,c.type),void 0!==h){const[n,r]=e.extent(c.domain());t=h.range(n,h.offset(h.floor(r)))}else{const[r,o]=e.extent(c.range());u=(o-r)/(void 0===f?"x"===n?80:35:f),t=c.ticks(u)}else t=c.domain();"y"===n||"x"===n?r=[J(t)]:(l[n]={scale:n,value:M},r=void 0)}return a?.call(this,c,u,l),{data:t,facets:r,channels:Object.fromEntries(Object.entries(l).map((([e,n])=>[e,{...n,value:x(t,n.value)}])))}})));return null==o?(l=s.channels,s.channels={}):l={},s.ariaLabel=r,s}function si(t,e,n){return{value:ci(t,e,n)}}function ci(t,n,r){return t.tickFormat?t.tickFormat(ct(n)?null:n,r):void 0===r?rr:"string"==typeof r?(ht(t.domain())?e.utcFormat:e.format)(r):C(r)}const ui={draw(t,e){t.moveTo(0,0),t.lineTo(0,e)}},fi={draw(t,e){t.moveTo(0,0),t.lineTo(0,-e)}},hi={draw(t,e){t.moveTo(0,0),t.lineTo(-e,0)}},di={draw(t,e){t.moveTo(0,0),t.lineTo(e,0)}};function pi(t){return t.bandwidth&&void 0===t.interval?void 0:"tabular-nums"}function mi(t,e,n){const r=e.label;if(e.bandwidth||!r?.inferred)return r;const o=function(t){return Math.sign(kt(t.domain()))*Math.sign(kt(t.range()))}(e);return o?"x"===t||"center"===n?"x"===t==o<0?`← ${r}`:`${r} →`:`${o<0?"↑ ":"↓ "}${r}`:r}const gi={ariaLabel:"frame",fill:"none",stroke:"currentColor"},yi={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square"};class vi extends Yr{constructor(t={}){const{anchor:e=null,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n,rx:l,ry:s}=t;super(void 0,void 0,t,null==e?gi:yi),this.anchor=D(e,"anchor",["top","right","bottom","left"]),this.insetTop=z(r),this.insetRight=z(o),this.insetBottom=z(i),this.insetLeft=z(a),this.rx=z(l),this.ry=z(s)}render(t,e,n,r,o){const{marginTop:i,marginRight:a,marginBottom:l,marginLeft:s,width:c,height:u}=r,{anchor:f,insetTop:h,insetRight:d,insetBottom:p,insetLeft:m,rx:g,ry:y}=this,v=s+m,x=c-a-d,w=i+h,b=u-l-p;return Ye(f?"svg:line":"svg:rect",o).call(pr,this,r,o).call(mr,this).call(vr,this,{}).call("left"===f?t=>t.attr("x1",v).attr("x2",v).attr("y1",w).attr("y2",b):"right"===f?t=>t.attr("x1",x).attr("x2",x).attr("y1",w).attr("y2",b):"top"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",w).attr("y2",w):"bottom"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",b).attr("y2",b):t=>t.attr("x",v).attr("y",w).attr("width",x-v).attr("height",b-w).attr("rx",g).attr("ry",y)).node()}}function xi(t){return new vi(t)}function wi(t={}){const{facet:n,style:r,caption:o,ariaLabel:i,ariaDescription:a}=t,l=kr(t.className),s=void 0===t.marks?[]:bi(t.marks),c=function(t,e){if(null==t)return;const{x:n,y:r}=t;if(null==n&&null==r)return;const o=F(t.data??n??r);if(void 0===o)throw new Error("missing facet data");const i={};null!=n&&(i.fx=xe(o,{value:n,scale:"fx"}));null!=r&&(i.fy=xe(o,{value:r,scale:"fy"}));Mi(i,e);const a=Rr(o,i);return{channels:i,groups:a,data:t.data}}(n,t),u=new Map;for(const e of s){const n=zi(e,c,t);n&&u.set(e,n)}const f=new Map;c&&Ri(f,[c]),Ri(f,u);const h=bi(function(t,e,n){let{projection:r,x:o={},y:i={},fx:a={},fy:l={},axis:s,grid:c,facet:u={},facet:{axis:f=s,grid:h}=u,x:{axis:d=s,grid:p=(null===d?null:c)}=o,y:{axis:m=s,grid:g=(null===m?null:c)}=i,fx:{axis:y=f,grid:v=(null===y?null:h)}=a,fy:{axis:x=f,grid:w=(null===x?null:h)}=l}=n;(r||!X(o)&&!Bi("x",t))&&(d=p=null);(r||!X(i)&&!Bi("y",t))&&(m=g=null);e.has("fx")||(y=v=null);e.has("fy")||(x=w=null);void 0===d&&(d=!Ci(t,"x"));void 0===m&&(m=!Ci(t,"y"));void 0===y&&(y=!Ci(t,"fx"));void 0===x&&(x=!Ci(t,"fy"));!0===d&&(d="bottom");!0===m&&(m="left");!0===y&&(y="top"===d||null===d?"bottom":"top");!0===x&&(x="right"===m||null===m?"left":"right");const b=[];return Ei(b,w,ei,l),Oi(b,x,Vo,"right","left",u,l),Ei(b,v,ri,a),Oi(b,y,Qo,"top","bottom",u,a),Ei(b,g,ti,i),Oi(b,m,Ho,"left","right",n,i),Ei(b,p,ni,o),Oi(b,d,Zo,"bottom","top",n,o),b}(s,f,t));for(const e of h){const n=zi(e,c,t);n&&u.set(e,n)}s.unshift(...h);const d=function(t,n){const{fx:r,fy:o}=Sn(t,n),i=r?.scale.domain(),a=o?.scale.domain();return i&&a?e.cross(i,a).map((([t,e],n)=>({x:t,y:e,i:n}))):i?i.map(((t,e)=>({x:t,i:e}))):a?a.map(((t,e)=>({y:t,i:e}))):void 0}(f,t);if(void 0!==d){const t=c?Nr(d,c):void 0;for(const e of s){if(null===e.facet||"super"===e.facet)continue;const n=u.get(e);void 0!==n&&(n.facetsIndex=null!=e.fx||null!=e.fy?Nr(d,n):t)}const e=new Set;for(const{facetsIndex:t}of u.values())t?.forEach(((t,n)=>{t?.length>0&&e.add(n)}));d.forEach(0<e.size&&e.size<d.length?(t,n)=>t.empty=!e.has(n):t=>t.empty=!1);for(const t of s)if("exclude"===t.facet){const e=u.get(t);void 0!==e&&(e.facetsIndex=zr(e.facetsIndex))}}for(const e of Et.keys())X(t[e])&&"fx"!==e&&"fy"!==e&&f.set(e,[]);const p=new Map;for(const e of s){if(p.has(e))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:n,channels:r}=u.get(e)??{},{data:o,facets:i,channels:a}=e.initialize(n,r);Mi(a,t),p.set(e,{data:o,facets:i,channels:a})}const m=Sn(Ri(f,p),t),g=Cn(m),y=function(t,e,n={}){let r=.5-or,o=.5+or,i=.5+or,a=.5-or;for(const{marginTop:t,marginRight:n,marginBottom:l,marginLeft:s}of e)t>r&&(r=t),n>o&&(o=n),l>i&&(i=l),s>a&&(a=s);let{margin:l,marginTop:s=(void 0!==l?l:r),marginRight:c=(void 0!==l?l:o),marginBottom:u=(void 0!==l?l:i),marginLeft:f=(void 0!==l?l:a)}=n;s=+s,c=+c,u=+u,f=+f;let{width:h=640,height:d=Lr(t,e,n,{width:h,marginTopDefault:r,marginRightDefault:o,marginBottomDefault:i,marginLeftDefault:a})+Math.max(0,s-r+u-i)}=n;h=+h,d=+d;const p={width:h,height:d,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f};if(t.fx||t.fy){let{margin:t,marginTop:e=(void 0!==t?t:s),marginRight:r=(void 0!==t?t:c),marginBottom:o=(void 0!==t?t:u),marginLeft:i=(void 0!==t?t:f)}=n.facet??{};e=+e,r=+r,o=+o,i=+i,p.facet={marginTop:e,marginRight:r,marginBottom:o,marginLeft:i}}return p}(m,s,t);!function(t,e){const{x:n,y:r,fx:o,fy:i}=t,a=o||i?Tn(e):e;o&&In(o,a),i&&Pn(i,a);const l=o||i?Nn(t,e):e;n&&In(n,l),r&&Pn(r,l)}(m,y);const{fx:v,fy:x}=g,w=v||x?Nn(m,y):y,b=v||x?function({fx:t,fy:e},n){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=Tn(n),c=t&&Ti(t),u=e&&Ti(e);return{marginTop:e?u[0]:r,marginRight:t?l-c[1]:o,marginBottom:e?s-u[1]:i,marginLeft:t?c[0]:a,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:l,height:s}}(g,y):y,k=Fe(t,w),$=new Set;for(const[e,n]of p)if(null!=e.initializer){const r="super"===e.facet?b:w,o=e.initializer(n.data,n.facets,n.channels,g,r,k);if(void 0!==o.data&&(n.data=o.data),void 0!==o.facets&&(n.facets=o.facets),void 0!==o.channels){Ai(o.channels),Object.assign(n.channels,o.channels);for(const e of Object.values(o.channels)){const{scale:n}=e;null!=n&&Et.get(n)!==Mt&&(Li(e,t),$.add(n))}const{fx:r,fy:i}=o.channels;if(null!=r||null!=i){const t=u.get(e)??{channels:{}};null!=r&&(t.channels.fx=r),null!=i&&(t.channels.fy=i),t.groups=Rr(n.data,t.channels),t.facetsIndex=n.facets=Nr(d,t),u.set(e,t)}}}if($.size){const e=new Map;Ri(e,p,(t=>$.has(t))),Ri(f,p,(t=>$.has(t)));const n=function(t,e){for(const n in t){const r=t[n],o=e[n];void 0===r.label&&o&&(r.label=o.label)}return t}(Sn(e,t),m),r=Cn(n);Object.assign(m,n),Object.assign(g,r)}for(const[t,e]of p)e.values=t.scale(e.channels,g,k);const{width:M,height:L}=y,A=Ye("svg",k).attr("class",l).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",M).attr("height",L).attr("viewBox",`0 0 ${M} ${L}`).attr("aria-label",i).attr("aria-description",a).call((t=>t.append("style").text(`\n        .${l} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n        }\n        .${l} text,\n        .${l} tspan {\n          white-space: pre;\n        }\n      `))).call($r,r).node();if(void 0!==d){const t={x:v?.domain(),y:x?.domain()};d.sort(function({x:t,y:e}){const n=t&&new Map(t.map(((t,e)=>[t,e]))),r=e&&new Map(e.map(((t,e)=>[t,e])));return t&&e?(t,e)=>n.get(t.x)-n.get(e.x)||r.get(t.y)-r.get(e.y):t?(t,e)=>n.get(t.x)-n.get(e.x):(t,e)=>r.get(t.y)-r.get(e.y)}(t)),e.select(A).selectAll().data(d).enter().append("g").attr("aria-label","facet").attr("transform",function(t,e,{marginTop:n,marginLeft:r}){return t&&e?({x:o,y:i})=>`translate(${t(o)-r},${e(i)-n})`:t?({x:e})=>`translate(${t(e)-r},0)`:({y:t})=>`translate(0,${e(t)-n})`}(v,x,y)).each((function(e){let n=!0;for(const r of s){if("super"===r.facet)continue;const{channels:o,values:i,facets:a}=p.get(r);if(!(r.facetAnchor?.(d,t,e)??!e.empty))continue;let l=null;if(a){if(l=a[u.has(r)?e.i:0],l=r.filter(l,o,i),0===l.length)continue;l.fi=e.i}const s=r.render(l,g,i,w,k);null!=s&&(n=!1,this.appendChild(s))}n&&this.remove()}))}for(const t of s){if(void 0!==d&&"super"!==t.facet)continue;const{channels:e,values:n,facets:r}=p.get(t);let o=null;if(r&&(o=r[0],o=t.filter(o,e,n),0===o.length))continue;const i=t.render(o,g,n,b,k);null!=i&&A.appendChild(i)}let R=A;const z=function(t,e,n){const r=[];for(const[o,i]of jr){const a=n[o];if(a?.legend&&o in t){const n=i(t[o],Dr(e,t[o],a),(e=>t[e]));null!=n&&r.push(n)}}return r}(m,k,t);if(null!=o||z.length>0){const{document:t}=k;R=t.createElement("figure"),R.style.maxWidth="initial";for(const t of z)R.appendChild(t);if(R.appendChild(A),null!=o){const e=t.createElement("figcaption");e.appendChild(o instanceof Node?o:t.createTextNode(o)),R.appendChild(e)}}R.scale=function(t){return e=>{if(!Et.has(e=`${e}`))throw new Error(`unknown scale: ${e}`);return e in t?Qn(t[e]):void 0}}(m),R.legend=function(t,e,n={}){return(r,o)=>{if(!jr.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return jr.get(r)(t[r],Dr(e,n[r],o),(e=>t[e]))}}(m,k,t);const O=function(){const t=Oe;return Oe=0,t}();return O>0&&e.select(A).append("text").attr("x",M).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${O.toLocaleString("en-US")} warning${1===O?"":"s"}. Please check the console.`),R}function bi(t){return t.flat(1/0).filter((t=>null!=t)).map(ki)}function ki(t){return"function"==typeof t.render?t:new $i(t)}Yr.prototype.plot=function({marks:t=[],...e}={}){return wi({...e,marks:[...t,this]})};class $i extends Yr{constructor(t){if("function"!=typeof t)throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function Mi(t,e){for(const n in t)Li(t[n],e);return t}function Li(t,e){const{scale:n}=t;if(null==n)return;const{type:r,percent:o,interval:i,transform:a=(o?t=>100*t:at(i,r)?.floor)}=e[n]??{};null!=a&&(t.value=Y(t.value,a))}function Ai(t){for(const e in t)ke(e,t[e])}function Ri(t,e,n=A){for(const{channels:r}of e.values())for(const e in r){const o=r[e],{scale:i}=o;if(null!=i&&n(i)){const e=t.get(i);void 0!==e?e.push(o):t.set(i,[o])}}return t}function zi(t,e,n){if(null===t.facet||"super"===t.facet)return;const{fx:r,fy:o}=t;if(null!=r||null!=o){const e=F(t.data??r??o);if(void 0===e)throw new Error(`missing facet data in ${t.ariaLabel}`);if(null===e)return;const i={};return null!=r&&(i.fx=xe(e,{value:r,scale:"fx"})),null!=o&&(i.fy=xe(e,{value:o,scale:"fy"})),Mi(i,n),{channels:i,groups:Rr(e,i)}}if(void 0===e)return;const{channels:i,groups:a,data:l}=e;if("auto"!==t.facet||t.data===l)return{channels:i,groups:a};(a.size>1||1===a.size&&i.fx&&i.fy&&[...a][0][1].size>1)&&F(t.data)?.length===l.length&&Ee(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function Oi(t,e,n,r,o,i,a){if(!e)return;const l=/^\s*both\s*$/i.test(e);a=function(t,e,{line:n=e.line,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h=e.label,labelAnchor:d,labelOffset:p}){return{anchor:t,line:n,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h,labelAnchor:d,labelOffset:p}}(l?r:e,i,a);const{line:s}=a;n!==Ho&&n!==Zo||!s||wt(s)||t.push(xi(function(t){const{anchor:e,line:n}=t;return{anchor:e,facetAnchor:e+"-empty",stroke:!0===n?void 0:n}}(a))),t.push(n(a)),l&&t.push(n({...a,anchor:o,label:null}))}function Ei(t,e,n,r){e&&!wt(e)&&t.push(n(function(t,{stroke:e=(yt(t)?t:void 0),ticks:n=(Si(t)?t:void 0),tickSpacing:r,ariaLabel:o,ariaDescription:i}){return{stroke:e,ticks:n,tickSpacing:r,ariaLabel:o,ariaDescription:i}}(e,r)))}function Si(t){switch(typeof t){case"number":return!0;case"string":return!yt(t)}return ct(t)||"function"==typeof t?.range}function Ci(t,e){const n=`${e}-axis `;return t.some((t=>t.ariaLabel?.startsWith(n)))}function Bi(t,e){for(const n of e)for(const e in n.channels)if(n.channels[e].scale===t)return!0;return!1}function Ti(t){const e=t.domain();let n=t(e[0]),r=t(e[e.length-1]);return r<n&&([n,r]=[r,n]),[n,r+t.bandwidth()]}const Ni=new Map([["basis",e.curveBasis],["basis-closed",e.curveBasisClosed],["basis-open",e.curveBasisOpen],["bundle",e.curveBundle],["bump-x",e.curveBumpX],["bump-y",e.curveBumpY],["cardinal",e.curveCardinal],["cardinal-closed",e.curveCardinalClosed],["cardinal-open",e.curveCardinalOpen],["catmull-rom",e.curveCatmullRom],["catmull-rom-closed",e.curveCatmullRomClosed],["catmull-rom-open",e.curveCatmullRomOpen],["linear",e.curveLinear],["linear-closed",e.curveLinearClosed],["monotone-x",e.curveMonotoneX],["monotone-y",e.curveMonotoneY],["natural",e.curveNatural],["step",e.curveStep],["step-after",e.curveStepAfter],["step-before",e.curveStepBefore]]);function Ii(t=e.curveLinear,n){if("function"==typeof t)return t;const r=Ni.get(`${t}`.toLowerCase());if(!r)throw new Error(`unknown curve: ${t}`);if(void 0!==n){if("beta"in r)return r.beta(n);if("tension"in r)return r.tension(n);if("alpha"in r)return r.alpha(n)}return r}function Pi(t=Wi,e){return"function"!=typeof t&&"auto"===`${t}`.toLowerCase()?Wi:Ii(t,e)}function Wi(t){return e.curveLinear(t)}function ji(t={y:"count"},e={}){[t,e]=Xi(t,e);const{x:n,y:r}=e;return Gi(Ui(n,e,M),null,null,r,t,Xr(e))}function Di(t={x:"count"},e={}){[t,e]=Xi(t,e);const{x:n,y:r}=e;return Gi(null,Ui(r,e,M),n,null,t,Ur(e))}function qi(t={fill:"count"},e={}){[t,e]=Xi(t,e);const{x:n,y:r}=function(t){let{x:e,y:n}=t;return e=Ui(e,t),n=Ui(n,t),[e.value,n.value]=Z(e.value,n.value),{x:e,y:n}}(e);return Gi(n,r,null,null,t,Xr(Ur(e)))}function Fi(t,e,n={}){return null==n?.interval?n:t({[e]:void 0===n?.reduce?he:n.reduce,filter:null},n)}function Yi(t){return Fi(ji,"y",t)}function _i(t){return Fi(Di,"x",t)}function Gi(t,e,n,r,{data:o=fe,filter:i=me,sort:a,reverse:l,...s}={},c={}){t=Hi(t),e=Hi(e),s=function(t,e){return ee(t,e,Zi)}(s,c),o=Ji(o,M),a=null==a?void 0:Zi("sort",a,c),i=null==i?void 0:Qi("filter",i,c),null!=n&&te(s,"x","x1","x2")&&(n=null),null!=r&&te(s,"y","y1","y2")&&(r=null);const[u,f]=rt(t),[h,d]=rt(t),[p,m]=rt(e),[g,y]=rt(e),[v,w]=null!=n?[n,"x"]:null!=r?[r,"y"]:[],[b,k]=rt(v),{x:$,y:L,z:A,fill:R,stroke:z,x1:O,x2:E,y1:S,y2:C,domain:B,cumulative:T,thresholds:N,interval:I,...P}=c,[j,D]=rt(A),[q]=W(R),[F]=W(z),[Y,_]=rt(q),[G,X]=rt(F);return{..."z"in c&&{z:j||A},..."fill"in c&&{fill:Y||R},..."stroke"in c&&{stroke:G||z},...Wt(P,((n,r)=>{const c=x(n,v),u=x(n,A),h=x(n,q),p=x(n,F),g=le(s,{z:u,fill:h,stroke:p}),w=[],b=[],$=c&&k([]),M=u&&D([]),L=h&&_([]),R=p&&X([]),z=t&&f([]),O=t&&d([]),E=e&&m([]),S=e&&y([]),C=(B=t?.(n),T=e?.(n),B&&T?function*(t){const e=B.bin(t);for(const[t,[n,r]]of B.entries()){const o=T.bin(e[t]);for(const[t,[e,i]]of T.entries())yield[o[t],{x1:n,y1:e,x2:r,y2:i}]}}:B?function*(t){const e=B.bin(t);for(const[t,[n,r]]of B.entries())yield[e[t],{x1:n,x2:r}]}:function*(t){const e=T.bin(t);for(const[t,[n,r]]of T.entries())yield[e[t],{y1:n,y2:r}]});var B,T;let N=0;for(const t of s)t.initialize(n);a&&a.initialize(n),i&&i.initialize(n);for(const t of r){const e=[];for(const e of s)e.scope("facet",t);a&&a.scope("facet",t),i&&i.scope("facet",t);for(const[r,l]of oe(t,g))for(const[t,f]of oe(l,c))for(const[l,d]of C(f))if(!i||i.reduce(l,d)){e.push(N++),b.push(o.reduceIndex(l,n,d)),c&&$.push(t),u&&M.push(g===u?r:u[l[0]]),h&&L.push(g===h?r:h[l[0]]),p&&R.push(g===p?r:p[l[0]]),z&&(z.push(d.x1),O.push(d.x2)),E&&(E.push(d.y1),S.push(d.y2));for(const t of s)t.reduce(l,d);a&&a.reduce(l)}w.push(e)}return se(w,a,l),{data:b,facets:w}})),...!te(s,"x")&&(u?{x1:u,x2:h,x:it(u,h)}:{x:$,x1:O,x2:E}),...!te(s,"y")&&(p?{y1:p,y2:g,y:it(p,g)}:{y:L,y1:S,y2:C}),...b&&{[w]:b},...Object.fromEntries(s.map((({name:t,output:e})=>[t,e])))}}function Xi({cumulative:t,domain:e,thresholds:n,interval:r,...o},i){return[o,{cumulative:t,domain:e,thresholds:n,interval:r,...i}]}function Ui(t,{cumulative:e,domain:n,thresholds:r,interval:o},i){return void 0===(t={...st(t)}).domain&&(t.domain=n),void 0===t.cumulative&&(t.cumulative=e),void 0===t.thresholds&&(t.thresholds=r),void 0===t.interval&&(t.interval=o),void 0===t.value&&(t.value=i),t.thresholds=Vi(t.thresholds,t.interval),t}function Hi(t){if(null==t)return;const{value:n,cumulative:r,domain:o=e.extent,thresholds:i}=t,a=t=>{let a,l=x(t,n);if(ht(l)||(function(t){return ea(t)&&"function"==typeof t&&t()instanceof Date}(s=i)||ct(s)&&ht(s))){l=Y(l,P,Float64Array);let[t,n]="function"==typeof o?o(l):o,r="function"!=typeof i||ea(i)?i:i(l,t,n);"number"==typeof r&&(r=e.utcTickInterval(t,n,r)),ea(r)&&(o===e.extent&&(t=r.floor(t),n=r.offset(r.floor(n))),r=r.range(t,r.offset(n))),a=r}else{l=T(l);let[t,n]="function"==typeof o?o(l):o,r="function"!=typeof i||ea(i)?i:i(l,t,n);if("number"==typeof r)if(o===e.extent){let o=e.tickIncrement(t,n,r);if(isFinite(o))if(o>0){let e=Math.round(t/o),i=Math.round(n/o);e*o<=t||--e,i*o>n||++i;let a=i-e+1;r=new Float64Array(a);for(let t=0;t<a;++t)r[t]=(e+t)*o}else if(o<0){o=-o;let e=Math.round(t*o),i=Math.round(n*o);e/o<=t||--e,i/o>n||++i;let a=i-e+1;r=new Float64Array(a);for(let t=0;t<a;++t)r[t]=(e+t)/o}else r=[t];else r=[t]}else r=e.ticks(t,n,r);else ea(r)&&(o===e.extent&&(t=r.floor(t),n=r.offset(r.floor(n))),r=r.range(t,r.offset(n)));a=r}var s;const c=[];if(1===a.length)c.push([a[0],a[0]]);else for(let t=1;t<a.length;++t)c.push([a[t-1],a[t]]);return c.bin=(r<0?oa:r>0?ra:na)(c,a,l),c};return a.label=ot(n),a}function Vi(t,n,r=ta){if(void 0===t)return void 0===n?r:lt(n);if("string"==typeof t){switch(t.toLowerCase()){case"freedman-diaconis":return e.thresholdFreedmanDiaconis;case"scott":return e.thresholdScott;case"sturges":return e.thresholdSturges;case"auto":return ta}return g(t)}return t}function Zi(t,e,n){return ne(t,e,n,Qi)}function Qi(t,e,n){return re(t,e,n,Ji)}function Ji(t,e){return ie(t,e,Ki)}function Ki(t){switch(`${t}`.toLowerCase()){case"x":return aa;case"x1":return sa;case"x2":return ca;case"y":return la;case"y1":return ua;case"y2":return fa}throw new Error(`invalid bin reduce: ${t}`)}function ta(t,n,r){return Math.min(200,e.thresholdScott(t,n,r))}function ea(t){return"function"==typeof t?.range}function na(t,n,r){return n=T(n),o=>{const i=t.map((()=>[]));for(const t of o)i[e.bisect(n,r[t])-1]?.push(t);return i}}function ra(t,e,n){const r=na(t,e,n);return t=>{const e=r(t);for(let t=1,n=e.length;t<n;++t){const n=e[t-1],r=e[t];for(const t of n)r.push(t)}return e}}function oa(t,e,n){const r=na(t,e,n);return t=>{const e=r(t);for(let t=e.length-2;t>=0;--t){const n=e[t+1],r=e[t];for(const t of n)r.push(t)}return e}}function ia(t,e){const n=(+t+ +e)/2;return t instanceof Date?new Date(n):n}const aa={reduceIndex:(t,e,{x1:n,x2:r})=>ia(n,r)},la={reduceIndex:(t,e,{y1:n,y2:r})=>ia(n,r)},sa={reduceIndex:(t,e,{x1:n})=>n},ca={reduceIndex:(t,e,{x2:n})=>n},ua={reduceIndex:(t,e,{y1:n})=>n},fa={reduceIndex:(t,e,{y2:n})=>n};function ha(t={}){const{x:e,x1:n,x2:r}=t;return void 0===n&&void 0===r&&void 0===e?{...t,x:M}:t}function da(t={}){const{y:e,y1:n,y2:r}=t;return void 0===n&&void 0===r&&void 0===e?{...t,y:M}:t}function pa(t={},e={}){1===arguments.length&&([t,e]=va(t));const{y1:n,y:r=n,x:o,...i}=e,[a,l,s,c]=xa(r,o,"x",t,i);return{...a,y1:n,y:l,x1:s,x2:c,x:it(s,c)}}function ma(t={},e={}){1===arguments.length&&([t,e]=va(t));const{x1:n,x:r=n,y:o,...i}=e,[a,l,s,c]=xa(r,o,"y",t,i);return{...a,x1:n,x:l,y1:s,y2:c,y:it(s,c)}}function ga({x:t,x1:e,x2:n,...r}={}){return void 0===e&&void 0===n?pa({x:t,...r}):([e,n]=V(t,e,n),{...r,x1:e,x2:n})}function ya({y:t,y1:e,y2:n,...r}={}){return void 0===e&&void 0===n?ma({y:t,...r}):([e,n]=V(t,e,n),{...r,y1:e,y2:n})}function va(t){const{offset:e,order:n,reverse:r,...o}=t;return[{offset:e,order:n,reverse:r},o]}const xa=function(t,n=L,r,{offset:o,order:i,reverse:a},l){const s=Q(l),[c,u]=rt(t),[f,h]=nt(n),[d,p]=nt(n);return o=function(t){if(null==t)return;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return ba;case"center":case"silhouette":return ka;case"wiggle":return $a}throw new Error(`unknown offset: ${t}`)}(o),i=function(t,e,n){if(void 0===t&&e===$a)return Ea;if(null==t)return;if("string"==typeof t){switch(t.toLowerCase()){case"value":case n:return Aa;case"z":return Ra;case"sum":return za;case"appearance":return Oa;case"inside-out":return Ea}return Sa(k(t))}if("function"==typeof t)return Sa(t);if(Array.isArray(t))return r=t,(t,e,n,o)=>Ca(o,r);var r;throw new Error(`invalid order: ${t}`)}(i,o,r),[Wt(l,((r,l)=>{const c=null==t?void 0:u(x(r,t)),f=x(r,n,Float64Array),d=x(r,s),m=i&&i(r,c,f,d),g=r.length,y=h(new Float64Array(g)),v=p(new Float64Array(g)),w=[];for(const t of l){const n=c?Array.from(e.group(t,(t=>c[t])).values()):[t];m&&Ba(n,m);for(const t of n){let e=0,n=0;a&&t.reverse();for(const r of t){const t=f[r];t<0?e=v[r]=(y[r]=e)+t:t>0?n=v[r]=(y[r]=n)+t:v[r]=y[r]=n}}w.push(n)}return o&&o(w,y,v,d),{data:r,facets:l}})),c,f,d]};function wa(t,e){let n=0,r=0;for(const o of t){const t=e[o];t<n&&(n=t),t>r&&(r=t)}return[n,r]}function ba(t,e,n){for(const r of t)for(const t of r){const[r,o]=wa(t,n);for(const i of t){const t=1/(o-r||1);e[i]=t*(e[i]-r),n[i]=t*(n[i]-r)}}}function ka(t,e,n){for(const r of t){for(const t of r){const[r,o]=wa(t,n);for(const i of t){const t=(o+r)/2;e[i]-=t,n[i]-=t}}Ma(r,e,n)}La(t,e,n)}function $a(t,n,r,o){for(const i of t){const t=new e.InternMap;let a=0;for(const l of i){let i=-1;const s=l.map((t=>Math.abs(r[t]-n[t]))),c=l.map((e=>{i=o?o[e]:++i;const a=r[e]-n[e],l=t.has(i)?a-t.get(i):0;return t.set(i,a),l})),u=[0,...e.cumsum(c)];for(const t of l)n[t]+=a,r[t]+=a;const f=e.sum(s);f&&(a-=e.sum(s,((t,e)=>(c[e]/2+u[e])*t))/f)}Ma(i,n,r)}La(t,n,r)}function Ma(t,n,r){const o=e.min(t,(t=>e.min(t,(t=>n[t]))));for(const e of t)for(const t of e)n[t]-=o,r[t]-=o}function La(t,n,r){const o=t.length;if(1===o)return;const i=t.map((t=>t.flat())),a=i.map((t=>(e.min(t,(t=>n[t]))+e.max(t,(t=>r[t])))/2)),l=e.min(a);for(let t=0;t<o;t++){const e=l-a[t];for(const o of i[t])n[o]+=e,r[o]+=e}}function Aa(t,e,n){return n}function Ra(t,e,n,r){return r}function za(t,n,r,o){return Ca(o,e.groupSort(J(t),(t=>e.sum(t,(t=>r[t]))),(t=>o[t])))}function Oa(t,n,r,o){return Ca(o,e.groupSort(J(t),(t=>n[e.greatest(t,(t=>r[t]))]),(t=>o[t])))}function Ea(t,n,r,o){const i=J(t),a=e.groupSort(i,(t=>n[e.greatest(t,(t=>r[t]))]),(t=>o[t])),l=e.rollup(i,(t=>e.sum(t,(t=>r[t]))),(t=>o[t])),s=[],c=[];let u=0;for(const t of a)u<0?(u+=l.get(t),s.push(t)):(u-=l.get(t),c.push(t));return Ca(o,c.reverse().concat(s))}function Sa(t){return e=>x(e,t)}function Ca(t,n){if(!t)throw new Error("missing channel: z");return n=new e.InternMap(n.map(((t,e)=>[t,e]))),t.map((t=>n.get(t)))}function Ba(t,e){for(const n of t)n.sort(((t,n)=>r(e[t],e[n])))}const Ta={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Na extends Yr{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,z:a,curve:l,tension:s}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0},z:{value:Q(e),optional:!0}},e,Ta),this.z=a,this.curve=Ii(l,s)}filter(t){return t}render(t,n,r,o,i){const{x1:a,y1:l,x2:s=a,y2:c=l}=r;return Ye("svg:g",i).call(pr,this,o,i).call(vr,this,n,0,0).call((n=>n.selectAll().data(dr(t,[a,l,s,c],this,r)).enter().append("path").call(mr,this).call(fr,this,r).attr("d",e.area().curve(this.curve).defined((t=>t>=0)).x0((t=>a[t])).y0((t=>l[t])).x1((t=>s[t])).y1((t=>c[t]))))).node()}}function Ia(t,e){const{y:n=$,...r}=_i(e);return new Na(t,ga(ha({...r,y1:n,y2:void 0})))}function Pa(t,e){const{x:n=$,...r}=Yi(e);return new Na(t,ya(da({...r,x1:n,x2:void 0})))}function Wa(t,{marker:e,markerStart:n=e,markerMid:r=e,markerEnd:o=e}={}){t.markerStart=ja(n),t.markerMid=ja(r),t.markerEnd=ja(o)}function ja(t){if(null==t||!1===t)return null;if(!0===t)return Fa;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return Da;case"dot":return qa;case"circle":case"circle-fill":return Fa;case"circle-stroke":return Ya}throw new Error(`invalid marker: ${t}`)}function Da(t,e){return Ye("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient","auto").attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call((t=>t.append("path").attr("d","M-1.5,-3l3,3l-3,3"))).node()}function qa(t,e){return Ye("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call((t=>t.append("circle").attr("r",2.5))).node()}function Fa(t,e){return Ye("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","white").attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function Ya(t,e){return Ye("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","white").attr("stroke",t).attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}let _a=0;function Ga(t,e,{stroke:n},r){return Ua(t,e,n&&(t=>n[t]),r)}function Xa(t,e,{stroke:n},r){return Ua(t,e,n&&(([t])=>n[t]),r)}function Ua(t,{markerStart:e,markerMid:n,markerEnd:r,stroke:o},i=(()=>o),a){const l=new Map;function s(t){return function(e){const n=i(e);let r=l.get(t);r||l.set(t,r=new Map);let o=r.get(n);if(!o){const e=this.parentNode.insertBefore(t(n,a),this),i="plot-marker-"+ ++_a;e.setAttribute("id",i),r.set(n,o=`url(#${i})`)}return o}}e&&t.attr("marker-start",s(e)),n&&t.attr("marker-mid",s(n)),r&&t.attr("marker-end",s(r))}const Ha={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Va extends Yr{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,curve:a,tension:l}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,Ha),this.curve=Pi(a,l),Wa(this,e)}project(t,e,n){this.curve!==Wi&&super.project(t,e,n)}render(t,n,r,o,i){const{x1:a,y1:l,x2:s=a,y2:c=l}=r,{curve:u}=this;return Ye("svg:g",i).call(pr,this,o,i).call(vr,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(mr,this).attr("d",u===Wi&&i.projection?function(t,n,r,o,i){const a=e.geoPath(t);return n=T(n),r=T(r),o=T(o),i=T(i),t=>a({type:"LineString",coordinates:[[n[t],r[t]],[o[t],i[t]]]})}(i.projection,a,l,s,c):t=>{const n=e.pathRound(),r=u(n);return r.lineStart(),r.point(a[t],l[t]),r.point(s[t],c[t]),r.lineEnd(),n}).call(ur,this,r).call(Ga,this,r,i))).node()}}function Za(t,e={}){let{x:n,x1:r,x2:o,y:i,y1:a,y2:l,...s}=e;return[r,o]=Qa(n,r,o),[a,l]=Qa(i,a,l),new Va(t,{...s,x1:r,x2:o,y1:a,y2:l})}function Qa(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[n]}else if(void 0===n)return[e]}else{if(void 0===e)return void 0===n?[t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const Ja={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class Ka extends Yr{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,bend:a=0,headAngle:l=60,headLength:s=8,inset:c=0,insetStart:u=c,insetEnd:f=c}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,Ja),this.bend=!0===a?22.5:Math.max(-90,Math.min(90,a)),this.headAngle=+l,this.headLength=+s,this.insetStart=+u,this.insetEnd=+f}render(t,e,n,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a,SW:c}=n,{strokeWidth:u,bend:f,headAngle:h,headLength:d,insetStart:p,insetEnd:m}=this,g=c?t=>c[t]:C(void 0===u?1:u),y=f*Gr,v=h*Gr/2,x=d/1.5;return Ye("svg:g",o).call(pr,this,r,o).call(vr,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(mr,this).attr("d",(t=>{let e=i[t],n=a[t],r=l[t],o=s[t];const c=Math.hypot(r-e,o-n);if(c<=p+m)return null;let u=Math.atan2(o-n,r-e);const f=Math.min(x*g(t),c/3),h=Math.hypot(c/Math.tan(y),c)/2;if(p||m)if(h<1e5){const t=Math.sign(y),[i,a]=function([t,e],[n,r],o,i){const a=n-t,l=r-e,s=Math.hypot(a,l),c=i*Math.sqrt(o*o-s*s/4)/s;return[(t+n)/2-l*c,(e+r)/2+a*c]}([e,n],[r,o],h,t);if(p&&([e,n]=tl([i,a,h],[e,n,p],-t*Math.sign(p))),m){const[e,n]=tl([i,a,h],[r,o,m],t*Math.sign(m));u+=Math.atan2(n-a,e-i)-Math.atan2(o-a,r-i),r=e,o=n}}else{const t=r-e,i=o-n,a=Math.hypot(t,i);p&&(e+=t/a*p,n+=i/a*p),m&&(r-=t/a*m,o-=i/a*m)}const d=u+y,w=d+v,b=d-v,k=r-f*Math.cos(w),$=o-f*Math.sin(w),M=r-f*Math.cos(b),L=o-f*Math.sin(b);return`M${e},${n}${h<1e5?`A${h},${h} 0,0,${y>0?1:0} `:"L"}${r},${o}M${k},${$}L${r},${o}L${M},${L}`})).call(ur,this,n))).node()}}function tl([t,e,n],[r,o,i],a){const l=r-t,s=o-e,c=Math.hypot(l,s),u=(l*l+s*s-i*i+n*n)/(2*c),f=a*Math.sqrt(n*n-u*u);return[t+(l*u+s*f)/c,e+(s*u-l*f)/c]}class el extends Yr{constructor(t,e,n={},r){super(t,e,n,r);const{inset:o=0,insetTop:i=o,insetRight:a=o,insetBottom:l=o,insetLeft:s=o,rx:c,ry:u}=n;this.insetTop=z(i),this.insetRight=z(a),this.insetBottom=z(l),this.insetLeft=z(s),this.rx=xr(c,"auto"),this.ry=xr(u,"auto")}render(t,e,n,r,o){const{rx:i,ry:a}=this;return Ye("svg:g",o).call(pr,this,r,o).call(this._transform,this,e).call((o=>o.selectAll().data(t).enter().append("rect").call(mr,this).attr("x",this._x(e,n,r)).attr("width",this._width(e,n,r)).attr("y",this._y(e,n,r)).attr("height",this._height(e,n,r)).call(yr,"rx",i).call(yr,"ry",a).call(ur,this,n))).node()}_x(t,{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e?t=>e[t]+r:n+r}_y(t,{y:e},{marginTop:n}){const{insetTop:r}=this;return e?t=>e[t]+r:n+r}_width({x:t},{x:e},{marginRight:n,marginLeft:r,width:o}){const{insetLeft:i,insetRight:a}=this,l=e&&t?t.bandwidth():o-n-r;return Math.max(0,l-i-a)}_height({y:t},{y:e},{marginTop:n,marginBottom:r,height:o}){const{insetTop:i,insetBottom:a}=this,l=e&&t?t.bandwidth():o-n-r;return Math.max(0,l-i-a)}}const nl={ariaLabel:"bar"};class rl extends el{constructor(t,e={}){const{x1:n,x2:r,y:o}=e;super(t,{x1:{value:n,scale:"x"},x2:{value:r,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},e,nl)}_transform(t,e,{x:n}){t.call(vr,e,{x:n},0,0)}_x({x:t},{x1:e,x2:n},{marginLeft:r}){const{insetLeft:o}=this;return Hn(t)?r+o:t=>Math.min(e[t],n[t])+o}_width({x:t},{x1:e,x2:n},{marginRight:r,marginLeft:o,width:i}){const{insetLeft:a,insetRight:l}=this;return Hn(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(n[t]-e[t])-a-l)}}class ol extends el{constructor(t,e={}){const{x:n,y1:r,y2:o}=e;super(t,{y1:{value:r,scale:"y"},y2:{value:o,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e,nl)}_transform(t,e,{y:n}){t.call(vr,e,{y:n},0,0)}_y({y:t},{y1:e,y2:n},{marginTop:r}){const{insetTop:o}=this;return Hn(t)?r+o:t=>Math.min(e[t],n[t])+o}_height({y:t},{y1:e,y2:n},{marginTop:r,marginBottom:o,height:i}){const{insetTop:a,insetBottom:l}=this;return Hn(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(n[t]-e[t])-a-l)}}function il(t,e={y:$,x2:M}){return new rl(t,ga(to(ha(e))))}function al(t,e={x:$,y2:M}){return new ol(t,ya(eo(da(e))))}const ll={ariaLabel:"cell"};class sl extends el{constructor(t,{x:e,y:n,...r}={}){super(t,{x:{value:e,scale:"x",type:"band",optional:!0},y:{value:n,scale:"y",type:"band",optional:!0}},r,ll)}_transform(t,e){t.call(vr,e,{},0,0)}}function cl(t,e={}){let{x:n,y:r,...o}=e;return[n,r]=Z(n,r),new sl(t,{...o,x:n,y:r})}const ul={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function fl(t){return void 0===t.sort&&void 0===t.reverse?Gt({channel:"r",order:"descending"},t):t}class hl extends Yr{constructor(t,n={}){const{x:r,y:o,r:i,rotate:a,symbol:s=e.symbolCircle,frameAnchor:c}=n,[u,f]=j(a,0),[h,d]=function(t){if(null==t||Nt(t))return[void 0,t];if("string"==typeof t){const e=Tt.get(`${t}`.toLowerCase());if(e)return[void 0,e]}return[t,void 0]}(s),[p,m]=j(i,null==h?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},r:{value:p,scale:"r",filter:l,optional:!0},rotate:{value:u,optional:!0},symbol:{value:h,scale:"auto",optional:!0}},fl(n),ul),this.r=m,this.rotate=f,this.symbol=d,this.frameAnchor=bt(c);const{channels:g}=this,{symbol:y}=g;if(y){const{fill:t,stroke:e}=g;y.hint={fill:t?t.value===y.value?"color":"currentColor":this.fill,stroke:e?e.value===y.value?"color":"currentColor":this.stroke}}}render(t,n,r,o,i){const{x:a,y:l}=n,{x:c,y:u,r:f,rotate:h,symbol:d}=r,{r:p,rotate:m,symbol:g}=this,[y,v]=Mr(this,o),x=this.symbol===e.symbolCircle,w=f?void 0:p*p*Math.PI;return s(p)&&(t=[]),Ye("svg:g",i).call(pr,this,o,i).call(vr,this,{x:c&&a,y:u&&l}).call((n=>n.selectAll().data(t).enter().append(x?"circle":"path").call(mr,this).call(x?t=>{t.attr("cx",c?t=>c[t]:y).attr("cy",u?t=>u[t]:v).attr("r",f?t=>f[t]:p)}:t=>{t.attr("transform",uo`translate(${c?t=>c[t]:y},${u?t=>u[t]:v})${h?t=>` rotate(${h[t]})`:m?` rotate(${m})`:""}`).attr("d",f&&d?t=>{const n=e.pathRound();return d[t].draw(n,f[t]*f[t]*Math.PI),n}:f?t=>{const n=e.pathRound();return g.draw(n,f[t]*f[t]*Math.PI),n}:d?t=>{const n=e.pathRound();return d[t].draw(n,w),n}:(()=>{const t=e.pathRound();return g.draw(t,w),t})())}).call(ur,this,r))).node()}}function dl(t,e={}){let{x:n,y:r,...o}=e;return void 0===e.frameAnchor&&([n,r]=Z(n,r)),new hl(t,{...o,x:n,y:r})}const pl={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class ml extends Yr{constructor(t,e={}){const{x:n,y:r,z:o,curve:i,tension:a}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:Q(e),optional:!0}},e,pl),this.z=o,this.curve=Pi(i,a),Wa(this,e)}filter(t){return t}project(t,e,n){this.curve!==Wi&&super.project(t,e,n)}render(t,n,r,o,i){const{x:a,y:l}=r,{curve:s}=this;return Ye("svg:g",i).call(pr,this,o,i).call(vr,this,n).call((n=>n.selectAll().data(dr(t,[a,l],this,r)).enter().append("path").call(mr,this).call(fr,this,r).call(Xa,this,r,i).attr("d",s===Wi&&i.projection?function(t,n,r){const o=e.geoPath(t);return n=T(n),r=T(r),t=>{let e=[];const i=[e];for(const o of t)-1===o?(e=[],i.push(e)):e.push([n[o],r[o]]);return o({type:"MultiLineString",coordinates:i})}}(i.projection,a,l):e.line().curve(s).defined((t=>t>=0)).x((t=>a[t])).y((t=>l[t]))))).node()}}function gl(t,e={}){let{x:n,y:r,...o}=e;return[n,r]=Z(n,r),new ml(t,{...o,x:n,y:r})}function yl(t,e={}){const{x:n=M,y:r=$,...o}=e;return new ml(t,_i({...o,x:n,y:r}))}function vl(t,e={}){const{x:n=$,y:r=M,...o}=e;return new ml(t,Yi({...o,x:n,y:r}))}const xl={ariaLabel:"rect"};class wl extends Yr{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,inset:a=0,insetTop:l=a,insetRight:s=a,insetBottom:c=a,insetLeft:u=a,rx:f,ry:h}=e;super(t,{x1:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,xl),this.insetTop=z(l),this.insetRight=z(s),this.insetBottom=z(c),this.insetLeft=z(u),this.rx=xr(f,"auto"),this.ry=xr(h,"auto")}render(t,e,n,r,o){const{x:i,y:a}=e,{x1:l,y1:s,x2:c,y2:u}=n,{marginTop:f,marginRight:h,marginBottom:d,marginLeft:p,width:m,height:g}=r,{projection:y}=o,{insetTop:v,insetRight:x,insetBottom:w,insetLeft:b,rx:k,ry:$}=this;return Ye("svg:g",o).call(pr,this,r,o).call(vr,this,{x:l&&c&&i,y:s&&u&&a},0,0).call((e=>e.selectAll().data(t).enter().append("rect").call(mr,this).attr("x",l&&c&&(y||!Hn(i))?t=>Math.min(l[t],c[t])+b:p+b).attr("y",s&&u&&(y||!Hn(a))?t=>Math.min(s[t],u[t])+v:f+v).attr("width",l&&c&&(y||!Hn(i))?t=>Math.max(0,Math.abs(c[t]-l[t])-b-x):m-h-p-x-b).attr("height",s&&u&&(y||!Hn(a))?t=>Math.max(0,Math.abs(s[t]-u[t])-v-w):g-f-d-v-w).call(yr,"rx",k).call(yr,"ry",$).call(ur,this,n))).node()}}function bl(t,e={y:$,interval:1,x2:M}){return new wl(t,ga(Kr(ha(e))))}function kl(t,e={x:$,interval:1,y2:M}){return new wl(t,ya(Jr(da(e))))}function $l(t,e){e=function({x:t,y:e,color:n,size:r,fx:o,fy:i,mark:a}={}){U(t)||(t=Al(t));U(e)||(e=Al(e));U(n)||(n=yt(n)?{color:n}:Al(n));U(r)||(r=Al(r));U(o)&&({value:o}=Al(o));U(i)&&({value:i}=Al(i));null!=a&&(a=`${a}`.toLowerCase());return{x:t,y:e,color:n,size:r,fx:o,fy:i,mark:a}}(e);const{x:n,y:r,color:o,size:i}=e,a=Ll(t,n),l=Ll(t,r),s=Ll(t,o),c=Ll(t,i);let u,f,h,{fx:d,fy:p,x:{value:m,reduce:g,zero:y,...v},y:{value:x,reduce:w,zero:b,...k},color:{value:$,color:M,reduce:L},size:{value:A,reduce:R},mark:z}=e;if(void 0===g&&(g=null==w&&null==m&&null==A&&null!=x?"count":null),void 0===w&&(w=null==g&&null==x&&null==A&&null!=m?"count":null),void 0!==R||null!=A||null!=L||null!=g||null!=w||null!=m&&!ft(a)||null!=x&&!ft(l)||(R="count"),void 0===y&&(y=!!Rl(g)||void 0),void 0===b&&(b=!!Rl(w)||void 0),null==m&&null==x)throw new Error("must specify x or y");if(null!=g&&null==x)throw new Error("reducing x requires y");if(null!=w&&null==m)throw new Error("reducing y requires x");switch(void 0===z&&(z=null!=A||null!=R?"dot":Rl(g)||Rl(w)||null!=L?"bar":null!=m&&null!=x?ft(a)||ft(l)||null==g&&null==w&&!Ml(a)&&!Ml(l)?"dot":"line":null!=m||null!=x?"rule":null),z){case"dot":h=dl,f="stroke";break;case"line":h=a&&l?gl:a?yl:vl,f="stroke",Ol(s)&&(u=null);break;case"area":h=b?Pa:y||l&&Ml(l)?Ia:Pa,f="fill",Ol(s)&&(u=null);break;case"rule":h=a?lo:so,f="stroke";break;case"bar":h=b?zl(g,a)?al:kl:y?zl(w,l)?il:bl:zl(g,a)&&zl(w,l)?cl:zl(g,a)?al:zl(w,l)?il:kl,f="fill";break;default:throw new Error(`invalid mark: ${z}`)}let O,E={fx:d,fy:p,x:a??void 0,y:l??void 0,[f]:s??M,z:u,r:c??void 0},S={[f]:L??void 0,r:R??void 0};if(null!=g&&null!=w)throw new Error("cannot reduce both x and y");return null!=w?(S.y=w,O=ft(a)?Zt:ji):null!=g?(S.x=g,O=ft(l)?Qt:Di):null==L&&null==R||(a&&l?O=ft(a)&&ft(l)?Jt:ft(a)?Di:ft(l)?ji:qi:a?O=ft(a)?Zt:ji:l&&(O=ft(l)?Qt:Di)),O!==qi&&O!==ji||(E.x={value:a,...v}),O!==qi&&O!==Di||(E.y={value:l,...k}),void 0===y&&(y=a&&!(O===qi||O===ji)&&(h===il||h===Ia||h===bl||h===so)),void 0===b&&(b=l&&!(O===qi||O===Di)&&(h===al||h===Pa||h===kl||h===lo)),{fx:d??null,fy:p??null,x:{value:m??null,reduce:g??null,zero:!!y,...v},y:{value:x??null,reduce:w??null,zero:!!b,...k},color:{value:$??null,reduce:L??null,...void 0!==M&&{color:M}},size:{value:A??null,reduce:R??null},mark:z,markImpl:h,markOptions:E,transformImpl:O,transformOptions:S,colorMode:f}}function Ml(t){let n,r;for(const o of t){if(null==o)continue;if(void 0===n){n=o;continue}const t=Math.sign(e.ascending(n,o));if(t){if(void 0!==r&&t!==r)return!1;n=o,r=t}}return!0}function Ll(t,e){const n=x(t,e.value);return n&&(n.label=ot(e.value)),n}function Al(t){return function(t){if(null==t)return!1;if("function"==typeof t.reduceIndex)return!0;if("function"==typeof t.reduce&&G(t))return!0;if(/^p\d{2}$/i.test(t))return!0;switch(`${t}`.toLowerCase()){case"first":case"last":case"count":case"distinct":case"sum":case"proportion":case"proportion-facet":case"deviation":case"min":case"min-index":case"max":case"max-index":case"mean":case"median":case"variance":case"mode":return!0}return!1}(t)?{reduce:t}:{value:t}}function Rl(t){return/^(?:distinct|count|sum|proportion)$/i.test(t)}function zl(t,e){return!(null!=t&&!function(t){return/^(?:first|last|mode)$/i.test(t)}(t)||!e)&&ft(e)}function Ol(t){return!!t&&new e.InternSet(t).size>t.length>>1}function El(t,e={}){return Bl(Object.fromEntries(["x","x1","x2"].filter((t=>null!=e[t])).map((e=>[e,t]))),e)}function Sl(t,e={}){return Bl(Object.fromEntries(["y","y1","y2"].filter((t=>null!=e[t])).map((e=>[e,t]))),e)}function Cl(t={},n={}){const r=Q(n),o=Object.entries(t).map((([t,e])=>{const r=et(t,n);if(null==r)throw new Error(`missing channel: ${t}`);const[o,i]=nt(r);return{key:t,input:r,output:o,setOutput:i,map:Tl(e)}}));return{...Wt(n,((t,n)=>{const i=x(t,r),a=o.map((({input:e})=>x(t,e))),l=o.map((({setOutput:e})=>e(new Array(t.length))));for(const t of n)for(const n of i?e.group(t,(t=>i[t])).values():[t])o.forEach((({map:t},e)=>t.mapIndex(n,a[e],l[e])));return{data:t,facets:n}})),...Object.fromEntries(o.map((({key:t,output:e})=>[t,e])))}}const Bl=Cl;function Tl(t){if(null==t)throw new Error("missing map");if("function"==typeof t.mapIndex)return t;if("function"==typeof t.map&&G(t))return function(t){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:t.map.bind(t)}}(t);if("function"==typeof t)return Il(t);switch(`${t}`.toLowerCase()){case"cumsum":return Pl;case"rank":return Il(e.rank);case"quantile":return Il(Nl)}throw new Error(`invalid map: ${t}`)}function Nl(t){const n=e.count(t)-1;return e.rank(t).map((t=>t/n))}function Il(t){return{mapIndex(e,n,r){const o=t(K(n,e));if(o.length!==e.length)throw new Error("map function returned a mismatched length");for(let t=0,n=e.length;t<n;++t)r[e[t]]=o[t]}}}const Pl={mapIndex(t,e,n){let r=0;for(const o of t)n[o]=r+=e[o]}},Wl={ariaLabel:"tick",fill:null,stroke:"currentColor"};class jl extends Yr{constructor(t,e,n){super(t,e,n,Wl)}render(t,e,n,r,o){return Ye("svg:g",o).call(pr,this,r,o).call(this._transform,this,e).call((o=>o.selectAll().data(t).enter().append("line").call(mr,this).attr("x1",this._x1(e,n,r)).attr("x2",this._x2(e,n,r)).attr("y1",this._y1(e,n,r)).attr("y2",this._y2(e,n,r)).call(ur,this,n))).node()}}class Dl extends jl{constructor(t,e={}){const{x:n,y:r,inset:o=0,insetTop:i=o,insetBottom:a=o}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y",type:"band",optional:!0}},e),this.insetTop=z(i),this.insetBottom=z(a)}_transform(t,e,{x:n}){t.call(vr,e,{x:n},or,0)}_x1(t,{x:e}){return t=>e[t]}_x2(t,{x:e}){return t=>e[t]}_y1({y:t},{y:e},{marginTop:n}){const{insetTop:r}=this;return e&&t?t=>e[t]+r:n+r}_y2({y:t},{y:e},{height:n,marginBottom:r}){const{insetBottom:o}=this;return e&&t?n=>e[n]+t.bandwidth()-o:n-r-o}}class ql extends jl{constructor(t,e={}){const{x:n,y:r,inset:o=0,insetRight:i=o,insetLeft:a=o}=e;super(t,{y:{value:r,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e),this.insetRight=z(i),this.insetLeft=z(a)}_transform(t,e,{y:n}){t.call(vr,e,{y:n},0,or)}_x1({x:t},{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e&&t?t=>e[t]+r:n+r}_x2({x:t},{x:e},{width:n,marginRight:r}){const{insetRight:o}=this;return e&&t?n=>e[n]+t.bandwidth()-o:n-r-o}_y1(t,{y:e}){return t=>e[t]}_y2(t,{y:e}){return t=>e[t]}}function Fl(t,e={}){const{x:n=M,...r}=e;return new Dl(t,{...r,x:n})}function Yl(t,e={}){const{y:n=M,...r}=e;return new ql(t,{...r,y:n})}function _l(t){const e=Gl(t),n=Xl(t);return t.map((t=>t<e||t>n?t:NaN))}function Gl(t){const n=2.5*Ul(t)-1.5*Hl(t);return e.min(t,(t=>t>=n?t:NaN))}function Xl(t){const n=2.5*Hl(t)-1.5*Ul(t);return e.max(t,(t=>t<=n?t:NaN))}function Ul(t){return e.quantile(t,.25)}function Hl(t){return e.quantile(t,.75)}const Vl={ariaLabel:"raster",stroke:null,pixelSize:1};function Zl(t,e){const n=+t;if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}function Ql(t,e){const n=Math.floor(t);if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}class Jl extends Yr{constructor(t,e,n={},r){let{width:o,height:i,x:a,y:l,x1:s=(null==a?0:void 0),y1:c=(null==l?0:void 0),x2:u=(null==a?o:void 0),y2:f=(null==l?i:void 0),pixelSize:h=r.pixelSize,blur:d=0,interpolate:p}=n;if(null!=o&&(o=Ql(o,"width")),null!=i&&(i=Ql(i,"height")),null!=s&&(s=Zl(s,"x1")),null!=c&&(c=Zl(c,"y1")),null!=u&&(u=Zl(u,"x2")),null!=f&&(f=Zl(f,"y2")),null==a&&(null==s||null==u))throw new Error("missing x");if(null==l&&(null==c||null==f))throw new Error("missing y");null!=t&&null!=o&&null!=i&&(void 0===a&&null!=s&&null!=u&&(a=function(t,e,n){return{transform(r){const o=r.length,i=new Float64Array(o),a=(e-t)/n,l=t+a/2;for(let t=0;t<o;++t)i[t]=t%n*a+l;return i}}}(s,u,o)),void 0===l&&null!=c&&null!=f&&(l=function(t,e,n,r){return{transform(o){const i=o.length,a=new Float64Array(i),l=(e-t)/r,s=t+l/2;for(let t=0;t<i;++t)a[t]=Math.floor(t/n)%r*l+s;return a}}}(c,f,o,i))),super(t,{x:{value:a,scale:"x",optional:!0},y:{value:l,scale:"y",optional:!0},x1:{value:null==s?null:[s],scale:"x",optional:!0,filter:null},y1:{value:null==c?null:[c],scale:"y",optional:!0,filter:null},x2:{value:null==u?null:[u],scale:"x",optional:!0,filter:null},y2:{value:null==f?null:[f],scale:"y",optional:!0,filter:null},...e},n,r),this.width=o,this.height=i,this.pixelSize=Zl(h,"pixelSize"),this.blur=Zl(d,"blur"),this.interpolate=null==a||null==l?null:function(t){if("function"==typeof t)return t;if(null==t)return os;switch(`${t}`.toLowerCase()){case"none":return os;case"nearest":return as;case"barycentric":return is();case"random-walk":return ls()}throw new Error(`invalid interpolate: ${t}`)}(p)}}class Kl extends Jl{constructor(t,e={}){const{imageRendering:n}=e;if(null==t){const{fill:t,fillOpacity:n}=e;void 0!==j(n)[0]&&(e=rs("fillOpacity",e)),void 0!==W(t)[0]&&(e=rs("fill",e))}super(t,void 0,e,Vl),this.imageRendering=xr(n,"auto")}scale(t,{color:e,...n},r){return super.scale(t,n,r)}render(t,n,r,o,i){const a=n[r.channels.fill?.scale]??(t=>t),{x:l,y:s}=r,{document:c}=i,[u,f,h,d]=es(r,o,i),p=h-u,m=d-f,{pixelSize:g,width:y=Math.round(Math.abs(p)/g),height:v=Math.round(Math.abs(m)/g)}=this,x=y*v;let{fill:w,fillOpacity:b}=r,k=0;if(this.interpolate){const e=y/p,n=v/m,r=Y(l,(t=>(t-u)*e),Float64Array),o=Y(s,(t=>(t-f)*n),Float64Array);w&&(w=this.interpolate(t,y,v,r,o,w)),b&&(b=this.interpolate(t,y,v,r,o,b))}else null==this.data&&t&&(k=t.fi*x);const $=c.createElement("canvas");$.width=y,$.height=v;const M=$.getContext("2d"),L=M.createImageData(y,v),A=L.data;let{r:R,g:z,b:O}=e.rgb(this.fill)??{r:0,g:0,b:0},E=255*(this.fillOpacity??1);for(let t=0;t<x;++t){const n=t<<2;if(w){const r=a(w[t+k]);if(null==r){A[n+3]=0;continue}({r:R,g:z,b:O}=e.rgb(r))}b&&(E=255*b[t+k]),A[n+0]=R,A[n+1]=z,A[n+2]=O,A[n+3]=E}return this.blur>0&&e.blurImage(L,this.blur),M.putImageData(L,0,0),Ye("svg:g",i).call(pr,this,o,i).call(vr,this,n).call((t=>t.append("image").attr("transform",`translate(${u},${f}) scale(${Math.sign(h-u)},${Math.sign(d-f)})`).attr("width",Math.abs(p)).attr("height",Math.abs(m)).attr("preserveAspectRatio","none").call(yr,"image-rendering",this.imageRendering).call(mr,this).attr("xlink:href",$.toDataURL()))).node()}}function ts(t,e,n){arguments.length<3&&(n=e,e=null);let{x:r,y:o,[t]:i,...a}=n;return void 0===r&&void 0===o&&function(t){if(!ct(t))return!1;for(const e of t)if(null!=e)return"object"==typeof e&&"0"in e&&"1"in e}(e)&&(r=O,o=E,void 0===i&&(i=S)),[e,{...a,x:r,y:o,[t]:i}]}function es({x1:t,y1:e,x2:n,y2:r},o,{projection:i}){const{width:a,height:l,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}=o;return[t&&null==i?t[0]:f,e&&null==i?e[0]:s,n&&null==i?n[0]:a-c,r&&null==i?r[0]:l-u]}function ns({x1:t,y1:e,x2:n,y2:r},o,i,a){const l={};return t&&(l.x1=t),e&&(l.y1=e),n&&(l.x2=n),r&&(l.y2=r),es(be(l,o),i,a)}function rs(t,e={}){const{[t]:n}=e;if("function"!=typeof n)throw new Error(`invalid ${t}: not a function`);return jt({...e,[t]:void 0},(function(r,o,i,a,l,s){const{x:c,y:u}=a;if(!c)throw new Error("missing scale: x");if(!u)throw new Error("missing scale: y");const[f,h,d,p]=ns(i,a,l,s),m=d-f,g=p-h,{pixelSize:y}=this,{width:v=Math.round(Math.abs(m)/y),height:x=Math.round(Math.abs(g)/y)}=e,w=new Array(v*x*(o?o.length:1)),b=m/v,k=g/x;let $=0;for(const t of o??[void 0])for(let e=.5;e<x;++e)for(let r=.5;r<v;++r,++$)w[$]=n(c.invert(f+r*b),u.invert(h+e*k),t);return{data:w,facets:o,channels:{[t]:{value:w,scale:"auto"}}}}))}function os(t,e,n,r,o,i){const a=new Array(e*n);for(const l of t)r[l]<0||r[l]>=e||o[l]<0||o[l]>=n||(a[Math.floor(o[l])*e+Math.floor(r[l])]=i[l]);return a}function is({random:t=e.randomLcg(42)}={}){return(n,r,o,i,a,l)=>{const s=n.length,c=r>>2,u=(o>>2)-1,f=s+2*c+2*u,h=new Float64Array(2*f);for(let t=0;t<s;++t)h[2*t]=i[n[t]],h[2*t+1]=a[n[t]];let d=s;const p=(t,e)=>(h[2*d]=t,h[2*d+1]=e,d++);for(let t=0;t<=c;++t)p(t/c*r,0),p(t/c*r,o);for(let t=0;t<u;++t)p(r,t/u*o),p(0,t/u*o);l=K(l,n);const m=new e.Delaunay(h.subarray(0,2*s));for(let t,e=s;e<f;++e)l[e]=l[t=m.find(h[2*e],h[2*e+1],t)];const{points:g,triangles:y}=new e.Delaunay(h),v=new l.constructor(r*o),x=function(t,e){return mt(t)||ht(t)?ss:function(t){return(e,n,r,o,i,a,l,s)=>{const c=t(l,s);return c<n?e:c<n+o?r:i}}(e)}(l,t);for(let t=0;t<y.length;t+=3){const e=y[t],n=y[t+1],i=y[t+2],a=g[2*e],s=g[2*n],c=g[2*i],u=g[2*e+1],f=g[2*n+1],h=g[2*i+1],d=Math.min(a,s,c),p=Math.max(a,s,c),m=Math.min(u,f,h),w=Math.max(u,f,h),b=(f-h)*(a-c)+(u-h)*(c-s);if(!b)continue;const k=l[e],$=l[n],M=l[i];for(let t=Math.floor(d);t<p;++t)for(let e=Math.floor(m);e<w;++e){if(t<0||t>=r||e<0||e>=o)continue;const n=t+.5,i=e+.5,l=((f-h)*(n-c)+(i-h)*(c-s))/b;if(l<0)continue;const d=((h-u)*(n-c)+(i-h)*(a-c))/b;if(d<0)continue;const p=1-l-d;p<0||(v[t+r*e]=x(k,l,$,d,M,p,t,e))}}return v}}function as(t,n,r,o,i,a){const l=new a.constructor(n*r),s=e.Delaunay.from(t,(t=>o[t]),(t=>i[t]));let c,u;for(let e=.5,o=0;e<r;++e){u=c;for(let r=.5;r<n;++r,++o)u=s.find(r,e,u),.5===r&&(c=u),l[o]=a[t[u]]}return l}function ls({random:t=e.randomLcg(42),minDistance:n=.5,maxSteps:r=2}={}){return(o,i,a,l,s,c)=>{const u=new c.constructor(i*a),f=e.Delaunay.from(o,(t=>l[t]),(t=>s[t]));let h,d,p;for(let e=.5,m=0;e<a;++e){d=h;for(let a=.5;a<i;++a,++m){let i,g=a,y=e;p=d=f.find(g,y,d),.5===a&&(h=d);let v=0;for(;(i=Math.hypot(l[o[p]]-g,s[o[p]]-y))>n&&v<r;){const n=2*t(a,e,v)*Math.PI;g+=Math.cos(n)*i,y+=Math.sin(n)*i,p=f.find(g,y,p),++v}u[m]=c[o[p]]}}return u}}function ss(t,e,n,r,o,i){return e*t+r*n+i*o}const cs={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2};class us extends Jl{constructor(t,{smooth:n=!0,value:r,...o}={}){const i=lr({},o,cs);if(void 0===r)for(const t in i)if(null!=i[t].value){if(void 0!==r)throw new Error("ambiguous contour value");r=o[t],o[t]="value"}if(null!=r){const t={transform:t=>t.map((t=>t.value)),label:ot(r)};for(const e in i)"value"===o[e]&&(o[e]=t)}if(null==t){if(null==r)throw new Error("missing contour value");o=rs("value",{value:r,...o}),r=null}else{let{interpolate:t}=o;void 0===r&&(r=M),void 0===t&&(o.interpolate="nearest")}super(t,{value:{value:r,optional:!0}},function({thresholds:t,interval:n,...r}){return t=Vi(t,n,e.thresholdSturges),jt(r,(function(n,r,o,i,a,l){const[s,c,u,f]=ns(o,i,a,l),h=u-s,d=f-c,{pixelSize:p,width:m=Math.round(Math.abs(h)/p),height:g=Math.round(Math.abs(d)/p)}=this,y=m/h,v=g/d,x=o.value.value,w=[];if(this.interpolate){const{x:t,y:e}=qe(o,i,l),n=Y(t,(t=>(t-s)*y),Float64Array),a=Y(e,(t=>(t-c)*v),Float64Array),u=[o.x,o.y,o.value],f=[n,a,x];for(const t of r){const e=this.filter(t,u,f);w.push(this.interpolate(e,m,g,n,a,x))}}else if(r){const t=m*g,e=r.length;for(let n=0;n<e;++n)w.push(x.slice(n*t,n*t+t))}else w.push(x);if(this.blur>0)for(const t of w)e.blur2({data:t,width:m,height:g},this.blur);const b=function(t,n,r,o){if("function"==typeof t?.range)return t.range(t.floor(r),o);"function"==typeof t&&(t=t(n,r,o));if("number"!=typeof t)return F(t);const i=e.ticks(...e.nice(r,o,t),t);for(;i[i.length-1]>=o;)i.pop();for(;i[1]<r;)i.shift();return i}(t,x,...function(t){return[e.min(t,(t=>e.min(t,fs))),e.max(t,(t=>e.max(t,fs)))]}(w));if(null===b)throw new Error(`unsupported thresholds: ${t}`);const{contour:k}=e.contours().size([m,g]).smooth(this.smooth),$=[],M=[];for(const t of w)M.push(e.range($.length,$.push(...Y(b,(e=>k(t,e))))));for(const{coordinates:t}of $)for(const e of t)for(const t of e)for(const e of t)e[0]=e[0]/y+s,e[1]=e[1]/v+c;return{data:$,facets:M,channels:we(this.contourChannels,$)}}))}(o),cs);const a={geometry:{value:M}};for(const t in this.channels){const e=this.channels[t],{scale:n}=e;"x"!==n&&"y"!==n&&"value"!==t&&(a[t]=e,delete this.channels[t])}this.contourChannels=a,this.smooth=!!n}filter(t,{x:e,y:n,value:r,...o},i){return super.filter(t,o,i)}render(t,n,r,o,i){const{geometry:a}=r,l=e.geoPath();return Ye("svg:g",i).call(pr,this,o,i).call(vr,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(mr,this).attr("d",(t=>l(a[t]))).call(ur,this,r)})).node()}}function fs(t){return isFinite(t)?t:NaN}const hs={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},ds={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},ps={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},ms={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},gs={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class ys extends Yr{constructor(t,e={}){const{x:n,y:r,z:o,curve:i,tension:a}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},e,hs),this.curve=Ii(i,a),Wa(this,e)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,{curve:f}=this,[h,d]=Mr(this,o),p=s?t=>s[t]:C(h),m=c?t=>c[t]:C(d),g=this;function y(t){let n=-1;const o=[],a={};for(const t in r)a[t]=[];const l=[],s=[],c=[],u=[];function h(e,i){e=t[e],i=t[i],o.push(++n),l[n]=p(e),c[n]=m(e),s[n]=p(i),u[n]=m(i);for(const t in r)a[t].push(r[t][i])}const{halfedges:d,hull:y,triangles:v}=e.Delaunay.from(t,p,m);for(let t=0;t<d.length;++t){const e=d[t];e>t&&h(v[t],v[e])}for(let t=0;t<y.length;++t)h(y[t],y[(t+1)%y.length]);e.select(this).selectAll().data(o).join("path").call(mr,g).attr("d",(t=>{const n=e.pathRound(),r=f(n);return r.lineStart(),r.point(l[t],c[t]),r.point(s[t],u[t]),r.lineEnd(),n})).call(ur,g,a).call(Ga,g,a,i)}return Ye("svg:g",i).call(pr,this,o,i).call(vr,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(y):e=>e.datum(t).each(y)).node()}}class vs extends Yr{constructor(t,e={},n,r=(({z:t})=>t)){const{x:o,y:i}=e;super(t,{x:{value:o,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:r(e),optional:!0}},e,n)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,[f,h]=Mr(this,o),d=s?t=>s[t]:C(f),p=c?t=>c[t]:C(h),m=this;function g(t){const n=e.Delaunay.from(t,d,p);e.select(this).append("path").datum(t[0]).call(mr,m).attr("d",m._render(n,o)).call(ur,m,r)}return Ye("svg:g",i).call(pr,this,o,i).call(vr,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(g):e=>e.datum(t).each(g)).node()}}class xs extends vs{constructor(t,e={}){super(t,e,ds),this.fill="none"}_render(t){return t.render()}}class ws extends vs{constructor(t,e={}){super(t,e,ps,Q)}_render(t){return t.renderHull()}}class bs extends Yr{constructor(t,e={}){const{x:n,y:r,z:o}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},e,ms)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,[f,h]=Mr(this,o),d=s?t=>s[t]:C(f),p=c?t=>c[t]:C(h),m=this;function g(t){const n=$s(e.Delaunay.from(t,d,p),o);e.select(this).selectAll().data(t).enter().append("path").call(mr,m).attr("d",((t,e)=>n.renderCell(e))).call(ur,m,r)}return Ye("svg:g",i).call(pr,this,o,i).call(vr,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(g):e=>e.datum(t).each(g)).node()}}class ks extends vs{constructor(t,e){super(t,e,gs),this.fill="none"}_render(t,e){return $s(t,e).render()}}function $s(t,e){const{width:n,height:r,marginTop:o,marginRight:i,marginBottom:a,marginLeft:l}=e;return t.voronoi([l,o,n-i,r-a])}function Ms(t,e,{x:n,y:r,...o}={}){return[n,r]=Z(n,r),new t(e,{...o,x:n,y:r})}const Ls={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class As extends Yr{constructor(t,{x:n,y:r,z:o,weight:i,fill:a,stroke:l,...s}={}){const c=zs(a)&&(a="currentColor",!0),u=zs(l)&&(l="currentColor",!0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:Q({z:o,fill:a,stroke:l}),optional:!0},weight:{value:i,optional:!0}},function(t,n,r){const o=100;let{bandwidth:i,thresholds:a}=t;return i=void 0===i?20:+i,a=void 0===a?20:"function"==typeof a?.[Symbol.iterator]?T(a):+a,jt(t,(function(t,l,s,c,u,f){const h=s.weight?T(s.weight.value):null,d=s.z?.value,{z:p}=this,[m,g]=Mr(this,u),{width:v,height:x}=u,{x:w,y:b}=qe(s,c,f),k=Object.fromEntries(Object.entries(s).filter((([t])=>!Rs.has(t))).map((([t,e])=>[t,{...e,value:[]}]))),$=n&&[],M=r&&[],L=e.contourDensity().x(w?t=>w[t]:m).y(b?t=>b[t]:g).weight(h?t=>h[t]:1).size([v,x]).bandwidth(i),A=[];for(const t of l){const e=[];A.push(e);for(const n of d?hr(t,d,p):[t]){const t=L.contours(n);e.push([n,t])}}let R=a;if(!(R instanceof y)){let t=0;for(const e of A)for(const[,n]of e){const e=n.max;e>t&&(t=e)}R=Float64Array.from({length:a-1},((e,n)=>t*o*(n+1)/a))}const z=[],O=[];for(const t of A){const e=[];z.push(e);for(const[n,r]of t)for(const t of R){e.push(O.length),O.push(r(t/o)),$&&$.push(t),M&&M.push(t);for(const t in k)k[t].value.push(s[t].value[n[0]])}}return $&&$.push(0),M&&M.push(0),{data:t,facets:z,channels:{...k,...$&&{fill:{value:$,scale:"color"}},...M&&{stroke:{value:M,scale:"color"}},contours:{value:O}}}}))}({...s,fill:a,stroke:l},c,u),Ls),c&&(this.fill=void 0),u&&(this.stroke=void 0),this.z=o}filter(t){return t}render(t,n,r,o,i){const{contours:a}=r,l=e.geoPath();return e.create("svg:g",i).call(pr,this,o,i).call(vr,this,{}).call((e=>e.selectAll().data(t).enter().append("path").call(mr,this).call(ur,this,r).attr("d",(t=>l(a[t]))))).node()}}const Rs=new Set(["x","y","z","weight"]);function zs(t){return/^density$/i.test(t)}const Os={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Es extends Yr{constructor(t,e={}){const[n,r]=j(e.r,3);super(t,{geometry:{value:e.geometry},r:{value:n,scale:"r",filter:l,optional:!0}},fl(e),Os),this.r=r}render(t,n,r,o,i){const{geometry:a,r:l}=r,c=e.geoPath(i.projection??function({x:t,y:n}){if(t||n)return t??=t=>t,n??=t=>t,e.geoTransform({point(e,r){this.stream.point(t(e),n(r))}})}(n)),{r:u}=this;return s(u)?t=[]:void 0!==u&&c.pointRadius(u),Ye("svg:g",i).call(pr,this,o,i).call(vr,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(mr,this).attr("d",l?t=>c.pointRadius(l[t])(a[t]):t=>c(a[t])).call(ur,this,r)})).node()}}function Ss(t,{geometry:e=M,...n}={}){switch(t?.type){case"FeatureCollection":t=t.features;break;case"GeometryCollection":t=t.geometries;break;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":t=[t]}return new Es(t,{geometry:e,...n})}const Cs=.5,Bs=0;function Ts(t,e,n,r){const o=r*(1.5/St),i=new Map;for(const a of t){let t=e[a],l=n[a];if(isNaN(t)||isNaN(l))continue;let s=Math.round(l=(l-Bs)/o),c=Math.round(t=(t-Cs)/r-(1&s)/2),u=l-s;if(3*Math.abs(u)>1){let e=t-c,n=c+(t<c?-1:1)/2,r=s+(l<s?-1:1),o=t-n,i=l-r;e*e+u*u>o*o+i*i&&(c=n+(1&s?1:-1)/2,s=r)}const f=`${c},${s}`;let h=i.get(f);void 0===h&&(i.set(f,h=[]),h.x=(c+(1&s)/2)*r+Cs,h.y=s*o+Bs),h.push(a)}return i.values()}const Ns={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};class Is extends Yr{constructor({binWidth:t=20,clip:e=!0,...n}={}){super(void 0,void 0,{clip:e,...n},Ns),this.binWidth=z(t)}render(t,e,n,r,o){const{binWidth:i}=this,{marginTop:a,marginRight:l,marginBottom:s,marginLeft:c,width:u,height:f}=r,h=c-Cs,d=u-l-Cs,p=a-Bs,m=f-s-Bs,g=i/2,y=g*Ct,v=y/2,x=2*g,w=1.5*y,b=Math.floor(h/x),k=Math.ceil(d/x),$=Math.floor((p+v)/w),M=Math.ceil((m-v)/w)+1,L=`m0,${Ps(-y)}l${Ps(g)},${Ps(v)}v${Ps(y)}l${Ps(-g)},${Ps(v)}`;let A=L;for(let t=$;t<M;++t)for(let e=b;e<k;++e)A+=`M${Ps(e*x+(1&t)*g)},${Ps(t*w)}${L}`;return Ye("svg:g",o).call(pr,this,r,o).call(vr,this,{},or+Cs,or+Bs).call((t=>t.append("path").call(mr,this).attr("d",A))).node()}}function Ps(t){return Math.round(1e3*t)/1e3}const Ws={ariaLabel:"image",fill:null,stroke:null};class js extends Yr{constructor(t,e={}){let{x:n,y:r,width:o,height:i,src:a,preserveAspectRatio:s,crossOrigin:c,frameAnchor:u,imageRendering:f}=e;void 0===o&&void 0!==i?o=i:void 0===i&&void 0!==o&&(i=o);const[h,d]="string"==typeof(p=a)&&(function(t){return/^\.*\//.test(t)}(p)||function(t){return/^(blob|data|file|http|https):/i.test(t)}(p))?[void 0,p]:[p,void 0];var p;const[m,g]=j(o,16),[y,v]=j(i,16);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},width:{value:m,filter:l,optional:!0},height:{value:y,filter:l,optional:!0},src:{value:h,optional:!0}},e,Ws),this.src=d,this.width=g,this.height=v,this.preserveAspectRatio=xr(s,"xMidYMid"),this.crossOrigin=R(c),this.frameAnchor=bt(u),this.imageRendering=xr(f,"auto")}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y:s,width:c,height:u,src:f}=n,[h,d]=Mr(this,r);return Ye("svg:g",o).call(pr,this,r,o).call(vr,this,{x:l&&i,y:s&&a}).call((e=>e.selectAll().data(t).enter().append("image").call(mr,this).attr("x",c&&l?t=>l[t]-c[t]/2:c?t=>h-c[t]/2:l?t=>l[t]-this.width/2:h-this.width/2).attr("y",u&&s?t=>s[t]-u[t]/2:u?t=>d-u[t]/2:s?t=>s[t]-this.height/2:d-this.height/2).attr("width",c?t=>c[t]:this.width).attr("height",u?t=>u[t]:this.height).call(yr,"href",f?t=>f[t]:this.src).call(yr,"preserveAspectRatio",this.preserveAspectRatio).call(yr,"crossorigin",this.crossOrigin).call(yr,"image-rendering",this.imageRendering).call(ur,this,n))).node()}}function Ds(t,e,n){var r=0===t||1===t?0:Math.exp(Fs(e+n)-Fs(e)-Fs(n)+e*Math.log(t)+n*Math.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+n+2)?r*qs(t,e,n)/e:1-r*qs(1-t,n,e)/n)}function qs(t,e,n){var r,o,i,a,l=1e-30,s=1,c=e+n,u=e+1,f=e-1,h=1,d=1-c*t/u;for(Math.abs(d)<l&&(d=l),a=d=1/d;s<=100&&(d=1+(o=s*(n-s)*t/((f+(r=2*s))*(e+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=(d=1/d)*h,d=1+(o=-(e+s)*(c+s)*t/((e+r)*(u+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=i=(d=1/d)*h,!(Math.abs(i-1)<3e-7));s++);return a}function Fs(t){var e,n,r,o=0,i=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(n=e=t)+5.5,r-=(e+.5)*Math.log(r);o<6;o++)a+=i[o]/++n;return Math.log(2.506628274631*a/e)-r}function Ys(t,e){var n=function(t,e,n){var r,o,i,a,l,s,c,u,f,h,d=e-1,p=n-1,m=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&n>=1?(i=t<.5?t:1-t,s=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(i))))/(1+a*(.99229+.04481*a))-a,t<.5&&(s=-s),c=(s*s-3)/6,u=2/(1/(2*e-1)+1/(2*n-1)),f=s*Math.sqrt(c+u)/u-(1/(2*n-1)-1/(2*e-1))*(c+5/6-2/(3*u)),s=e/(e+n*Math.exp(2*f))):(r=Math.log(e/(e+n)),o=Math.log(n/(e+n)),s=t<(a=Math.exp(e*r)/e)/(f=a+(l=Math.exp(n*o)/n))?Math.pow(e*f*t,1/e):1-Math.pow(n*f*(1-t),1/n)),h=-Fs(e)-Fs(n)+Fs(e+n);m<10;m++){if(0===s||1===s)return s;if((s-=a=(l=(Ds(s,e,n)-t)/(a=Math.exp(d*Math.log(s)+p*Math.log(1-s)+h)))/(1-.5*Math.min(1,l*(d/s-p/(1-s)))))<=0&&(s=.5*(s+a)),s>=1&&(s=.5*(s+a+1)),Math.abs(a)<1e-8*s&&m>0)break}return s}(2*Math.min(t,1-t),.5*e,.5);return n=Math.sqrt(e*(1-n)/n),t>.5?n:-n}const _s={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Gs extends Yr{constructor(t,e={}){const{x:n,y:r,z:o,ci:i=.95,precision:a=4}=e;if(super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:Q(e),optional:!0}},e,_s),this.z=o,this.ci=+i,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${i}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,e,n,r,o){const{x:i,y:a,z:l}=n,{ci:s}=this;return Ye("svg:g",o).call(pr,this,r,o).call(vr,this,e).call((e=>e.selectAll().data(l?hr(t,l,this.z):[t]).enter().call((t=>t.append("path").attr("fill","none").call(mr,this).call(fr,this,{...n,fill:null,fillOpacity:null}).attr("d",(t=>this._renderLine(t,i,a))).call(s&&!wt(this.fill)?t=>t.select(Xs).attr("stroke","none").call(mr,this).call(fr,this,{...n,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",(t=>this._renderBand(t,i,a))):()=>{}))))).node()}}function Xs(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(e.namespaces.svg,"path"),this)}class Us extends Gs{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:o,precision:i}=this,[a,l]=e.extent(t,(t=>r[t])),s=Vs(t,r,n),c=Zs(t,r,n,(1-o)/2,s);return e.area().y((t=>t)).x0((t=>c(t,-1))).x1((t=>c(t,1)))(e.range(a,l-i/2,i).concat(l))}_renderLine(t,n,r){const[o,i]=e.extent(t,(t=>r[t])),a=Vs(t,r,n);return`M${a(o)},${o}L${a(i)},${i}`}}class Hs extends Gs{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:o,precision:i}=this,[a,l]=e.extent(t,(t=>n[t])),s=Vs(t,n,r),c=Zs(t,n,r,(1-o)/2,s);return e.area().x((t=>t)).y0((t=>c(t,-1))).y1((t=>c(t,1)))(e.range(a,l-i/2,i).concat(l))}_renderLine(t,n,r){const[o,i]=e.extent(t,(t=>n[t])),a=Vs(t,n,r);return`M${o},${a(o)}L${i},${a(i)}`}}function Vs(t,e,n){let r=0,o=0,i=0,a=0;for(const l of t){const t=e[l],s=n[l];r+=t,o+=s,i+=t*s,a+=t*t}const l=t.length,s=(l*i-r*o)/(l*a-r*r),c=(o-s*r)/l;return t=>s*t+c}function Zs(t,n,r,o,i){const a=e.sum(t,(t=>n[t]))/t.length;let l=0,s=0;for(const e of t)l+=(n[e]-a)**2,s+=(r[e]-i(n[e]))**2;const c=Math.sqrt(s/(t.length-2)),u=Ys(o,t.length-2);return(e,n)=>{const r=i(e),o=c*Math.sqrt(1/t.length+(e-a)**2/l);return r+n*u*o}}function Qs(t={}){let{path:n=M,delimiter:r,frameAnchor:o,treeLayout:i=e.tree,treeSort:a,treeSeparation:l,treeAnchor:s,...c}=t;s=Ks(s),a=nc(a),void 0===o&&(o=s.frameAnchor);const u=oc(r),f=vc(c,ac),[h,d]=nt(),[p,m]=nt();return{x:h,y:p,frameAnchor:o,...Wt(c,((t,r)=>{const o=u(x(t,n)),c=d([]),h=m([]);let p=-1;const g=[],y=[],v=e.stratify().path((t=>o[t])),w=i();w.nodeSize&&w.nodeSize([1,1]),w.separation&&void 0!==l&&w.separation(l??L);for(const t of f)t[yc]=t[mc]([]);for(const e of r){const n=[],r=v(e.filter((t=>null!=o[t]))).each((e=>e.data=t[e.data]));null!=a&&r.sort(a),w(r);for(const t of r.descendants()){n.push(++p),g[p]=t.data,s.position(t,p,c,h);for(const e of f)e[yc][p]=e[gc](t)}y.push(n)}return{data:g,facets:y}})),...Object.fromEntries(f)}}function Js(t={}){let{path:n=M,delimiter:r,curve:o="bump-x",stroke:i="#555",strokeWidth:a=1.5,strokeOpacity:l=.5,treeLayout:s=e.tree,treeSort:c,treeSeparation:u,treeAnchor:f,...h}=t;f=Ks(f),c=nc(c),h={curve:o,stroke:i,strokeWidth:a,strokeOpacity:l,...h};const d=oc(r),p=vc(h,lc),[m,g]=nt(),[y,v]=nt(),[w,b]=nt(),[k,$]=nt();return{x1:m,x2:y,y1:w,y2:k,...Wt(h,((t,r)=>{const o=d(x(t,n)),i=g([]),a=v([]),l=b([]),h=$([]);let m=-1;const y=[],w=[],k=e.stratify().path((t=>o[t])),M=s();M.nodeSize&&M.nodeSize([1,1]),M.separation&&void 0!==u&&M.separation(u??L);for(const t of p)t[yc]=t[mc]([]);for(const e of r){const n=[],r=k(e.filter((t=>null!=o[t]))).each((e=>e.data=t[e.data]));null!=c&&r.sort(c),M(r);for(const{source:t,target:e}of r.links()){n.push(++m),y[m]=e.data,f.position(t,m,i,l),f.position(e,m,a,h);for(const n of p)n[yc][m]=n[gc](e,t)}w.push(n)}return{data:y,facets:w}})),...Object.fromEntries(p)}}function Ks(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return tc;case"right":return ec}throw new Error(`invalid tree anchor: ${t}`)}const tc={frameAnchor:"left",dx:6,position({x:t,y:e},n,r,o){r[n]=e,o[n]=-t}},ec={frameAnchor:"right",dx:-6,position({x:t,y:e},n,r,o){r[n]=-e,o[n]=-t}};function nc(t){return null==t||"function"==typeof t?t:`${t}`.trim().toLowerCase().startsWith("node:")?rc(ac(t)):rc(function(t){return e=>e.data?.[t]}(t))}function rc(t){return(e,n)=>r(t(e),t(n))}function oc(t="/"){return"/"==`${t}`?t=>t:e=>{return e.map((n=t,r="/",n=new RegExp(function(t){return`${t}`.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}(n),"g"),t=>null==t?null:`${t}`.replace(n,r)));var n,r}}function ic(t){return G(t)&&"function"==typeof t.node}function ac(t){if(ic(t))return t.node;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")){switch(t){case"node:name":return cc;case"node:path":return sc;case"node:internal":return hc;case"node:depth":return uc;case"node:height":return fc}throw new Error(`invalid node value: ${t}`)}}function lc(t){if(ic(t))return t.node;if(G(e=t)&&"function"==typeof e.link)return t.link;var e;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")||t.startsWith("parent:")){switch(t){case"parent:name":return dc(cc);case"parent:path":return dc(sc);case"parent:depth":return dc(uc);case"parent:height":return dc(fc);case"node:name":return cc;case"node:path":return sc;case"node:internal":return hc;case"node:depth":return uc;case"node:height":return fc}throw new Error(`invalid link value: ${t}`)}}function sc(t){return t.id}function cc(t){return function(t){let e=t.length;for(;--e>0&&!pc(t,e););return t.slice(e+1)}(t.id)}function uc(t){return t.depth}function fc(t){return t.height}function hc(t){return!!t.children}function dc(t){return(e,n)=>null==n?void 0:t(n)}function pc(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}const mc=2,gc=3,yc=4;function vc(t,e){const n=[];for(const r in t){const o=t[r],i=e(o);void 0!==i&&n.push([r,...nt(o),i])}return n}function xc(t,e={}){let{fill:n,stroke:r,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:l,strokeMiterlimit:s,strokeDasharray:c,strokeDashoffset:u,marker:f,markerStart:h=f,markerEnd:d=f,dot:p=xt(h)&&xt(d),text:m="node:name",textStroke:g="white",title:y="node:path",dx:v,dy:x,...w}=e;return void 0===v&&(v=Ks(w.treeAnchor).dx),_r(Za(t,Js({markerStart:h,markerEnd:d,stroke:void 0!==r?r:void 0===n?"node:internal":n,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:l,strokeMiterlimit:s,strokeDasharray:c,strokeDashoffset:u,...w})),p?dl(t,Qs({fill:void 0===n?"node:internal":n,title:y,...w})):null,null!=m?go(t,Qs({text:m,fill:void 0===n?"currentColor":n,stroke:g,dx:v,dy:x,title:y,...w})):null)}function wc(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)>=0?(i=a,o=a-1):r=a+1}return i}function bc(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)>0?(i=a,o=a-1):r=a+1}return i}function kc(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)<0?(i=a,r=a+1):o=a-1}return i}function $c(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)<=0?(i=a,r=a+1):o=a-1}return i}function Mc(t,e,n,r,o){for(;r<=o;){var i=r+o>>>1,a=t[i],l=void 0!==n?n(a,e):a-e;if(0===l)return i;l<=0?r=i+1:o=i-1}return-1}function Lc(t,e,n,r,o,i){return"function"==typeof n?i(t,e,n,void 0===r?0:0|r,void 0===o?t.length-1:0|o):i(t,e,void 0,void 0===n?0:0|n,void 0===r?t.length-1:0|r)}var Ac={ge:function(t,e,n,r,o){return Lc(t,e,n,r,o,wc)},gt:function(t,e,n,r,o){return Lc(t,e,n,r,o,bc)},lt:function(t,e,n,r,o){return Lc(t,e,n,r,o,kc)},le:function(t,e,n,r,o){return Lc(t,e,n,r,o,$c)},eq:function(t,e,n,r,o){return Lc(t,e,n,r,o,Mc)}},Rc=0,zc=1,Oc=function(t){if(!t||0===t.length)return new Yc(null);return new Yc(Fc(t))};function Ec(t,e,n,r,o){this.mid=t,this.left=e,this.right=n,this.leftPoints=r,this.rightPoints=o,this.count=(e?e.count:0)+(n?n.count:0)+r.length}var Sc=Ec.prototype;function Cc(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function Bc(t,e){var n=Fc(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function Tc(t,e){var n=t.intervals([]);n.push(e),Bc(t,n)}function Nc(t,e){var n=t.intervals([]),r=n.indexOf(e);return r<0?Rc:(n.splice(r,1),Bc(t,n),zc)}function Ic(t,e,n){for(var r=0;r<t.length&&t[r][0]<=e;++r){var o=n(t[r]);if(o)return o}}function Pc(t,e,n){for(var r=t.length-1;r>=0&&t[r][1]>=e;--r){var o=n(t[r]);if(o)return o}}function Wc(t,e){for(var n=0;n<t.length;++n){var r=e(t[n]);if(r)return r}}function jc(t,e){return t-e}function Dc(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function qc(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function Fc(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(jc);var r=e[e.length>>1],o=[],i=[],a=[];for(n=0;n<t.length;++n){var l=t[n];l[1]<r?o.push(l):r<l[0]?i.push(l):a.push(l)}var s=a,c=a.slice();return s.sort(Dc),c.sort(qc),new Ec(r,Fc(o),Fc(i),s,c)}function Yc(t){this.root=t}Sc.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},Sc.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?Tc(this,t):this.left.insert(t):this.left=Fc([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?Tc(this,t):this.right.insert(t):this.right=Fc([t]);else{var n=Ac.ge(this.leftPoints,t,Dc),r=Ac.ge(this.rightPoints,t,qc);this.leftPoints.splice(n,0,t),this.rightPoints.splice(r,0,t)}},Sc.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?Nc(this,t):2===(i=this.left.remove(t))?(this.left=null,this.count-=1,zc):(i===zc&&(this.count-=1),i):Rc;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?Nc(this,t):2===(i=this.right.remove(t))?(this.right=null,this.count-=1,zc):(i===zc&&(this.count-=1),i):Rc;if(1===this.count)return this.leftPoints[0]===t?2:Rc;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,r=this.left;r.right;)n=r,r=r.right;if(n===this)r.right=this.right;else{var o=this.left,i=this.right;n.count-=r.count,n.right=r.left,r.left=o,r.right=i}Cc(this,r),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?Cc(this,this.left):Cc(this,this.right);return zc}for(o=Ac.ge(this.leftPoints,t,Dc);o<this.leftPoints.length&&this.leftPoints[o][0]===t[0];++o)if(this.leftPoints[o]===t){this.count-=1,this.leftPoints.splice(o,1);for(i=Ac.ge(this.rightPoints,t,qc);i<this.rightPoints.length&&this.rightPoints[i][1]===t[1];++i)if(this.rightPoints[i]===t)return this.rightPoints.splice(i,1),zc}return Rc},Sc.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(n=this.left.queryPoint(t,e))return n;return Ic(this.leftPoints,t,e)}if(t>this.mid){var n;if(this.right)if(n=this.right.queryPoint(t,e))return n;return Pc(this.rightPoints,t,e)}return Wc(this.leftPoints,e)},Sc.queryInterval=function(t,e,n){var r;if(t<this.mid&&this.left&&(r=this.left.queryInterval(t,e,n)))return r;if(e>this.mid&&this.right&&(r=this.right.queryInterval(t,e,n)))return r;return e<this.mid?Ic(this.leftPoints,e,n):t>this.mid?Pc(this.rightPoints,t,n):Wc(this.leftPoints,n)};var _c=Yc.prototype;_c.insert=function(t){this.root?this.root.insert(t):this.root=new Ec(t[0],null,null,[t],[t])},_c.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),e!==Rc}return!1},_c.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},_c.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(_c,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(_c,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});const Gc=({marginLeft:t})=>[1,t],Xc=({width:t,marginRight:e})=>[-1,t-e],Uc=({width:t,marginLeft:e,marginRight:n})=>[0,(e+t-n)/2],Hc=({marginTop:t})=>[1,t],Vc=({height:t,marginBottom:e})=>[-1,t-e],Zc=({height:t,marginTop:e,marginBottom:n})=>[0,(e+t-n)/2];function Qc(t){return"string"==typeof t?{anchor:t}:t}function Jc(t){const{anchor:e,padding:n,...r}=t;return[{anchor:e,padding:n},r]}function Kc(t,e,n,r,o){const{r:i}=o;if(null!=i&&"number"!=typeof i){const{channels:t,sort:e,reverse:n}=o;o={...o,channels:{r:{value:i,scale:"r"},...$t(t)}},void 0===e&&void 0===n&&(o.sort={channel:"r",order:"descending"})}return jt(o,(function(i,s,c,u,f,h){let{[e]:d,r:p}=c;if(!c[e])throw new Error(`missing channel: ${e}`);({[e]:d}=qe(c,u,h));const m=p?void 0:void 0!==this.r?this.r:void 0!==o.r?z(o.r):3;p&&(p=x(p.value,u[p.scale]||M,Float64Array));let[g,y]=n(f);const v=g?eu:tu,w=new Float64Array(d.length),b=p?t=>p[t]:()=>m;for(let t of s){const e=Oc();t=t.filter(p?t=>a(d[t])&&l(p[t]):t=>a(d[t]));const n=new Float64Array(2*t.length+2);for(const o of t){const t=b(o),i=g?t+r:0,a=d[o]-t,l=d[o]+t;let s=2;e.queryInterval(a-r,l+r,(([,,t])=>{const e=w[t]-i,a=d[o]-d[t],l=r+(p?p[o]+p[t]:2*m),c=Math.sqrt(l*l-a*a);n[s++]=e-c,n[s++]=e+c}));let c=n.slice(0,s);g&&(c=c.filter((t=>t>=0)));t:for(const t of c.sort(v)){for(let e=0;e<s;e+=2)if(n[e]+1e-6<t&&t<n[e+1]-1e-6)continue t;w[o]=t+i;break}e.insert([a,l,o])}}g||(g=1);for(const t of s)for(const e of t)w[e]=w[e]*g+y;return{data:i,facets:s,channels:{[e]:{value:d},[t]:{value:w},...p&&{r:{value:p}}}}}))}function tu(t,e){return Math.abs(t)-Math.abs(e)}function eu(t,e){return t-e}function nu(t){if(void 0===t)return au;if("function"==typeof t)return ru(((e,n)=>t(K(n,e))));if(/^p\d{2}$/i.test(t))return ou(B(t));switch(`${t}`.toLowerCase()){case"deviation":return su;case"first":return au;case"last":return lu;case"max":return cu;case"mean":return uu;case"median":return fu;case"min":return hu;case"sum":return du;case"extent":return iu}throw new Error(`invalid basis: ${t}`)}function ru(t){return{mapIndex(e,n,r){const o=+t(e,n);for(const t of e)r[t]=null===n[t]?NaN:n[t]/o}}}function ou(t){return ru(((e,n)=>t(e,(t=>n[t]))))}const iu={mapIndex(t,n,r){const[o,i]=e.extent(t,(t=>n[t])),a=i-o;for(const e of t)r[e]=null===n[e]?NaN:(n[e]-o)/a}},au=ru(((t,e)=>{for(let r=0;r<t.length;++r){const o=e[t[r]];if(n(o))return o}})),lu=ru(((t,e)=>{for(let r=t.length-1;r>=0;--r){const o=e[t[r]];if(n(o))return o}})),su={mapIndex(t,n,r){const o=e.mean(t,(t=>n[t])),i=e.deviation(t,(t=>n[t]));for(const e of t)r[e]=null===n[e]?NaN:i?(n[e]-o)/i:0}},cu=ou(e.max),uu=ou(e.mean),fu=ou(e.median),hu=ou(e.min),du=ou(e.sum);function pu(t={}){"number"==typeof t&&(t={k:t});let{k:n,reduce:r,shift:o,anchor:i,strict:a}=t;if(void 0===i&&void 0!==o&&(i=function(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}(o),Ee(`Warning: the shift option is deprecated; please use anchor "${i}" instead.`)),!((n=Math.floor(n))>0))throw new Error(`invalid k: ${n}`);return function(t="mean"){if("string"==typeof t){if(/^p\d{2}$/i.test(t))return gu(B(t));switch(t.toLowerCase()){case"deviation":return gu(e.deviation);case"max":return yu(e.max);case"mean":return xu;case"median":return gu(e.median);case"min":return yu(e.min);case"mode":return yu(e.mode);case"sum":return vu;case"variance":return gu(e.variance);case"difference":return Mu;case"ratio":return Lu;case"first":return Au;case"last":return Ru}}if("function"!=typeof t)throw new Error(`invalid reduce: ${t}`);return yu(t)}(r)(n,function(t="middle",e){switch(`${t}`.toLowerCase()){case"middle":return e-1>>1;case"start":return 0;case"end":return e-1}throw new Error(`invalid anchor: ${t}`)}(i,n),a)}function mu(t,e,n){return t.subarray?t.subarray(e,n):t.slice(e,n)}function gu(t){return(e,n,r)=>r?{mapIndex(r,o,i){const a=Float64Array.from(r,(t=>null===o[t]?NaN:o[t]));let l=0;for(let t=0;t<e-1;++t)isNaN(a[t])&&++l;for(let o=0,s=r.length-e+1;o<s;++o)isNaN(a[o+e-1])&&++l,i[r[o+n]]=0===l?t(a.subarray(o,o+e)):NaN,isNaN(a[o])&&--l}}:{mapIndex(r,o,i){const a=Float64Array.from(r,(t=>null===o[t]?NaN:o[t]));for(let o=-n;o<0;++o)i[r[o+n]]=t(a.subarray(0,o+e));for(let o=0,l=r.length-n;o<l;++o)i[r[o+n]]=t(a.subarray(o,o+e))}}}function yu(t){return(e,r,o)=>o?{mapIndex(o,i,a){let l=0;for(let t=0;t<e-1;++t)l+=n(i[o[t]]);for(let s=0,c=o.length-e+1;s<c;++s)l+=n(i[o[s+e-1]]),l===e&&(a[o[s+r]]=t(K(i,mu(o,s,s+e)))),l-=n(i[o[s]])}}:{mapIndex(n,o,i){for(let a=-r;a<0;++a)i[n[a+r]]=t(K(o,mu(n,0,a+e)));for(let a=0,l=n.length-r;a<l;++a)i[n[a+r]]=t(K(o,mu(n,a,a+e)))}}}function vu(t,e,n){return n?{mapIndex(n,r,o){let i=0,a=0;for(let e=0;e<t-1;++e){const t=r[n[e]];null===t||isNaN(t)?++i:a+=+t}for(let l=0,s=n.length-t+1;l<s;++l){const s=r[n[l]],c=r[n[l+t-1]];null===c||isNaN(c)?++i:a+=+c,o[n[l+e]]=0===i?a:NaN,null===s||isNaN(s)?--i:a-=+s}}}:{mapIndex(n,r,o){let i=0;const a=n.length;for(let o=0,l=Math.min(a,t-e-1);o<l;++o)i+=+r[n[o]]||0;for(let l=-e,s=a-e;l<s;++l)i+=+r[n[l+t-1]]||0,o[n[l+e]]=i,i-=+r[n[l]]||0}}}function xu(t,e,n){if(n){const r=vu(t,e,n);return{mapIndex(n,o,i){r.mapIndex(n,o,i);for(let r=0,o=n.length-t+1;r<o;++r)i[n[r+e]]/=t}}}return{mapIndex(n,r,o){let i=0,a=0;const l=n.length;for(let o=0,s=Math.min(l,t-e-1);o<s;++o){let t=r[n[o]];null===t||isNaN(t=+t)||(i+=t,++a)}for(let s=-e,c=l-e;s<c;++s){let l=r[n[s+t-1]],c=r[n[s]];null===l||isNaN(l=+l)||(i+=l,++a),o[n[s+e]]=i/a,null===c||isNaN(c=+c)||(i-=c,--a)}}}}function wu(t,e,r,o){for(let i=r+o;r<i;++r){const o=t[e[r]];if(n(o))return o}}function bu(t,e,r,o){for(let i=r+o-1;i>=r;--i){const r=t[e[i]];if(n(r))return r}}function ku(t,e,n,r){for(let o=n+r;n<o;++n){let r=t[e[n]];if(null!==r&&!isNaN(r=+r))return r}}function $u(t,e,n,r){for(let o=n+r-1;o>=n;--o){let n=t[e[o]];if(null!==n&&!isNaN(n=+n))return n}}function Mu(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i){const a=r[n[i]],l=r[n[i+t-1]];o[n[i+e]]=null===a||null===l?NaN:l-a}}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=$u(r,n,i,t)-ku(r,n,i,t)}}}function Lu(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i){const a=r[n[i]],l=r[n[i+t-1]];o[n[i+e]]=null===a||null===l?NaN:l/a}}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=$u(r,n,i,t)/ku(r,n,i,t)}}}function Au(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i)o[n[i+e]]=r[n[i]]}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=wu(r,n,i,t)}}}function Ru(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i)o[n[i+e]]=r[n[i+t-1]]}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=bu(r,n,i,t)}}}function zu(t){if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"min":return Bu;case"max":return Tu}throw new Error(`unknown selector: ${t}`)}function Ou(t){return Nu(null,Su,t)}function Eu(t){return Nu(null,Cu,t)}function*Su(t){yield t[0]}function*Cu(t){yield t[t.length-1]}function*Bu(t,n){yield e.least(t,(t=>n[t]))}function*Tu(t,n){yield e.greatest(t,(t=>n[t]))}function Nu(t,n,r){if(null!=t){if(null==r[t])throw new Error(`missing channel: ${t}`);t=r[t]}const o=Q(r);return Wt(r,((r,i)=>{const a=x(r,o),l=x(r,t),s=[];for(const t of i){const r=[];for(const o of a?e.group(t,(t=>a[t])).values():[t])for(const t of n(o,l))r.push(t);s.push(r)}return{data:r,facets:s}}))}t.Area=Na,t.Arrow=Ka,t.BarX=rl,t.BarY=ol,t.Cell=sl,t.Contour=us,t.Density=As,t.Dot=hl,t.Frame=vi,t.Geo=Es,t.Hexgrid=Is,t.Image=js,t.Line=ml,t.Link=Va,t.Mark=Yr,t.Raster=Kl,t.Rect=wl,t.RuleX=io,t.RuleY=ao,t.Text=po,t.TickX=Dl,t.TickY=ql,t.Vector=Wo,t.area=function(t,e){return void 0===e?Pa(t,{x:O,y:E}):new Na(t,e)},t.areaX=Ia,t.areaY=Pa,t.arrow=function(t,e={}){let{x:n,x1:r,x2:o,y:i,y1:a,y2:l,...s}=e;return[r,o]=Qa(n,r,o),[a,l]=Qa(i,a,l),new Ka(t,{...s,x1:r,x2:o,y1:a,y2:l})},t.auto=function(t,e){const{fx:n,fy:r,x:{zero:o},y:{zero:i},markImpl:a,markOptions:l,transformImpl:s,transformOptions:c,colorMode:u}=$l(t,e),f=null!=n||null!=r?xi({strokeOpacity:.1}):null,h=[o?lo([0]):null,i?so([0]):null],d=a(t,s?s(c,l):l);return"stroke"===u?_r(f,h,d):_r(f,d,h)},t.autoSpec=function(t,e){const{x:n,y:r,fx:o,fy:i,color:a,size:l,mark:s}=$l(t,e);return{x:n,y:r,fx:o,fy:i,color:a,size:l,mark:s}},t.axisFx=Qo,t.axisFy=Vo,t.axisX=Zo,t.axisY=Ho,t.barX=il,t.barY=al,t.bin=qi,t.binX=ji,t.binY=Di,t.boxX=function(t,e={}){const{x:n=M,y:r=null,fill:o="#ccc",fillOpacity:i,stroke:a="currentColor",strokeOpacity:l,strokeWidth:s=2,sort:c,...u}=e,f=null!=r?Qt:Vt;return _r(so(t,f({x1:Gl,x2:Xl},{x:n,y:r,stroke:a,strokeOpacity:l,...u})),il(t,f({x1:"p25",x2:"p75"},{x:n,y:r,fill:o,fillOpacity:i,...u})),Fl(t,f({x:"p50"},{x:n,y:r,stroke:a,strokeOpacity:l,strokeWidth:s,sort:c,...u})),dl(t,Cl({x:_l},{x:n,y:r,z:r,stroke:a,strokeOpacity:l,...u})))},t.boxY=function(t,e={}){const{y:n=M,x:r=null,fill:o="#ccc",fillOpacity:i,stroke:a="currentColor",strokeOpacity:l,strokeWidth:s=2,sort:c,...u}=e,f=null!=r?Zt:Vt;return _r(lo(t,f({y1:Gl,y2:Xl},{x:r,y:n,stroke:a,strokeOpacity:l,...u})),al(t,f({y1:"p25",y2:"p75"},{x:r,y:n,fill:o,fillOpacity:i,...u})),Yl(t,f({y:"p50"},{x:r,y:n,stroke:a,strokeOpacity:l,strokeWidth:s,sort:c,...u})),dl(t,Cl({y:_l},{x:r,y:n,z:r,stroke:a,strokeOpacity:l,...u})))},t.cell=cl,t.cellX=function(t,e={}){let{x:n=$,fill:r,stroke:o,...i}=e;return void 0===r&&void 0===W(o)[0]&&(r=M),new sl(t,{...i,x:n,fill:r,stroke:o})},t.cellY=function(t,e={}){let{y:n=$,fill:r,stroke:o,...i}=e;return void 0===r&&void 0===W(o)[0]&&(r=M),new sl(t,{...i,y:n,fill:r,stroke:o})},t.centroid=function({geometry:t=M,...n}={}){return jt({...n,x:null,y:null},((n,r,o,i,a,{projection:l})=>{const s=x(n,t),c=s.length,u=new Float64Array(c),f=new Float64Array(c),h=e.geoPath(l);for(let t=0;t<c;++t)[u[t],f[t]]=h.centroid(s[t]);return{data:n,facets:r,channels:{x:{value:u},y:{value:f}}}}))},t.circle=function(t,e){return dl(t,{...e,symbol:"circle"})},t.cluster=function(t,n){return xc(t,{...n,treeLayout:e.cluster})},t.column=nt,t.contour=function(){return new us(...ts("value",...arguments))},t.delaunayLink=function(t,e){return Ms(ys,t,e)},t.delaunayMesh=function(t,e){return Ms(xs,t,e)},t.density=function(t,e={}){let{x:n,y:r,...o}=e;return[n,r]=Z(n,r),new As(t,{...o,x:n,y:r})},t.dodgeX=function(t={},e={}){1===arguments.length&&([t,e]=Jc(t));let{anchor:n="left",padding:r=1}=Qc(t);switch(`${n}`.toLowerCase()){case"left":n=Gc;break;case"right":n=Xc;break;case"middle":n=Uc;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return Kc("x","y",n,z(r),e)},t.dodgeY=function(t={},e={}){1===arguments.length&&([t,e]=Jc(t));let{anchor:n="bottom",padding:r=1}=Qc(t);switch(`${n}`.toLowerCase()){case"top":n=Hc;break;case"bottom":n=Vc;break;case"middle":n=Zc;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return Kc("y","x",n,z(r),e)},t.dot=dl,t.dotX=function(t,e={}){const{x:n=M,...r}=e;return new hl(t,ro({...r,x:n}))},t.dotY=function(t,e={}){const{y:n=M,...r}=e;return new hl(t,no({...r,y:n}))},t.filter=function(t,e){return Ft(e,Yt(t))},t.formatIsoDate=nr,t.formatMonth=function(t="en-US",e="short"){const n=tr(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2e3,+t)))?void 0:n.format(t)},t.formatWeekday=function(t="en-US",e="short"){const n=er(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2001,0,+t)))?void 0:n.format(t)},t.frame=xi,t.geo=Ss,t.geoCentroid=function({geometry:t=M,...n}={}){let r;return{...n,x:{transform:n=>Float64Array.from(r=x(x(n,t),e.geoCentroid),(([t])=>t))},y:{transform:()=>Float64Array.from(r,(([,t])=>t))}}},t.graticule=function({strokeOpacity:t=.1,...n}={}){return Ss(e.geoGraticule10(),{strokeOpacity:t,...n})},t.gridFx=ri,t.gridFy=ei,t.gridX=ni,t.gridY=ti,t.group=Jt,t.groupX=Zt,t.groupY=Qt,t.groupZ=Vt,t.hexagon=function(t,e){return dl(t,{...e,symbol:"hexagon"})},t.hexbin=function(t={fill:"count"},{binWidth:e,...n}={}){e=void 0===e?20:z(e),t=ee(t,n);const{z:r,fill:o,stroke:i}=n;return void 0===i&&xt(o)&&te(t,"fill")&&(n.stroke="none"),void 0===n.symbol&&(n.symbol="hexagon"),void 0!==n.r||te(t,"r")||(n.r=e/2),jt(n,((n,o,i,a,l,s)=>{let{x:c,y:u,z:f,fill:h,stroke:d,symbol:p}=i;if(void 0===c)throw new Error("missing channel: x");if(void 0===u)throw new Error("missing channel: y");({x:c,y:u}=qe(i,a,s)),f=f?f.value:x(n,r),h=h?.value,d=d?.value,p=p?.value;const m=le(t,{z:f,fill:h,stroke:d,symbol:p}),g=f&&[],y=h&&[],v=d&&[],w=p&&[],b=[],k=[],$=[];let M=-1;for(const e of t)e.initialize(n);for(const n of o){const r=[];for(const e of t)e.scope("facet",n);for(const[o,i]of oe(n,m))for(const n of Ts(i,c,u,e)){r.push(++M),k.push(n.x),$.push(n.y),f&&g.push(m===f?o:f[n[0]]),h&&y.push(m===h?o:h[n[0]]),d&&v.push(m===d?o:d[n[0]]),p&&w.push(m===p?o:p[n[0]]);for(const e of t)e.reduce(n)}b.push(r)}return{data:n,facets:b,channels:{x:{value:k},y:{value:$},...f&&{z:{value:g}},...h&&{fill:{value:y,scale:"auto"}},...d&&{stroke:{value:v,scale:"auto"}},...p&&{symbol:{value:w,scale:"auto"}},...Object.fromEntries(t.map((({name:t,output:n})=>[t,{scale:"auto",radius:"r"===t?e/2:void 0,value:n.transform()}])))}}}))},t.hexgrid=function(t){return new Is(t)},t.hull=function(t,e){return Ms(ws,t,e)},t.identity=M,t.image=function(t,e={}){let{x:n,y:r,...o}=e;return void 0===e.frameAnchor&&([n,r]=Z(n,r)),new js(t,{...o,x:n,y:r})},t.initializer=jt,t.interpolateNearest=as,t.interpolateNone=os,t.interpolatorBarycentric=is,t.interpolatorRandomWalk=ls,t.legend=function(t={}){for(const[e,n]of jr){const r=t[e];if(X(r)){const o=Fe(t);let i;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&X(t.color)?"color":void 0)}=t;i={fill:e,stroke:n}}return n(Dn(e,r,i),Dr(o,r,t),(e=>X(t[e])?Dn(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")},t.line=gl,t.lineX=yl,t.lineY=vl,t.linearRegressionX=function(t,e={}){const{y:n=$,x:r=M,stroke:o,fill:i=(xt(o)?"currentColor":o),...a}=e;return new Us(t,_i({...a,x:r,y:n,fill:i,stroke:o}))},t.linearRegressionY=function(t,e={}){const{x:n=$,y:r=M,stroke:o,fill:i=(xt(o)?"currentColor":o),...a}=e;return new Hs(t,Yi({...a,x:n,y:r,fill:i,stroke:o}))},t.link=Za,t.map=Cl,t.mapX=El,t.mapY=Sl,t.marks=_r,t.normalize=nu,t.normalizeX=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),El(nu(t),e)},t.normalizeY=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),Sl(nu(t),e)},t.plot=wi,t.raster=function(){const[t,e]=ts("fill",...arguments);return new Kl(t,null==t||void 0!==e.fill||void 0!==e.fillOpacity?e:{...e,fill:M})},t.rect=function(t,e){return new wl(t,Jr(Kr(e)))},t.rectX=bl,t.rectY=kl,t.reverse=function({sort:t,...e}={}){return{...Ft(e,_t),sort:H(t)?t:null}},t.ruleX=lo,t.ruleY=so,t.scale=function(t={}){let e;for(const n in t)if(Et.has(n)&&X(t[n])){if(void 0!==e)throw new Error("ambiguous scale definition; multiple scales found");e=Qn(Dn(n,t[n]))}if(void 0===e)throw new Error("invalid scale definition; no scale found");return e},t.select=function(t,e={}){if("string"==typeof t)switch(t.toLowerCase()){case"first":return Ou(e);case"last":return Eu(e)}if("function"==typeof t)return Nu(null,t,e);let n,r;for(n in t){if(void 0!==r)throw new Error("ambiguous selector; multiple inputs");r=zu(t[n])}if(void 0===r)throw new Error(`invalid selector: ${t}`);return Nu(n,r,e)},t.selectFirst=Ou,t.selectLast=Eu,t.selectMaxX=function(t){return Nu("x",Tu,t)},t.selectMaxY=function(t){return Nu("y",Tu,t)},t.selectMinX=function(t){return Nu("x",Bu,t)},t.selectMinY=function(t){return Nu("y",Bu,t)},t.shuffle=function({seed:t,sort:n,...r}={}){return{...Ft(r,Ht(null==t?Math.random:e.randomLcg(t))),sort:H(n)?n:null}},t.sort=Gt,t.sphere=function({strokeWidth:t=1.5,...e}={}){return Ss({type:"Sphere"},{strokeWidth:t,...e})},t.spike=function(t,e={}){const{shape:n=Io,stroke:r=Co.stroke,strokeWidth:o=1,fill:i=r,fillOpacity:a=.3,anchor:l="start",...s}=e;return jo(t,{...s,shape:n,stroke:r,strokeWidth:o,fill:i,fillOpacity:a,anchor:l})},t.stackX=pa,t.stackX1=function(t={},e={}){1===arguments.length&&([t,e]=va(t));const{y1:n,y:r=n,x:o}=e,[i,a,l]=xa(r,o,"x",t,e);return{...i,y1:n,y:a,x:l}},t.stackX2=function(t={},e={}){1===arguments.length&&([t,e]=va(t));const{y1:n,y:r=n,x:o}=e,[i,a,,l]=xa(r,o,"x",t,e);return{...i,y1:n,y:a,x:l}},t.stackY=ma,t.stackY1=function(t={},e={}){1===arguments.length&&([t,e]=va(t));const{x1:n,x:r=n,y:o}=e,[i,a,l]=xa(r,o,"y",t,e);return{...i,x1:n,x:a,y:l}},t.stackY2=function(t={},e={}){1===arguments.length&&([t,e]=va(t));const{x1:n,x:r=n,y:o}=e,[i,a,,l]=xa(r,o,"y",t,e);return{...i,x1:n,x:a,y:l}},t.text=go,t.textX=yo,t.textY=vo,t.tickX=Fl,t.tickY=Yl,t.transform=Wt,t.tree=xc,t.treeLink=Js,t.treeNode=Qs,t.valueof=x,t.vector=jo,t.vectorX=Do,t.vectorY=qo,t.version="0.6.5",t.voronoi=function(t,e){return Ms(bs,t,e)},t.voronoiMesh=function(t,e){return Ms(ks,t,e)},t.window=pu,t.windowX=function(t={},e){return 1===arguments.length&&(e=t),El(pu(t),e)},t.windowY=function(t={},e){return 1===arguments.length&&(e=t),Sl(pu(t),e)}}));
